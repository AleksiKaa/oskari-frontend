var Colorpicker=RightJS.Colorpicker=function(n,c,h,f){function r(g,q,b,a){if(q==="hide"&&g.visible()||q==="show"&&g.hidden()){if(f.Fx){if(g.___fx=true,b===void 0&&(b=g.options.fxName,a===void 0&&(a={duration:g.options.fxDuration,onFinish:function(){g.___fx=false;g.fire(q)}},q==="hide")))a.duration=(f.Fx.Durations[a.duration]||a.duration)/2}else g.___fx=false,b||g.fire(q);return g.$super(b,a)}else return g}function p(){o.tracking&&o.tracking.stopTrack()}function i(g){o.tracking&&o.tracking.trackMove(g)}
var s=new f.Class(f.Element,{initialize:function(g,q){this.$super("div",q);this._.innerHTML=g;this.addClass("rui-button");this.on("selectstart","stopEvent")},disable:function(){return this.addClass("rui-button-disabled")},enable:function(){return this.removeClass("rui-button-disabled")},disabled:function(){return this.hasClass("rui-button-disabled")},enabled:function(){return!this.disabled()},fire:function(){this.enabled()&&this.$super.apply(this,arguments);return this}}),e=f,k=f.$,l=f.$w,t=f.$$,
a=f.$E,j=f.$A,v=f.isArray,b=f.Class,d=f.Element,m=f.Input,o=new function(g,q){q||(q=g,g="DIV");var b=new f.Class(f.Element.Wrappers[g]||f.Element,{initialize:function(q,b){this.key=q;var a=[{"class":"rui-"+q}];this instanceof f.Input||this instanceof f.Form||a.unshift(g);this.$super.apply(this,a);f.isString(b)&&(b=f.$(b));if(b instanceof f.Element){this._=b._;if("$listeners"in b)b.$listeners=b.$listeners;b={}}this.setOptions(b,this);return f.Wrapper.Cache[f.$uid(this._)]=this},setOptions:function(g,
b){b&&(g=f.Object.merge(g,(new Function("return "+(b.get("data-"+this.key)||"{}")))()));g&&f.Options.setOptions.call(this,f.Object.merge(this.options,g));return this}}),b=new f.Class(b,q);f.Observer.createShortcuts(b.prototype,b.EVENTS||f([]));return b}({include:[{show:function(g,b){this.constructor.current=this;return r(this,"show",g,b)},hide:function(g,b){this.constructor.current=null;return r(this,"hide",g,b)},showAt:function(g,b,a){var d=this.hide(null).shownAt=g=f.$(g),m=(this.reAnchor||(this.reAnchor=
new f.Element("div",{"class":"rui-re-anchor"})).insert(this)).insertTo(d,"after").position(),g=d.dimensions(),c=h(d.getStyle("borderTopWidth")),o=h(d.getStyle("borderLeftWidth")),j=h(d.getStyle("borderRightWidth")),e=h(d.getStyle("borderBottomWidth")),d=g.top-m.y+c,m=g.left-m.x+o,o=g.width-o-j,g=g.height-c-e;this.setStyle("visibility:hidden").show(null);b==="right"?m+=o-this.size().x:d+=g;this.moveTo(m,d);a&&(b==="left"||b==="right"?this.setHeight(g):this.setWidth(o));this.setStyle("visibility:visible").hide(null);
return this.show()},toggleAt:function(g,b,a){return this.hidden()?this.showAt(g,b,a):this.hide()}},{assignTo:function(g,b){g=f.$(g);(b=f.$(b))?(b[this.key]=this,b.assignedInput=g):g[this.key]=this;var a=f(function(){this.visible()&&(!this.showAt||this.shownAt===g)&&this.setValue(g.value())}).bind(this);g.on({keyup:a,change:a});this.onChange(function(){(!this.showAt||this.shownAt===g)&&g.setValue(this.getValue())});return this}}],extend:{version:"2.2.4",EVENTS:l("change show hide done"),Options:{format:"hex",
update:null,updateBg:null,updateBorder:null,updateColor:null,trigger:null,fxName:"fade",fxDuration:"short",cssRule:"*[data-colorpicker]"},i18n:{Done:"Done"},hideAll:function(){t("div.rui-colorpicker").each(function(g){g instanceof o&&!g.inlined()&&g.hide()})}},initialize:function(g){this.$super("colorpicker",g).addClass("rui-panel").insert([this.field=new u,this.colors=new w,this.controls=new x]).on({mousedown:this.startTrack,touchstart:this.startTrack,keyup:this.recalc,blur:this.update,focus:this.cancelTimer,
done:this.done});this.options.update&&this.assignTo(this.options.update,this.options.trigger);this.options.updateBg&&this.updateBg(this.options.updateBg);this.options.updateBorder&&this.updateBorder(this.options.updateBorder);this.options.updateColor&&this.updateColor(this.options.updateColor);this.tint=e([1,0,0]);this.satur=0;this.bright=1;this.color=e([255,255,255]);this.recalc().update()},setValue:function(g){if((g=v(g)?g:this.toColor(g))&&g.length===3)this.color=g=g.map(function(g){return this.bound(h(""+
g),0,255)},this),this.color2tint().update(),this.colors.size().y||this.update.bind(this).delay(20);return this},getValue:function(g){return g?this.color:this[this.options.format==="rgb"?"toRgb":"toHex"]()},updateBg:function(g){var b=k(g);if(b)this.onChange(e(function(){b._.style.backgroundColor=this.toRgb()}).bind(this));return this},updateColor:function(g){var b=k(g);if(b)this.onChange(e(function(){b._.style.color=this.toRgb()}).bind(this));return this},updateBorder:function(g){var b=k(g);if(b)this.onChange(e(function(){b._.style.borderColor=
this.toRgb()}).bind(this));return this},insertTo:function(b,a){return this.$super(b,a).addClass("rui-colorpicker-inline")},inlined:function(){return this.hasClass("rui-colorpicker-inline")},done:function(){this.inlined()||this.hide();return this},setOptions:function(b){b=b||{};this.$super(b,k(b.trigger||b.update))},update:function(){this.field._.style.backgroundColor="rgb("+this.tint.map(function(b){return c.round(b*255)})+")";var b=this.color,a=this.controls;a.preview._.style.backgroundColor=a.display._.value=
this.toHex();a.rDisplay._.value=b[0];a.gDisplay._.value=b[1];a.bDisplay._.value=b[2];var a=this.field.pointer._.style,b=this.field.size(),d=this.satur*b.x-2;a.top=this.bound(b.y-this.bright*b.y-2,0,b.y-5)+"px";a.left=this.bound(d,0,b.x-5)+"px";a=this.tint;b=this.colors.size();a=a[1]==0?a[0]==1?a[2]:2-a[0]:a[0]==0?2+(a[2]==1?a[1]:2-a[2]):4+(a[1]==1?a[0]:2-a[1]);a=a/6*b.y;this.colors.pointer._.style.top=this.bound(a,0,b.y-4)+"px";if(this.prevColor!==""+this.color)this.fire("change",{value:this.color}),
this.prevColor=""+this.color;return this},recalc:function(b){if(b){var b=b.target,a=b._.value,d=j(this.color),m=false;b===this.controls.display&&/#\w{6}/.test(a)?m=d=this.toColor(a):/^\d+$/.test(a)&&(d[b._.cIndex]=a,m=true);m&&this.setValue(d)}else this.tint2color();return this},startTrack:function(b){this.stopTrack();this.cancelTimer();if(b.target===this.field.pointer)b.target=this.field;else if(b.target===this.colors.pointer)b.target=this.colors;if(b.target===this.field||b.target===this.colors)b.stop(),
o.tracking=this,b.target.tracking=true,this.trackMove(b)},stopTrack:function(){o.tracking=false;this.field.tracking=false;this.colors.tracking=false},trackMove:function(b){var a,d=b.position();this.field.tracking?a=this.field.dimensions():this.colors.tracking&&(a=this.colors.dimensions());if(a){b=this.bound(d.y-a.top,0,a.height);d=this.bound(d.x-a.left,0,a.width);if(this.field.tracking)this.satur=d/a.width,this.bright=1-b/a.height;else if(this.colors.tracking){b==a.height&&(b=a.height-0.1);a=a.height/
6;var d=this.tint=[0,0,0],m=b%a/a,c=1-m;b<a?(d[0]=1,d[2]=m):b<a*2?(d[0]=c,d[2]=1):b<a*3?(d[2]=1,d[1]=m):b<a*4?(d[2]=c,d[1]=1):b<a*5?(d[1]=1,d[0]=m):(d[1]=c,d[0]=1)}this.recalc().update()}},cancelTimer:function(){e(function(){if(this._hide_delay)this._hide_delay.cancel(),this._hide_delay=null}).bind(this).delay(10)}}),u=new b(d,{initialize:function(){this.$super("div",{"class":"field"});this.insert(this.pointer=a("div",{"class":"pointer"}))}}),w=new b(d,{initialize:function(){this.$super("div",{"class":"colors"});
this.insert(this.pointer=a("div",{"class":"pointer"}))}}),x=new b(d,{initialize:function(){this.$super("div",{"class":"controls"});this.insert([this.preview=a("div",{"class":"preview",html:"&nbsp;"}),this.display=a("input",{type:"text","class":"display",maxlength:7}),a("div",{"class":"rgb-display"}).insert([a("div").insert([a("label",{html:"R:"}),this.rDisplay=a("input",{maxlength:3,cIndex:0})]),a("div").insert([a("label",{html:"G:"}),this.gDisplay=a("input",{maxlength:3,cIndex:1})]),a("div").insert([a("label",
{html:"B:"}),this.bDisplay=a("input",{maxlength:3,cIndex:2})])]),this.button=(new s(o.i18n.Done)).onClick("fire","done")])}});o.include({toRgb:function(){return"rgb("+this.color.join(",")+")"},toHex:function(){return"#"+this.color.map(function(b){return(b<16?"0":"")+b.toString(16)}).join("")},toColor:function(b){var b=b.toLowerCase(),a;if(a=/rgb\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\)/.exec(b))return[h(a[1]),h(a[2]),h(a[3])];else if(/#[\da-f]+/.test(b)){if(a=/^#([\da-f])([\da-f])([\da-f])$/.exec(b))b="#"+
a[1]+a[1]+a[2]+a[2]+a[3]+a[3];if(a=/#([\da-f]{2})([\da-f]{2})([\da-f]{2})/.exec(b))return[a[1],a[2],a[3]].map(function(b){return h(b,16)})}},color2tint:function(){var b=j(this.color).sort(function(b,a){return b-a}),a=b[0],d=b[2];this.bright=d/255;this.satur=1-a/(d||1);this.tint.each(function(b,g){this.tint[g]=!a&&!d||a==d?g==0?1:0:(this.color[g]-a)/(d-a);return this.tint[g]},this);return this},tint2color:function(){for(var b=this.tint,a=this.color,d=0;d<3;d++)a[d]=1+this.satur*(b[d]-1),a[d]=c.round(255*
a[d]*this.bright);return this},bound:function(b,a,d){a<d?b=b<a?a:b>d?d:b:(b>d&&(b=d),b<a&&(b=a));return b}});k(n).on({mouseup:p,touchend:p,mousemove:i,touchmove:i,focus:function(b){b=b.target instanceof m?b.target:null;o.hideAll();if(b&&(b.colorpicker||b.match(o.Options.cssRule)))(b.colorpicker||new o({update:b})).setValue(b.value()).showAt(b)},blur:function(b){var a=b.target.colorpicker;if(a)a._hide_delay=e(function(){a.hide()}).delay(200)},click:function(b){var a=b.target instanceof d?b.target:
null;a&&(a.colorpicker||a.match(o.Options.cssRule))?a instanceof m||(b.stop(),(a.colorpicker||new o({trigger:a})).hide(null).toggleAt(a.assignedInput)):b.find("div.rui-colorpicker")||o.hideAll()},keydown:function(b){var a=o.current,d={27:"hide",13:"done"}[b.keyCode];d&&a&&a.visible()&&(b.stop(),a[d]())}});l=n.createElement("style");b=n.createTextNode("*.rui-button{display:inline-block; *display:inline; *zoom:1;height:1em;line-height:1em;margin:0;padding:.2em .5em;text-align:center;border:1px solid #CCC;border-radius:.2em;-moz-border-radius:.2em;-webkit-border-radius:.2em;cursor:pointer;color:#333;background-color:#FFF;user-select:none;-moz-user-select:none;-webkit-user-select:none} *.rui-button:hover{color:#111;border-color:#999;background-color:#DDD;box-shadow:#888 0 0 .1em;-moz-box-shadow:#888 0 0 .1em;-webkit-box-shadow:#888 0 0 .1em} *.rui-button:active{color:#000;border-color:#777;text-indent:1px;box-shadow:none;-moz-box-shadow:none;-webkit-box-shadow:none} *.rui-button-disabled, *.rui-button-disabled:hover, *.rui-button-disabled:active{color:#888;background:#DDD;border-color:#CCC;cursor:default;text-indent:0;box-shadow:none;-moz-box-shadow:none;-webkit-box-shadow:none}div.rui-re-anchor{margin:0;padding:0;background:none;border:none;float:none;display:inline;position:absolute;z-index:9999}.rui-panel{margin:0;padding:.5em;position:relative;background-color:#EEE;border:1px solid #BBB;border-radius:.3em;-moz-border-radius:.3em;-webkit-border-radius:.3em;box-shadow:.15em .3em .5em #BBB;-moz-box-shadow:.15em .3em .5em #BBB;-webkit-box-shadow:.15em .3em .5em #BBB;cursor:default}div.rui-colorpicker .field,div.rui-colorpicker .field *,div.rui-colorpicker .colors,div.rui-colorpicker .colors *{border:none;background:none;width:auto;height:auto;position:static;float:none;top:none;left:none;right:none;bottom:none;margin:0;padding:0;display:block;font-weight:normal;vertical-align:center}div.rui-colorpicker div.field,div.rui-colorpicker div.field div.pointer,div.rui-colorpicker div.colors,div.rui-colorpicker div.colors div.pointer{background:url(../../img/colorpicker.png) no-repeat 0 0}div.rui-colorpicker div.field,div.rui-colorpicker div.colors,div.rui-colorpicker div.controls{display:inline-block; *display:inline; *zoom:1;position:relative;vertical-align:top;height:150px}div.rui-colorpicker div.field div.pointer,div.rui-colorpicker div.colors div.pointer{position:absolute;top:0px;left:0;width:9px;height:9px}div.rui-colorpicker input.display,div.rui-colorpicker div.preview,div.rui-colorpicker div.rgb-display,div.rui-colorpicker input.rui-ui-button{font-size:100%;display:block;width:auto;padding:0 .2em}div.rui-colorpicker input.display,div.rui-colorpicker div.preview,div.rui-colorpicker div.rgb-display input,div.rui-colorpicker input.rui-ui-button{border:1px solid #AAA;-moz-border-radius:.2em;-webkit-border-radius:.2em}div.rui-colorpicker div.field{width:150px;background-color:red;cursor:crosshair;margin-right:1.2em}div.rui-colorpicker div.field div.pointer{background-position:-170px 0;margin-left:-2px;margin-top:-2px}div.rui-colorpicker div.colors{width:16px;background-position:-150px 0;border-color:#EEE;cursor:pointer;margin-right:.6em}div.rui-colorpicker div.colors div.pointer{cursor:default;background-position:-170px -20px;margin-left:-8px;margin-top:-3px}div.rui-colorpicker div.controls{width:5em}div.rui-colorpicker div.preview{height:2em;background:white;border-color:#BBB}div.rui-colorpicker input.display{margin-top:.5em;background:#FFF;width:4.5em}div.rui-colorpicker div.rgb-display{padding:0;text-align:right;margin-top:.5em}div.rui-colorpicker div.rgb-display label{display:inline}div.rui-colorpicker div.rgb-display label:after{content:none}div.rui-colorpicker div.rgb-display input{vertical-align:top;font-size:100%;width:2em;text-align:right;margin-left:.2em;padding:0 .2em;background:#FFF;margin-bottom:1px;display:inline}div.rui-colorpicker div.rui-button{cursor:pointer;position:absolute;bottom:0;right:0;width:4em}div.rui-colorpicker-inline{display:inline-block; *display:inline; *zoom:1;position:relative;box-shadow:none;-moz-box-shadow:none;-webkit-box-shadow:none;z-index:auto}");
l.type="text/css";n.getElementsByTagName("head")[0].appendChild(l);l.styleSheet?l.styleSheet.cssText=b.nodeValue:l.appendChild(b);return o}(document,Math,parseInt,RightJS);var Resizable=RightJS.Resizable=function(n,c){function h(c){var a=c.find(".rui-resizable-handle");if(a)a=a.parent(),a instanceof k||(a=new k(a)),k.current=a.start(c.stop())}function f(c){var a=k.current;a&&a.track(c)}function r(c){var a=k.current;if(a)a.release(c),k.current=null}var p=c.$,i=c.$w,s=c.$E,e=c.Element,k=new function(e,a){a||(a=e,e="DIV");var j=new c.Class(c.Element.Wrappers[e]||c.Element,{initialize:function(a,b){this.key=a;var d=[{"class":"rui-"+a}];this instanceof c.Input||this instanceof
c.Form||d.unshift(e);this.$super.apply(this,d);c.isString(b)&&(b=c.$(b));if(b instanceof c.Element){this._=b._;if("$listeners"in b)b.$listeners=b.$listeners;b={}}this.setOptions(b,this);return c.Wrapper.Cache[c.$uid(this._)]=this},setOptions:function(a,b){b&&(a=c.Object.merge(a,(new Function("return "+(b.get("data-"+this.key)||"{}")))()));a&&c.Options.setOptions.call(this,c.Object.merge(this.options,a));return this}}),j=new c.Class(j,a);c.Observer.createShortcuts(j.prototype,j.EVENTS||c([]));return j}({extend:{version:"2.2.4",
EVENTS:i("resize start release"),Options:{direction:null,minWidth:null,maxWidth:null,minHeight:null,maxHeight:null}},initialize:function(c,a){this.$super("resizable",this.old_inst=p(c)).setOptions(a);this.options.direction?this.addClass("rui-resizable-"+this.options.direction):this.addClass("rui-resizable");this.content=this.first(".rui-resizable-content")||s("div",{"class":"rui-resizable-content"}).insert(this.children()).insertTo(this);this.handle=this.first(".rui-resizable-handle")||s("div",{"class":"rui-resizable-handle"}).insertTo(this);
this.content.setWidth(this.size().x-parseInt(this.getStyle("borderLeftWidth"),10)-parseInt(this.getStyle("borderRightWidth"),10));this.options.direction!=="left"&&this.options.direction!=="right"&&this.content.setHeight(this.size().y-parseInt(this.getStyle("borderTopWidth"),10)-parseInt(this.getStyle("borderBottomWidth"),10))},destroy:function(){this.removeClass("rui-resizable").removeClass("rui-resizable-top").removeClass("rui-resizable-left").removeClass("rui-resizable-right").removeClass("rui-resizable-bottom").insert(this.content._.childNodes);
this.content.remove();this.handle.remove();if(this.old_inst)Wrapper.Cache[$uid(this._)]=this.old_inst;return this},setOptions:function(c,a){c=c||{};i("top left right bottom").each(function(a){if(this.hasClass("rui-resizable-"+a))c.direction=a},this);return this.$super(c,a)},start:function(c){this.prevSizes=this.size();this.prevEvPos=c.position();this.contXDiff=this.size().x-this.content.size().x;this.contYDiff=this.size().y-this.content.size().y;i("minWidth maxWidth minHeight maxHeight").each(function(a){this[a]=
this.findDim(a)},this);return this.fire("start",{original:c})},track:function(c){var a=c.position(),e=this.prevEvPos,f=this.handle.dimensions(),b=this.prevSizes,d=b.x,m=b.y,o=e.y-a.y,u=this.minWidth,h=this.maxWidth,k=this.minHeight,g=this.maxHeight,i=this.options.direction;d+=(i==="left"?1:-1)*(e.x-a.x);m+=(i==="top"?1:-1)*o;d<u&&(d=u);d>h&&(d=h);m<k&&(m=k);m>g&&(m=g);b.x!==d&&i!=="top"&&i!=="bottom"&&this.setWidth(d);b.y!==m&&i!=="left"&&i!=="right"&&this.setHeight(m);if(d==u||d==h)a.x=f.left+f.width/
2;if(m==k||m==g)a.y=f.top+f.height/2;this.prevEvPos=a;this.prevSizes=this.size();this.fire("resize",{original:c})},setWidth:function(c){this.content.setWidth(c-this.contXDiff);return this.$super(c)},setHeight:function(c){this.content.setHeight(c-this.contYDiff);return this.$super(c)},release:function(c){return this.fire("release",{original:c})},findDim:function(e){var a=this.options[e]||this.getStyle(e);if(a&&/\d+/.test(a)&&parseFloat(a)>0)return e=c(e).include("Width")?"width":"height",a=(this._dummy||
(this._dummy=s("div",{style:"visibility:hidden;z-index:-1"}))).setStyle(e,a).insertTo(this,"before"),e=a._["offset"+c(e).capitalize()],a.remove(),e}});p(n).on({mousedown:h,touchstart:h,mousemove:f,touchmove:f,mouseup:r,touchend:r});p(window).onBlur(function(c){var a=k.current;if(a)a.release(c),k.current=null});e.include({makeResizable:function(c){return new k(this,c)},undoResizable:function(){this instanceof k&&this.destroy();return this}});"Draggable"in c&&c.Draggable.include({dragStart:function(c){c.target.hasClass("rui-resizable-handle")||
this.$super(c)}});var e=n.createElement("style"),l=n.createTextNode(".rui-resizable,.rui-resizable-top,.rui-resizable-left,.rui-resizable-right,.rui-resizable-bottom,.rui-resizable-content .rui-resizable-handle{margin:0;padding:0;overflow:none;border:none;background:none;width:auto;height:auto;min-width:none;max-width:none;min-height:none;max-height:none}.rui-resizable,.rui-resizable-top,.rui-resizable-left,.rui-resizable-right,.rui-resizable-bottom{position:relative;min-width:8em;min-height:8em;border:1px solid #DDD}.rui-resizable-content{overflow:auto;padding:.5em;position:relative}.rui-resizable-handle{position:absolute;background-image:url(../../img/resizable.png);background-repeat:no-repeat;background-color:#DDD;cursor:move}.rui-resizable .rui-resizable-handle{right:0;bottom:0;background-position:-2px -2px;background-color:transparent;width:16px;height:16px}.rui-resizable-top .rui-resizable-handle,.rui-resizable-bottom .rui-resizable-handle{height:8px;width:100%;background-position:center -26px;cursor:row-resize}.rui-resizable-left .rui-resizable-handle,.rui-resizable-right .rui-resizable-handle{top:0px;width:8px;height:100%;background-position:-26px center;cursor:col-resize}.rui-resizable-top .rui-resizable-content{padding-top:1em}.rui-resizable-top .rui-resizable-handle{top:0}.rui-resizable-bottom .rui-resizable-content{padding-bottom:1em}.rui-resizable-bottom .rui-resizable-handle{bottom:0}.rui-resizable-left .rui-resizable-content{padding-left:1em}.rui-resizable-left .rui-resizable-handle{left:0}.rui-resizable-right .rui-resizable-content{padding-right:1em}.rui-resizable-right .rui-resizable-handle{right:0}");
e.type="text/css";n.getElementsByTagName("head")[0].appendChild(e);e.styleSheet?e.styleSheet.cssText=l.nodeValue:e.appendChild(l);return k}(document,RightJS);var Slider=RightJS.Slider=function(n,c,h){function f(b){var a=b.find(".rui-slider");if(a)b.stop(),a instanceof j||(a=new j(a)),j.current=a.start(b)}function r(b){j.current&&j.current.move(b)}function p(){if(j.current)j.current=false}var i=h.$,s=h.$$,e=h.$w,k=h.$E,l=h.$A,t=h.isHash,a=h.Element,j=new function(b,a){a||(a=b,b="DIV");var c=new h.Class(h.Element.Wrappers[b]||h.Element,{initialize:function(a,d){this.key=a;var c=[{"class":"rui-"+a}];this instanceof h.Input||this instanceof h.Form||c.unshift(b);
this.$super.apply(this,c);h.isString(d)&&(d=h.$(d));if(d instanceof h.Element){this._=d._;if("$listeners"in d)d.$listeners=d.$listeners;d={}}this.setOptions(d,this);return h.Wrapper.Cache[h.$uid(this._)]=this},setOptions:function(b,a){a&&(b=h.Object.merge(b,(new Function("return "+(a.get("data-"+this.key)||"{}")))()));b&&h.Options.setOptions.call(this,h.Object.merge(this.options,b));return this}}),c=new h.Class(c,a);h.Observer.createShortcuts(c.prototype,c.EVENTS||h([]));return c}({include:{assignTo:function(b){var a=
h(function(b,a){if(b=i(b))b[b.setValue?"setValue":"update"](a.target.getValue())}).curry(b),c=h(function(b,a){if((b=i(b))&&b.onChange)b.onChange(h(function(){this.setValue(b.value())}).bind(a))}).curry(b);if(i(b))a({target:this}),c(this);else i(n).onReady(h(function(){a({target:this});c(this)}.bind(this)));return this.onChange(a)}},extend:{version:"2.3.1",EVENTS:e("change"),Options:{min:0,max:100,snap:0,range:false,value:null,values:null,direction:"x",update:null,round:0},current:false},initialize:function(){var b=
l(arguments).compact(),d=b.pop(),b=b.pop();if(!t(d)||d instanceof a)b=i(b||d),d={};this.$super("slider",b).setOptions(d).on("selectstart","stopEvent");this.level=this.first(".level")||k("div",{"class":"level"}).insertTo(this);d=this.options;this.value=d.value===null?d.min:d.value;d.range===true?(this.handles=[],this.handles[0]=this.first(".handle.from")||k("div",{"class":"handle from"}).insertTo(this),this.handles[1]=this.first(".handle.to")||k("div",{"class":"handle to"}).insertTo(this),this.values=
[0,0],this.values[0]=d.values===null?d.min:d.values[0],this.values[1]=d.values===null?d.max:d.values[1],this.setValue(this.values[0],"from"),this.setValue(this.values[1],"to")):(this.handle=this.first(".handle")||k("div",{"class":"handle"}).insertTo(this),this.setValue(this.value));d.update&&this.assignTo(d.update);if(d.direction==="y")this.addClass("rui-slider-vertical");else if(this.hasClass("rui-slider-vertical"))d.direction="y"},setValue:function(b,a){return this.precalc().shiftTo(b,a)},getValue:function(){return this.options.range===
true?this.values[0]:this.value},getValues:function(){return this.values},insertTo:function(b,a){return this.$super(b,a).setValue(this.value)},precalc:function(){var b=this.options.direction==="x",a=this.dims=this.dimensions();if(this.options.range===true){var c=this.handles[0].setStyle(b?{left:0}:{bottom:0}).dimensions(),e=this.hSize=b?c.width:c.height;this.offset=b?c.left-a.left:a.top+a.height-c.top-e;this.space=(b?a.width:a.height)-e-this.offset*2;this.handles[1].setStyle(b?{left:this.space+"px"}:
{bottom:this.space+"px"}).dimensions()}else c=this.handle.setStyle(b?{left:0}:{bottom:0}).dimensions(),e=this.hSize=b?c.width:c.height,this.offset=b?c.left-a.left:a.top+a.height-c.top-e,this.space=(b?a.width:a.height)-e-this.offset*2;return this},start:function(b){this._type=null;if(b.target.hasClass("handle"))if(b.target.hasClass("from"))this._type="from";else if(b.target.hasClass("to"))this._type="to";return this.precalc().e2val(b)},move:function(b){return this.e2val(b)},shiftTo:function(b,a){var e=
this.options,j=c.pow(10,e.round),f=e.direction==="x",b=c.round(b*j)/j;if(b<e.min)b=e.min;if(b>e.max)b=e.max;if(e.range===true&&(a==="to"&&b<this.values[0]&&(b=this.values[0]),a==="from"||a===void 0))b>this.values[1]&&(b=this.values[1]);if(e.snap)var j=e.snap,h=(b-e.min)%j,b=h<j/2?b-h:b-h+j;if(e.range===true)j=this.space/(e.max-e.min)*((a==="from"?b:this.values[0])-e.min),e=this.space/(e.max-e.min)*((a==="to"?b:this.values[1])-e.min),h=e-j,a==="to"?this.handles[1]._.style[f?"left":"bottom"]=e+"px":
this.handles[0]._.style[f?"left":"bottom"]=j+"px",this.level._.style[f?"left":"top"]=(j>0?j:0)+2+"px",this.level._.style[f?"width":"height"]=(h>0?h:0)+2+"px",f=false,a==="from"&&b!==this.values[0]&&(this.values[0]=b,f=true),a==="to"&&b!==this.values[1]&&(this.values[1]=b,f=true),f&&this.fire("change",{value:b,values:this.values});else if(e=this.space/(e.max-e.min)*(b-e.min),this.handle._.style[f?"left":"bottom"]=e+"px",this.level._.style[f?"width":"height"]=(e>0?e:0)+2+"px",b!==this.value)this.value=
b,this.fire("change",{value:b});return this},e2val:function(a){var d=this.options,c=d.direction==="x",e=this.dims,j=this.offset,f=this.space,a=a.position()[c?"x":"y"]-j-this.hSize/2,e=(d.max-d.min)/f*(a-(c?e.left+j:e.top+j)),j=this._type;return j==null?this.shiftTo(c?d.min+e:d.max-e):j==="to"?(this.shiftTo(this.values[0],"from"),this.shiftTo(c?d.min+e:d.max-e,"to")):(this.shiftTo(this.values[1],"to"),this.shiftTo(c?d.min+e:d.max-e,"from"))}});i(n).on({ready:function(){s(".rui-slider").each(function(a){a instanceof
j||new j(a)})},mousedown:f,touchstart:f,mousemove:r,touchmove:r,mouseup:p,touchend:p});i(window).onBlur(function(){if(j.current)j.current=false});var e=n.createElement("style"),v=n.createTextNode("div.rui-slider,div.rui-slider .handle,div.rui-slider .level{margin:0;padding:0;border:none;background:none}div.rui-slider{height:0.4em;width:20em;border:1px solid #bbb;background:#F8F8F8;border-radius:.2em;-moz-border-radius:.2em;-webkit-border-radius:.2em;position:relative;margin:.6em 0;display:inline-block; *display:inline; *zoom:1;vertical-align:middle;user-select:none;-moz-user-select:none;-webkit-user-select:none;cursor:pointer}div.rui-slider .handle{font-size:25%;position:absolute;left:0;top:0;width:4pt;height:10pt;margin-top:-4pt;margin-left:0.4em;background:#BBB;border:1px solid #999;border-radius:.8em;-moz-border-radius:.8em;-webkit-border-radius:.8em;z-index:20}div.rui-slider .level{font-size:25%;position:absolute;top:0;left:0;width:0;height:100%;background:#ddd;z-index:1}div.rui-slider-vertical{height:10em;width:0.4em;margin:0 .3em}div.rui-slider-vertical .handle{top:auto;bottom:0;margin:0;margin-left:-4pt;margin-bottom:0.4em;height:5pt;width:10pt}div.rui-slider-vertical .level{height:0;width:100%;top:auto;bottom:0}");
e.type="text/css";n.getElementsByTagName("head")[0].appendChild(e);e.styleSheet?e.styleSheet.cssText=v.nodeValue:e.appendChild(v);return j}(document,Math,RightJS);var Sortable=RightJS.Sortable=function(n,c){function h(a){var c=a.find(l.Options.cssRule+",*.rui-sortable");c&&l.cast(c).startDrag(a)}function f(a){l.current&&(a.preventDefault(),l.current.moveItem(a))}function r(a){l.current&&l.current.finishDrag(a)}var p=c.$,i=c.$w,s=c.isString,e=c.isArray,k=c.Object,l=new function(a,e){e||(e=a,a="DIV");var f=new c.Class(c.Element.Wrappers[a]||c.Element,{initialize:function(b,d){this.key=b;var e=[{"class":"rui-"+b}];this instanceof c.Input||this instanceof c.Form||
e.unshift(a);this.$super.apply(this,e);c.isString(d)&&(d=c.$(d));if(d instanceof c.Element){this._=d._;if("$listeners"in d)d.$listeners=d.$listeners;d={}}this.setOptions(d,this);return c.Wrapper.Cache[c.$uid(this._)]=this},setOptions:function(a,d){d&&(a=c.Object.merge(a,(new Function("return "+(d.get("data-"+this.key)||"{}")))()));a&&c.Options.setOptions.call(this,c.Object.merge(this.options,a));return this}}),f=new c.Class(f,e);c.Observer.createShortcuts(f.prototype,f.EVENTS||c([]));return f}("UL",
{extend:{version:"2.2.1",EVENTS:i("start change finish"),Options:{url:null,method:"put",Xhr:{},idParam:"id",posParam:"position",parseId:true,dragClass:"dragging",accept:null,minLength:1,itemCss:"li",handleCss:"li",cssRule:"*[data-sortable]"},current:false,cast:function(a){a=p(a._);a instanceof l||(a=new l(a));return a}},initialize:function(a,c){this.$super("sortable",a).setOptions(c).addClass("rui-sortable").on("finish",this._tryXhr).on("selectstart","stopEvent")},setOptions:function(a,f){this.$super(a,
f);var a=this.options,h=a.accept||[];e(h)||(h=[h]);a.accept=c([this].concat(h)).map(p).uniq();return this},items:function(){return this.children(this.options.itemCss)},startDrag:function(a){if(!(this.items().length<=this.options.minLength)){var c=a.find(this.options.itemCss),e=a.find(this.options.handleCss);if(c&&e)this._initDrag(c,a.position()),l.current=this,this.fire("start",this._evOpts(a))}},moveItem:function(a){var c=a.position(),e=this.itemClone._.style,b=c.y-this.yRDiff,d=c.x-this.xRDiff,
f=d+this.cloneWidth,h=b+this.cloneHeight;e.top=c.y-this.yDiff+"px";e.left=c.x-this.xDiff+"px";if(c=this.suspects.first(function(a){return(b>a.top&&b<a.topHalf||h<a.bottom&&h>a.topHalf)&&(d>a.left&&d<a.leftHalf||f<a.right&&f>a.leftHalf)}))e=c.item,e.insert(this.item,e.prevSiblings().include(this.item)?"after":"before"),this._findSuspects(),this.fire("change",this._evOpts(a,e))},finishDrag:function(a){this.itemClone&&(this.itemClone.remove(),this.item.setStyle("visibility:visible"));l.current=false;
this.fire("finish",this._evOpts(a))},_evOpts:function(a,c){var c=c||this.item,e=l.cast(c.parent());return{list:e,item:c,event:a,index:e.items().indexOf(c)}},_initDrag:function(a,c){this.dimensions();var e=a.dimensions(),b=a.clone().setStyle({margin:0,zIndex:9999,position:"absolute",top:"0px",left:"0px"}).addClass(this.options.dragClass).insertTo(this).setHeight(this.cloneHeight=e.height).setWidth(this.cloneWidth=e.width),d=b.position(),f=e.left-d.x,e=e.top-d.y;b.moveTo(f,e);this.item=a.setStyle("visibility:hidden");
this.itemClone=b;this.xDiff=c.x-f;this.yDiff=c.y-e;this.xRDiff=c.x-b.position().x;this.yRDiff=c.y-b.position().y;this._findSuspects()},_findSuspects:function(){var a=this.suspects=c([]),e=this.item,f=this.itemClone;this.options.accept.each(function(b){l.cast(b).items().each(function(b){if(b!==e&&b!==f){var c=b.dimensions();a.push({item:b,top:c.top,left:c.left,right:c.left+c.width,bottom:c.top+c.height,topHalf:c.top+c.height/2,leftHalf:c.left+c.width/2})}})})},_tryXhr:function(a){if(this.options.url){var e=
c(this.options.url),f={},b=a.item,a=a.index+1,d=k.merge({method:this.options.method,params:{}},this.options.Xhr),b=b.get("id")||"";this.options.parseId&&b&&(b=(b.match(/\d+/)||[""])[0]);e.include("%{id}")?e=e.replace("%{id}",b):f[this.options.idParam]=b;f[this.options.posParam]=a;s(d.params)?d.params+="&"+k.toQueryString(f):d.params=k.merge(d.params,f);c.Xhr.load(e,d)}}});p(n).on({mousedown:h,touchstart:h,mousemove:f,touchmove:f,mouseup:r,touchend:r});p(window).onBlur(function(){l.current&&l.current.finishDrag()});
var i=n.createElement("style"),t=n.createTextNode(".rui-sortable{user-select:none;-moz-user-select:none;-webkit-user-select:none}");i.type="text/css";n.getElementsByTagName("head")[0].appendChild(i);i.styleSheet?i.styleSheet.cssText=t.nodeValue:i.appendChild(t);return l}(document,RightJS);var Tooltip=RightJS.Tooltip=function(n,c){var h=c.$,f=c.$w,r=c.$uid,p=c.Element,i=new function(e,f){f||(f=e,e="DIV");var h=new c.Class(c.Element.Wrappers[e]||c.Element,{initialize:function(f,a){this.key=f;var h=[{"class":"rui-"+f}];this instanceof c.Input||this instanceof c.Form||h.unshift(e);this.$super.apply(this,h);c.isString(a)&&(a=c.$(a));if(a instanceof c.Element){this._=a._;if("$listeners"in a)a.$listeners=a.$listeners;a={}}this.setOptions(a,this);return c.Wrapper.Cache[c.$uid(this._)]=this},
setOptions:function(e,a){a&&(e=c.Object.merge(e,(new Function("return "+(a.get("data-"+this.key)||"{}")))()));e&&c.Options.setOptions.call(this,c.Object.merge(this.options,e));return this}}),h=new c.Class(h,f);c.Observer.createShortcuts(h.prototype,h.EVENTS||c([]));return h}({extend:{version:"2.2.1",EVENTS:f("show hide"),Options:{cssRule:"[data-tooltip]",fxName:"fade",fxDuration:400,delay:400,move:true,idSuffix:"-tooltip"},current:null,instances:c([]),find:function(c){c=c.target;if(c.match(i.Options.cssRule)){var f=
r(c);return i.instances[f]||(i.instances[f]=new i(c))}}},initialize:function(c,f){this.associate=c=h(c);this.$super("tooltip").setOptions(f,c).insert('<div class="rui-tooltip-arrow"></div><div class="rui-tooltip-container">'+(c.get("title")||c.get("alt"))+"</div>").on({mouseout:this._mouseOut,mouseover:this._cancelTimer}).insertTo(n.body);c.has("id")&&this.set("id",c.get("id")+this.options.idSuffix);c.set({title:"",alt:""})},hide:function(){this._cancelTimer();this._timer=c(function(){p.prototype.hide.call(this,
this.options.fxName,{engine:"javascript",duration:this.options.fxDuration});i.current=null;this.fire("hide")}).bind(this).delay(100);return this},show:function(){i.instances.each(function(c){c&&c!==this&&c.hide()},this);this._timer=c(function(){p.prototype.show.call(this.stop(),this.options.fxName,{engine:"javascript",duration:this.options.fxDuration});i.current=this.fire("show")}).bind(this).delay(this.options.delay);return i.current=this},moveToEvent:function(c){if(this.options.move)this._.style.left=
c.pageX+"px",this._.style.top=c.pageY+"px";return this},_cancelTimer:function(){if(this._timer)this._timer.cancel(),this._timer=null;return false},_mouseOut:function(c){c.stop();c.relatedTarget!==this.associate&&this.hide()}});h(n).on({mouseenter:function(c){var f=i.find(c);f&&f.show().moveToEvent(c)},mouseleave:function(c){(c=i.find(c))&&c.hide()},mousemove:function(c){var f=i.current;f!==null&&f.options.move&&f.moveToEvent(c)}});var f=n.createElement("style"),s=n.createTextNode("div.rui-tooltip{display:none;position:absolute;z-index:99999;font-size:90%;margin-top:16pt;margin-left:5pt;color:#FFF;text-shadow:0 0 .2em #000;border:.3em solid rgba(255,255,255,0.2);background-color:rgba(25,25,25,0.92);background-color:#000 \\9;border:.3em solid #444 \\9;background-image:-webkit-gradient(linear,0% 0%,0% 100%,from(transparent) ,to(#000) );border-radius:.4em;-moz-border-radius:.4em;-webkit-border-radius:.4em;box-shadow:0 0 .4em #555;-moz-box-shadow:0 0 .4em #555;-webkit-box-shadow:0 0 .4em #555}div.rui-tooltip-container{margin:.4em .6em}");
f.type="text/css";n.getElementsByTagName("head")[0].appendChild(f);f.styleSheet?f.styleSheet.cssText=s.nodeValue:f.appendChild(s);return i}(document,RightJS);
