/* This is a packed Oskari bundle (bundle script version Thu May 31 2012 12:02:04 GMT+0300 (Suomen kes√§aika)) */ 
Oskari.clazz.define("Oskari.poc.oskari.bundle.MapPublisherBundleInstance",function(){this.map=null;this.core=null;this.sandbox=null;this.mapmodule=null;this.started=false;this.plugins={}},{__name:"Oskari.poc.oskari.bundle.MapPublisherBundleInstance",getName:function(){return this.__name},getSandbox:function(){return this.sandbox},start:function(){if(this.started){return}this.started=true;var a=Oskari.$("sandbox");this.sandbox=a;a.register(this);for(p in this.eventHandlers){a.registerForEventByName(this,p)}var b=a.getRequestBuilder("userinterface.AddExtensionRequest")(this);a.request(this,b)},init:function(){return null},update:function(){},afterChangeMapLayerOpacityEvent:function(a){},onEvent:function(b){var a=this.eventHandlers[b.getName()];if(!a){return}return a.apply(this,[b])},eventHandlers:{},stop:function(){var a=this.sandbox;for(p in this.eventHandlers){a.unregisterFromEventByName(this,p)}var b=a.getRequestBuilder("userinterface.RemoveExtensionRequest")(this);a.request(this,b);this.sandbox.unregister(this);this.started=false},setSandbox:function(a){this.sandbox=null},startExtension:function(){this.plugins["Oskari.userinterface.Flyout"]=Oskari.clazz.create("Oskari.poc.oskari.mappublisher.Flyout",this);this.plugins["Oskari.userinterface.Tile"]=Oskari.clazz.create("Oskari.poc.oskari.mappublisher.Tile",this)},stopExtension:function(){this.plugins["Oskari.userinterface.Flyout"]=null;this.plugins["Oskari.userinterface.Tile"]=null},getTitle:function(){return"Layer Selection"},getDescription:function(){return"Sample"},getPlugins:function(){return this.plugins}},{protocol:["Oskari.bundle.BundleInstance","Oskari.mapframework.module.Module","Oskari.userinterface.Extension"]});Oskari.clazz.define("Oskari.poc.oskari.mappublisher.Flyout",function(a){this.instance=a;this.container=null;this.template=null;this.state=null;this.mapmodule=null;this.map=null},{getName:function(){return"Oskari.poc.oskari.mappublisher.Flyout"},setEl:function(c,b,a){this.container=$(c)},startPlugin:function(){var d=this;this.template=$('<div style="border:2pt dashed grey; margin:0; padding:0; height:400px;width:540px;" class="mappublisher"><div style="position:relative;border:2pt solid black;left: 10px; top:10px; height:95%;width:95%;" class="map"></div></div>');var b=d.instance.getSandbox();this.createMapModule();var a=this.mapmodule;var e=this.map;var c=b.getMap();e.setCenter(new OpenLayers.LonLat(c.getX(),c.getY()),c.getZoom(),false);this.refresh();a.start(b);a.updateCurrentState()},stopPlugin:function(){var c=this;var a=this.mapmodule;var b=c.instance.getSandbox();a.stop(b);b.unregister(c.mapmodule);this.container.empty()},getTitle:function(){return"Valitut karttatasot"},getDescription:function(){},getOptions:function(){},setState:function(a){this.state=a;console.log("Flyout.setState",this,a)},refresh:function(){var b=this.container;var a=this.template;var e=a.clone();e.appendTo(b);var c=e.children(".map");var d=this.map;d.render(c[0]);RightJS.$(e[0]).makeResizable()},createMapModule:function(){var h=this;var k=h.instance.getSandbox();var l=false;var j=false;var c=false;var d=true;var b=Oskari.clazz.create("Oskari.mapframework.ui.module.common.MapModule","MapPubslizer",l,j,c,d);b.setStealth(true);this.mapmodule=b;var a=k.register(b);var e=[];e.push("Oskari.mapframework.bundle.mapmodule.plugin.LayersPlugin");e.push("Oskari.mapframework.mapmodule.WmsLayerPlugin");e.push("Oskari.mapframework.mapmodule.ControlsPlugin");for(var f=0;f<e.length;f++){var g=Oskari.clazz.create(e[f]);b.registerPlugin(g)}a.addControl(new OpenLayers.Control.TouchNavigation({dragPanOptions:{enableKinetic:true}}));this.map=a}},{protocol:["Oskari.userinterface.Flyout"]});Oskari.clazz.define("Oskari.poc.oskari.mappublisher.Tile",function(a){this.instance=a;this.container=null;this.template=null},{getName:function(){return"Oskari.poc.oskari.mappublisher.Tile"},setEl:function(c,b,a){this.container=$(c)},startPlugin:function(){this.refresh()},stopPlugin:function(){this.container.empty()},getTitle:function(){return"Julkaise kartta"},getDescription:function(){},getOptions:function(){},setState:function(a){console.log("Tile.setState",this,a)
},refresh:function(){var d=this;var a=d.instance;var c=this.container;var b=this.template}},{protocol:["Oskari.userinterface.Tile"]});