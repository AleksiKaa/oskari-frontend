/* This is a packed Oskari bundle (bundle script version Thu May 31 2012 11:30:12 GMT+0300 (Suomen kes√§aika)) */ 
Oskari.clazz.define("Oskari.poc.yuilibrary.bundle.FeatureInfoBundleInstance",function(){this.map=null;this.core=null;this.sandbox=null;this.mapmodule=null;this.started=false;this.template=null;this.plugins={};this.yuilibrary=null},{__name:"YUILibraryFeatureInfo",getName:function(){return this.__name},getSandbox:function(){return this.sandbox},start:function(){var c=this;if(c.started){return}c.started=true;var a=Oskari.$("sandbox");c.sandbox=a;a.register(c);for(p in c.eventHandlers){a.registerForEventByName(c,p)}var b=a.getRequestBuilder("userinterface.AddExtensionRequest")(this);a.request(this,b);c.mediator.bundle.require(function(d){c.yuilibrary=d;c.refresh()})},init:function(){return null},update:function(){},afterChangeMapLayerOpacityEvent:function(a){},onEvent:function(b){var a=this.eventHandlers[b.getName()];if(!a){return}return a.apply(this,[b])},eventHandlers:{AfterMapLayerAddEvent:function(a){this.refresh()},AfterMapLayerRemoveEvent:function(a){this.refresh()},AfterMapMoveEvent:function(a){},AfterChangeMapLayerOpacityEvent:function(a){if(this.sandbox.getObjectCreator(a)!=this.getName()){this.afterChangeMapLayerOpacityEvent(a)}}},stop:function(){var a=this.sandbox();for(p in this.eventHandlers){a.unregisterFromEventByName(this,p)}var b=a.getRequestBuilder("userinterface.RemoveExtensionRequest")(this);a.request(this,b);this.sandbox.unregister(this);this.started=false},setSandbox:function(a){this.sandbox=null},startExtension:function(){this.plugins["Oskari.userinterface.Flyout"]=Oskari.clazz.create("Oskari.poc.yuilibrary.featureinfo.Flyout",this);this.plugins["Oskari.userinterface.Tile"]=Oskari.clazz.create("Oskari.poc.yuilibrary.featureinfo.Tile",this)},stopExtension:function(){this.plugins["Oskari.userinterface.Flyout"]=null;this.plugins["Oskari.userinterface.Tile"]=null},getTitle:function(){return"Layer Selection"},getDescription:function(){return"Sample"},getPlugins:function(){return this.plugins},refresh:function(){var a=this;if(!a.yuilibrary){return}this.plugins["Oskari.userinterface.Flyout"].setYUILibrary(a.yuilibrary);this.plugins["Oskari.userinterface.Flyout"].refresh();this.plugins["Oskari.userinterface.Tile"].setYUILibrary(a.yuilibrary);this.plugins["Oskari.userinterface.Tile"].refresh()}},{protocol:["Oskari.bundle.BundleInstance","Oskari.mapframework.module.Module","Oskari.userinterface.Extension"]});Oskari.clazz.define("Oskari.poc.yuilibrary.featureinfo.Flyout",function(a){this.instance=a;this.container=null;this.template=null;this.state=null;this.yuilibrary=null},{setYUILibrary:function(a){this.yuilibrary=a},getName:function(){return"Oskari.poc.yuilibrary.featureinfo.Flyout"},setEl:function(c,b,a){this.container=c[0]},startPlugin:function(){},stopPlugin:function(){},getTitle:function(){return"Valitut karttatasot"},getDescription:function(){},getOptions:function(){},setState:function(a){this.state=a;console.log("Flyout.setState",this,a)},refresh:function(){var f=this;var i=f.instance.getSandbox();var c=f.yuilibrary;var d=f.template;if(!d){d=c.Node.create('<div class="grid"></div>');f.template=d}var g=c.one(this.container);g.empty();var h=d.cloneNode(true);var b="http://query.yahooapis.com/v1/public/yql?format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys",e="&q="+encodeURIComponent('select * from local.search where zip = "94089" and query = "pizza"'),a,j;a=new c.DataSource.Get({source:b});a.plug(c.Plugin.DataSourceJSONSchema,{schema:{resultListLocator:"query.results.Result",resultFields:["Title","Phone",{key:"Rating.AverageRating",parser:function(k){return isNaN(k)?"(none)":k}}]}});j=new c.DataTable.Base({columnset:["Title","Phone",{key:"Rating.AverageRating",label:"Rating"}],summary:"Pizza places near 98089",caption:"Table with JSON data from YQL"});j.plug(c.Plugin.DataTableDataSource,{datasource:a});j.plug(c.Plugin.DataTableScroll,{width:"500px",height:"400px"});j.render(h);g.appendChild(h);j.datasource.load({request:e})}},{protocol:["Oskari.userinterface.Flyout"]});Oskari.clazz.define("Oskari.poc.yuilibrary.featureinfo.Tile",function(a){this.instance=a;this.container=null;this.template=null;
this.yuilibrary=null},{setYUILibrary:function(a){this.yuilibrary=a},getName:function(){return"Oskari.poc.yuilibrary.featureinfo.Tile"},setEl:function(c,b,a){this.container=$(c)},startPlugin:function(){this.refresh()},stopPlugin:function(){this.container.empty()},getTitle:function(){return"Kohdetiedot"},getDescription:function(){},getOptions:function(){},setState:function(a){console.log("Tile.setState",this,a)},refresh:function(){var e=this;var a=e.instance;var d=this.container;var c=this.template;var b=a.getSandbox();var f=b.findAllSelectedMapLayers()}},{protocol:["Oskari.userinterface.Tile"]});