Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.ToolbarBundleInstance",function(){this.sandbox=null,this.started=!1,this.buttons={},this.selectedButton=null,this.defaultButton=null,this.container=null,this.menutoolbarcontainer=null,this.containers={},this.toolbars={},this.groupsToToolbars={}},{__name:"Toolbar",getName:function(){return this.__name},setSandbox:function(e){this.sandbox=e},getSandbox:function(){return this.sandbox},update:function(){},start:function(){var e=this;if(e.started)return;e.started=!0;var t=e.conf,n=(t?t.sandbox:null)||"sandbox",r=Oskari.getSandbox(n);r.register(e),e.setSandbox(r);var i=(t?t.defaultToolbarContainer:null)||"#toolbar";this.container=jQuery(i),this.containers["default"]=this.container,this.toolbars["default"]=this.container;var s=(t?t.defaultMenuToolbarContainer:null)||"#menutoolbar";this.menutoolbarcontainer=jQuery(s);for(var o in e.eventHandlers)o&&r.registerForEventByName(e,o);r.addRequestHandler("Toolbar.AddToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),r.addRequestHandler("Toolbar.RemoveToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),r.addRequestHandler("Toolbar.ToolButtonStateRequest",this.requestHandlers.toolButtonRequestHandler),r.addRequestHandler("Toolbar.SelectToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),r.addRequestHandler("Toolbar.ToolbarRequest",this.requestHandlers.toolbarRequestHandler),r.addRequestHandler("ShowMapMeasurementRequest",this.requestHandlers.showMapMeasurementRequestHandler),r.registerAsStateful(this.mediator.bundleId,this),this._addDefaultButtons&&this._addDefaultButtons()},templates:{group:'<div class="toolrow"></div>',tool:'<div class="tool"></div>',menutoolbar:'<div class="oskari-closed oskariui-menutoolbar"><div class="oskariui-menutoolbar-modetitle"><div class="oskariui-menutoolbar-title"><p></p></div></div><div class="oskariui-menutoolbar-container"><div class="oskariui-menutoolbarbuttongroup"></div></div><div class="oskariui-menutoolbar-closebox"><div class="icon-close-white"></div></div></div>'},init:function(){var e=this;this.templateGroup=jQuery(this.templates.group),this.templateTool=jQuery(this.templates.tool),this.templateMenutoolbar=jQuery(this.templates.menutoolbar),this.requestHandlers={toolButtonRequestHandler:Oskari.clazz.create("Oskari.mapframework.bundle.toolbar.request.ToolButtonRequestHandler",e),toolbarRequestHandler:Oskari.clazz.create("Oskari.mapframework.bundle.toolbar.request.ToolbarRequestHandler",e),showMapMeasurementRequestHandler:Oskari.clazz.create("Oskari.mapframework.bundle.toolbar.request.ShowMapMeasurementRequestHandler",e)}},createMenuToolbarContainer:function(e,t){var n=t||{},r=this.templateMenutoolbar.clone();this.menutoolbarcontainer.append(r),this.toolbars[e]=r;var i=r.find(".oskariui-menutoolbarbuttongroup");return this.containers[e]=i,n.title&&r.find(".oskariui-menutoolbar-title p").append(n.title),n.show&&r.removeClass("oskari-closed"),n.closeBoxCallback&&r.find(".oskariui-menutoolbar-closebox div").click(n.closeBoxCallback),i},changeMenuToolbarTitle:function(e){e&&this.menutoolbarcontainer.find(".oskariui-menutoolbar-title p").html(e)},getToolbarContainer:function(e,t){var n=e||"default",r=this.containers[n];return r===undefined&&this.menutoolbarcontainer&&(r=this.createMenuToolbarContainer(n,t)),r},onEvent:function(e){var t=this,n=t.eventHandlers[e.getName()];if(!n)return;return n.apply(this,[e])},measureTools:{basictools:{measureline:!0,measurearea:!0}},eventHandlers:{"Toolbar.ToolSelectedEvent":function(e){var t=this,n=this.getSandbox();if(!t.measureTools[e.getGroupId()])return;if(!t.measureTools[e.getGroupId()][e.getToolId()])return;var r=t.getLocalization("measure").guidance[e.getToolId()];n.request(t,n.getRequestBuilder("ShowMapMeasurementRequest")(r?r:"",!1,null,null))}},stop:function(){var e=this,t=e.sandbox();for(var n in e.eventHandlers)n&&t.unregisterFromEventByName(e,n);t.removeRequestHandler("ShowMapMeasurementRequest",this.requestHandlers.showMapMeasurementRequestHandler),t.removeRequestHandler("Toolbar.ToolbarRequest",this.requestHandlers.toolbarRequestHandler),t.removeRequestHandler("Toolbar.AddToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),t.removeRequestHandler("Toolbar.RemoveToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),t.removeRequestHandler("Toolbar.ToolButtonStateRequest",this.requestHandlers.toolButtonRequestHandler),t.removeRequestHandler("Toolbar.SelectToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),this.sandbox.unregisterStateful(this.mediator.bundleId),e.sandbox.unregister(e),e.started=!1},getLocalization:function(e){return this._localization||(this._localization=Oskari.getLocalization(this.getName())),e?this._localization[e]:this._localization},setState:function(e){if(!e)return;if(e.selected){this.selectedButton=e.selected;var t=e.selected.id,n=e.selected.group,r=this.getToolbarContainer();this._removeToolSelections();var i=r.find("div.toolrow[tbgroup="+n+"]");if(i.length>0){var s=i.find("div.tool[tool="+t+"]");s.length>0&&(s.addClass("selected"),this.buttons[n][t].callback())}}else this.selectedButton=null},getState:function(){var e={};return this.selectedButton&&(e.selected=this.selectedButton),e},_removeToolbar:function(e){var t=this.toolbars[e];this.toolbars[e]=undefined,t.remove(),delete t},_showToolbar:function(e){this.toolbars[e].show()},_hideToolbar:function(e){this.toolbars[e].hide()},_addToolbar:function(e,t){this.getToolbarContainer(e,t)}},{protocol:["Oskari.bundle.BundleInstance","Oskari.mapframework.module.Module"]}),define("bundles/framework/bundle/toolbar/instance",function(){}),Oskari.clazz.category("Oskari.mapframework.bundle.toolbar.ToolbarBundleInstance","button-methods",{addToolButton:function(e,t,n){if(!e||!t||!n||!n.callback)return;var r=this,i=this.getToolbarContainer(n?n.toolbarid:null,n),s=null;this.buttons[t]?s=i.find("div.toolrow[tbgroup="+t+"]"):(this.buttons[t]={},s=this.templateGroup.clone(),s.attr("tbgroup",t),i.append(s),this.groupsToToolbars[t]=n?n.toolbarid:null);if(this.buttons[t][e])return;this.buttons[t][e]=n;var o=this.templateTool.clone();o.attr("tool",e),o.attr("title",n.tooltip),o.addClass(n.iconCls),this.selectedButton?this.selectedButton.id==e&&this.selectedButton.group==t&&(o.addClass("selected"),n.callback()):n.selected&&(o.addClass("selected"),this.selectedButton={id:e,group:t}),n.selected&&(this.defaultButton={id:e,group:t}),o.bind("click",function(n){r._clickButton(e,t)}),n.prepend?s.prepend(o):s.append(o),n.disabled===!0&&o.addClass("disabled")},_clickButton:function(e,t){e||(e=this.defaultButton.id,t=this.defaultButton.group);var n=this.buttons[t][e];if(n.enabled==0)return;if(n.sticky==1){var r=this.sandbox.getEventBuilder("Toolbar.ToolSelectedEvent")(e,t);this.sandbox.notifyAll(r),this._removeToolSelections(t);var i=this.getToolbarContainer(this.groupsToToolbars[t]),s=i.find("div.toolrow[tbgroup="+t+"]"),o=s.find("div.tool[tool="+e+"]");o.addClass("selected"),this.selectedButton={id:e,group:t}}if(n.toggleSelection){var i=this.getToolbarContainer(this.groupsToToolbars[t]),s=i.find("div.toolrow[tbgroup="+t+"]"),o=s.find("div.tool[tool="+e+"]");o.hasClass("selected")?o.removeClass("selected"):o.addClass("selected")}n.callback()},_removeToolSelections:function(e){var t=this.getToolbarContainer(this.groupsToToolbars[e]),n=t.find("div.tool");n.removeClass("selected")},removeToolButton:function(e,t){if(!t)return;if(this.buttons[t]){var n=this.getToolbarContainer(this.groupsToToolbars[t]),r=n.find("div.toolrow[tbgroup="+t+"]");if(e){var i=r.find("div.tool[tool="+e+"]");i.remove(),this.buttons[t][e]=null,delete this.buttons[t][e]}else r.remove(),this.buttons[t]=null,delete this.buttons[t]}},changeToolButtonState:function(e,t,n){if(!t)return;if(this.buttons[t]){var r=this.getToolbarContainer(this.groupsToToolbars[t]),i=r.find("div.toolrow[tbgroup="+t+"]");if(e){var s=i.find("div.tool[tool="+e+"]");this.buttons[t][e].enabled=n,n?s.removeClass("disabled"):s.addClass("disabled")}else{var o=i.find("div.tool");n?o.removeClass("disabled"):o.addClass("disabled");for(var u in this.buttons[t])this.buttons[t][u].enabled=n}}}}),define("bundles/framework/bundle/toolbar/button-methods",function(){}),Oskari.clazz.category("Oskari.mapframework.bundle.toolbar.ToolbarBundleInstance","default-buttons",{_isButtonConfigured:function(e,t){return this.conf&&(this.conf[t]===!1||this.conf[t]&&this.conf[t][e]===!1)?!1:!0},_addDefaultButtons:function(){var e=this,t=this.getLocalization("buttons"),n=this.getSandbox().getRequestBuilder("ToolSelectionRequest"),r="MapModulePlugin.GetFeatureInfoActivationRequest",i=this.getSandbox().getRequestBuilder(r);this._isButtonConfigured("reset","history")&&this.addToolButton("reset","history",{iconCls:"tool-reset",tooltip:t.history.reset,sticky:!1,callback:function(){var t=e.getSandbox().getRequestBuilder("StateHandler.SetStateRequest");t&&e.getSandbox().request(e,t());var n=e.getSandbox().getRequestBuilder("ClearHistoryRequest")();e.getSandbox().request(e,n)}}),this._isButtonConfigured("history_back","history")&&this.addToolButton("history_back","history",{iconCls:"tool-history-back",tooltip:t.history.back,sticky:!1,callback:function(){e.getSandbox().request(e,n("map_control_tool_prev"))}}),this._isButtonConfigured("history_forward","history")&&this.addToolButton("history_forward","history",{iconCls:"tool-history-forward",tooltip:t.history.next,sticky:!1,callback:function(){e.getSandbox().request(e,n("map_control_tool_next"))}}),this._isButtonConfigured("zoombox","basictools")&&this.addToolButton("zoombox","basictools",{iconCls:"tool-zoombox",tooltip:t.zoom,sticky:!0,callback:function(){var t="map_control_zoom_tool";e.getSandbox().request(e,i(!1)),e.getSandbox().request(e,n(t))}}),this._isButtonConfigured("select","basictools")&&this.addToolButton("select","basictools",{iconCls:"tool-pan",tooltip:t.pan,selected:!0,sticky:!0,callback:function(){var t="map_control_navigate_tool";e.getSandbox().request(e,i(!0)),e.getSandbox().request(e,n(t))}}),this._isButtonConfigured("measureline","basictools")&&this.addToolButton("measureline","basictools",{iconCls:"tool-measure-line",tooltip:t.measure.line,sticky:!0,callback:function(){var t="map_control_measure_tool";e.getSandbox().request(e,i(!1)),e.getSandbox().request(e,n(t))}}),this._isButtonConfigured("measurearea","basictools")&&this.addToolButton("measurearea","basictools",{iconCls:"tool-measure-area",tooltip:t.measure.area,sticky:!0,callback:function(){var t="map_control_measure_area_tool";e.getSandbox().request(e,i(!1)),e.getSandbox().request(e,n(t))}}),this._isButtonConfigured("link","viewtools")&&this.addToolButton("link","viewtools",{iconCls:"tool-link",tooltip:t.link.tooltip,sticky:!1,callback:function(){var n=e.getSandbox().generateMapLinkParameters({showMarker:!0}),r="Oskari.userinterface.component.Popup",i="Oskari.userinterface.component.Button",s=Oskari.clazz.create(r);s.addClass("no_resize");var o=Oskari.clazz.create(i);o.setTitle(t.link.ok),o.addClass("primary"),o.setHandler(function(){var t="EnableMapKeyboardMovementRequest";s.close(),e.getSandbox().postRequestByName(t)});var u='<textarea rows="3" cols="80">'+t.link.prefixUrl+n+"</textarea>",a="DisableMapKeyboardMovementRequest";e.getSandbox().postRequestByName(a),s.show(t.link.title,u,[o])}}),this._isButtonConfigured("print","viewtools")&&this.addToolButton("print","viewtools",{iconCls:"tool-print",tooltip:t.print.tooltip,sticky:!1,callback:function(){var t="location=1,status=1,scrollbars=1,width=850,height=1200",n=window.location.pathname+"?"+e.getSandbox().generateMapLinkParameters()+"&p_p_id=Portti2Map_WAR_portti2mapportlet&p_p_lifecycle=0&p_p_state=exclusive"+"&showMarker=false&forceCache=true&mapmode=print&viewId=2";window.open(n,"Print",t)}})}}),define("bundles/framework/bundle/toolbar/default-buttons",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.AddToolButtonRequest",function(e,t,n){this._id=e,this._group=t,this._config=n},{__name:"Toolbar.AddToolButtonRequest",getName:function(){return this.__name},getId:function(){return this._id},getGroup:function(){return this._group},getConfig:function(){return this._config}},{protocol:["Oskari.mapframework.request.Request"]}),define("bundles/framework/bundle/toolbar/request/AddToolButtonRequest",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.RemoveToolButtonRequest",function(e,t){this._id=e,this._group=t},{__name:"Toolbar.RemoveToolButtonRequest",getName:function(){return this.__name},getId:function(){return this._id},getGroup:function(){return this._group}},{protocol:["Oskari.mapframework.request.Request"]}),define("bundles/framework/bundle/toolbar/request/RemoveToolButtonRequest",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.ToolButtonStateRequest",function(e,t,n){this._id=e,this._group=t,this._state=n==1},{__name:"Toolbar.ToolButtonStateRequest",getName:function(){return this.__name},getId:function(){return this._id},getGroup:function(){return this._group},getState:function(){return this._state}},{protocol:["Oskari.mapframework.request.Request"]}),define("bundles/framework/bundle/toolbar/request/ToolButtonStateRequest",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.SelectToolButtonRequest",function(e,t){this._id=e,this._group=t},{__name:"Toolbar.SelectToolButtonRequest",getName:function(){return this.__name},getId:function(){return this._id},getGroup:function(){return this._group}},{protocol:["Oskari.mapframework.request.Request"]}),define("bundles/framework/bundle/toolbar/request/SelectToolButtonRequest",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.ToolButtonRequestHandler",function(e){this._toolbar=e},{handleRequest:function(e,t){var n=e.getSandbox();t.getName()=="Toolbar.AddToolButtonRequest"?this._handleAdd(n,t):t.getName()=="Toolbar.RemoveToolButtonRequest"?this._handleRemove(n,t):t.getName()=="Toolbar.ToolButtonStateRequest"?this._handleState(n,t):t.getName()=="Toolbar.SelectToolButtonRequest"&&this._handleClick(n,t)},_handleAdd:function(e,t){this._toolbar.addToolButton(t.getId(),t.getGroup(),t.getConfig())},_handleRemove:function(e,t){this._toolbar.removeToolButton(t.getId(),t.getGroup())},_handleState:function(e,t){this._toolbar.changeToolButtonState(t.getId(),t.getGroup(),t.getState())},_handleClick:function(e,t){this._toolbar._clickButton(t.getId(),t.getGroup())}},{protocol:["Oskari.mapframework.core.RequestHandler"]}),define("bundles/framework/bundle/toolbar/request/ToolButtonRequestHandler",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.ShowMapMeasurementRequestHandler",function(e){var t=this;t._toolbar=e;var n=this._toolbar.getLocalization("measure"),r=n.title;t._title=r,t._dialog=Oskari.clazz.create("Oskari.userinterface.component.Popup"),t._dialog.addClass("oskari-measurement");var i=[],s=Oskari.clazz.create("Oskari.userinterface.component.Button");s.setTitle(n.close),i.push(s),t._buttons=i,t._dialogShown=!1,t._content=null},{handleRequest:function(e,t){var n=e.getSandbox();this._showMeasurementResults(t.getValue())},getValue:function(){return this._value},_showMeasurementResults:function(e){var t=this,n=t._dialog;if(!t._dialogShown){n.show(t._title,"",t._buttons);var r=t._buttons[0];r.setHandler(function(){t._dialogShown=!1;var e=t._toolbar.getSandbox().getRequestBuilder("Toolbar.SelectToolButtonRequest")();t._toolbar.getSandbox().request(t._toolbar,e),t._dialog.close(!0)}),n.moveTo("#toolbar div.toolrow[tbgroup=basictools]","top"),t._content=jQuery("<div></div>"),n.setContent(t._content),t._dialogShown=!0}t._content.html(e)}},{protocol:["Oskari.mapframework.core.RequestHandler"]}),define("bundles/framework/bundle/toolbar/request/ShowMapMeasurementRequestHandler",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.event.ToolSelectedEvent",function(e,t){this._toolId=e,this._groupId=t},{__name:"Toolbar.ToolSelectedEvent",getName:function(){return this.__name},getToolId:function(){return this._toolId},getGroupId:function(){return this._groupId}},{protocol:["Oskari.mapframework.event.Event"]}),define("bundles/framework/bundle/toolbar/event/ToolSelectedEvent",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.ToolbarRequest",function(e,t,n){this._id=e,this._op=t,this._data=n},{__name:"Toolbar.ToolbarRequest",getName:function(){return this.__name},getId:function(){return this._id},getOp:function(){return this._op},getData:function(){return this._data}},{protocol:["Oskari.mapframework.request.Request"]}),define("bundles/framework/bundle/toolbar/request/ToolbarRequest",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.ToolbarRequestHandler",function(e){this._toolbar=e},{handleRequest:function(e,t){var n=e.getSandbox();t.getOp()=="add"?this._toolbar._addToolbar(t.getId(),t.getData()):t.getOp()=="show"?this._toolbar._showToolbar(t.getId()):t.getOp()=="hide"?this._toolbar._hideToolbar(t.getId()):t.getOp()=="remove"?this._toolbar._removeToolbar(t.getId()):t.getOp()=="changeName"&&this._toolbar.changeMenuToolbarTitle(t.getData())},_handleAdd:function(e,t){this._toolbar.addToolButton(t.getId(),t.getGroup(),t.getConfig())},_handleRemove:function(e,t){this._toolbar.removeToolButton(t.getId(),t.getGroup())},_handleState:function(e,t){this._toolbar.changeToolButtonState(t.getId(),t.getGroup(),t.getState())},_handleClick:function(e,t){this._toolbar._clickButton(t.getId(),t.getGroup())}},{protocol:["Oskari.mapframework.core.RequestHandler"]}),define("bundles/framework/bundle/toolbar/request/ToolbarRequestHandler",function(){}),define("normalize",["require","module"],function(e,t){function o(e,t,n){if(e.indexOf("data:")===0)return e;e=r(e);if(e.match(/^\//)||e.match(s))return e;var i=n.match(s),o=t.match(s);return o&&(!i||i[1]!=o[1]||i[2]!=o[2])?u(e,t):a(u(e,t),n)}function u(e,t){e.substr(0,2)=="./"&&(e=e.substr(2));var n=t.split("/"),r=e.split("/");n.pop();while(curPart=r.shift())curPart==".."?n.pop():n.push(curPart);return n.join("/")}function a(e,t){var n=t.split("/");n.pop(),t=n.join("/")+"/",i=0;while(t.substr(i,1)==e.substr(i,1))i++;while(t.substr(i,1)!="/")i--;t=t.substr(i+1),e=e.substr(i+1),n=t.split("/");var r=e.split("/");out="";while(n.shift())out+="../";while(curPart=r.shift())out+=curPart+"/";return out.substr(0,out.length-1)}var n=/([^:])\/+/g,r=function(e){return e.replace(n,"$1/")},s=/[^\:\/]*:\/\/([^\/])*/,f=function(e,t,n,i){t=r(t),n=r(n);var s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\(\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/ig,u,a,e;while(u=s.exec(e)){a=u[3]||u[2]||u[5]||u[6]||u[4];var f;i&&a.substr(0,1)=="/"?f=i+a:f=o(a,t,n);var l=u[5]||u[6]?1:0;e=e.substr(0,s.lastIndex-a.length-l-1)+f+e.substr(s.lastIndex-l-1),s.lastIndex=s.lastIndex+(f.length-a.length)}return e};return f.convertURIBase=o,f}),define("css",["./normalize"],function(e){function t(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}if(typeof window=="undefined")return{load:function(e,t,n){n()}};var n=!1,r=document.getElementsByTagName("head")[0],i=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)/),s=!1;!i||(i[1]||i[7]?(s=parseInt(i[1])<6||parseInt(i[7])<=9,i="trident"):i[2]?(s=!0,i="webkit"):i[3]||(i[4]?(s=parseInt(i[4])<18,i="gecko"):n&&alert("Engine detection failed")));var o={},u=/^\/|([^\:\/]*:)/;o.pluginBuilder="./css-builder";var a=[],f={},l=[];o.addBuffer=function(e){if(t(a,e)!=-1)return;if(t(l,e)!=-1)return;a.push(e),l.push(e)},o.setBuffer=function(t,n){var r=window.location.pathname.split("/");r.pop(),r=r.join("/")+"/";var i=require.toUrl("base_url").split("/");i.pop();var s=i.join("/")+"/";s=e.convertURIBase(s,r,"/"),s.match(u)||(s="/"+s),s.substr(s.length-1,1)!="/"&&(s+="/"),o.inject(e(t,s,r));for(var l=0;l<a.length;l++)(n&&a[l].substr(a[l].length-5,5)==".less"||!n&&a[l].substr(a[l].length-4,4)==".css")&&(function(e){f[e]=f[e]||!0,setTimeout(function(){typeof f[e]=="function"&&f[e](),delete f[e]},7)}(a[l]),a.splice(l--,1))},o.attachBuffer=function(e,n){for(var r=0;r<a.length;r++)if(a[r]==e)return f[e]=n,!0;if(f[e]===!0)return f[e]=n,!0;if(t(l,e)!=-1)return n(),!0};var c=function(e,t){setTimeout(function(){for(var n=0;n<document.styleSheets.length;n++){var r=document.styleSheets[n];if(r.href==e.href)return t()}c(e,t)},10)},h=function(e,t){setTimeout(function(){try{return e.sheet.cssRules,t()}catch(n){}h(e,t)},10)};if(i=="trident"&&s)var p=[],d=[],v=0,m=function(e,t){var n;d.push({url:e,cb:t}),n=p.shift(),!n&&v++<31&&(n=document.createElement("style"),r.appendChild(n)),n&&g(n)},g=function(e){var t=d.shift();if(!t){e.onload=b,p.push(e);return}e.onload=function(){t.cb(t.ss),g(e)};var n=e.styleSheet;t.ss=n.imports[n.addImport(t.url)]};var y=function(e){var t=document.createElement("link");return t.type="text/css",t.rel="stylesheet",t.href=e,t},b=function(){};o.linkLoad=function(e,t){var o=setTimeout(function(){n&&alert("timeout"),t()},L*1e3-100),u=function(){clearTimeout(o),a&&(a.onload=b),setTimeout(t,7)};if(!s){var a=y(e);a.onload=u,r.appendChild(a)}else if(i=="webkit"){var a=y(e);c(a,u),r.appendChild(a)}else if(i=="gecko"){var f=document.createElement("style");f.textContent='@import "'+e+'"',h(f,u),r.appendChild(f)}else i=="trident"&&m(e,u)};var w=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],E={},S=function(e,t,n){if(E[e]){t(E[e]);return}var r,i,s;if(typeof XMLHttpRequest!="undefined")r=new XMLHttpRequest;else if(typeof ActiveXObject!="undefined")for(i=0;i<3;i+=1){s=w[i];try{r=new ActiveXObject(s)}catch(o){}if(r){w=[s];break}}r.open("GET",e,requirejs.inlineRequire?!1:!0),r.onreadystatechange=function(i){var s,o;r.readyState===4&&(s=r.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=r,n(o)):(E[e]=r.responseText,t(r.responseText)))},r.send(null)},x=0,T;o.inject=function(e){x<31&&(T=document.createElement("style"),T.type="text/css",r.appendChild(T),x++),T.styleSheet?T.styleSheet.cssText+=e:T.appendChild(document.createTextNode(e))};var N=/@import\s*(url)?\s*(('([^']*)'|"([^"]*)")|\(('([^']*)'|"([^"]*)"|([^\)]*))\))\s*;?/g,C=window.location.pathname.split("/");C.pop(),C=C.join("/")+"/";var k=function(t,n,r){t.match(u)||(t="/"+e.convertURIBase(t,C,"/")),S(t,function(i){i=e(i,t,C);var s=[],o=[],u=[],a;while(a=N.exec(i)){var f=a[4]||a[5]||a[7]||a[8]||a[9];s.push(f),o.push(N.lastIndex-a[0].length),u.push(a[0].length)}var l=0;for(var c=0;c<s.length;c++)(function(e){k(s[e],function(t){i=i.substr(0,o[e])+t+i.substr(o[e]+u[e]);var r=t.length-u[e];for(var a=e+1;a<s.length;a++)o[a]+=r;l++,l==s.length&&n(i)},r)})(c);s.length==0&&n(i)},r)};o.normalize=function(e,t){return e.substr(e.length-4,4)==".css"&&(e=e.substr(0,e.length-4)),t(e)};var L,A=!1;return o.load=function(e,t,r,i,u){L=L||i.waitSeconds||7;var a=e+(u?".less":".css");if(o.attachBuffer(a,r))return;var f=t.toUrl(a);!A&&n&&(alert(s?"hacking links":"not hacking"),A=!0),u?k(f,function(e){u&&(e=u(e,function(e){o.inject(e),setTimeout(r,7)}))}):o.linkLoad(f,r)},n&&(o.inspect=function(){if(stylesheet.styleSheet)return stylesheet.styleSheet.cssText;if(stylesheet.innerHTML)return stylesheet.innerHTML}),o}),requirejs.s.contexts._.nextTick=function(e){e()},require(["css"],function(e){e.addBuffer("resources/framework/bundle/toolbar/css/toolbar.css")}),requirejs.s.contexts._.nextTick=requirejs.nextTick,Oskari.registerLocalization({lang:"fi",key:"Toolbar",value:{buttons:{link:{tooltip:"Linkki",prefixUrl:"www.paikkatietoikkuna.fi/web/fi/kartta?",ok:"Ok",title:"Linkki karttanäkymään"},print:{tooltip:"Tulosta"},history:{reset:"Paluu oletusnäkymään",back:"Takaisin",next:"Eteenpäin"},pan:"Liikuta karttaa",zoom:"Lähennä",measure:{line:"Mittaa etäisyys",area:"Mittaa alue"}},measure:{title:"Mittaustulokset",close:"Lopeta",guidance:{measureline:"Osoita mitattava matka kartalta. Lopeta mittaaminen hiiren kaksoisnapautuksella.",measurearea:"Osoita mitattava alue kartalta. Lopeta mittaaminen hiiren kaksoisnapautuksella."}}}}),define("bundles/framework/bundle/toolbar/locale/fi",function(){}),Oskari.registerLocalization({lang:"sv",key:"Toolbar",value:{buttons:{link:{tooltip:"Länk",prefixUrl:"www.paikkatietoikkuna.fi/web/sv/kartfonstret?",ok:"Ok",title:"Länk till kartvyn"},print:{tooltip:"Skriv ut"},history:{reset:"Tillbaka till standardvyn",back:"Föregående",next:"Nästa"},pan:"Flytta kartan",zoom:"Zooma in",measure:{line:"Mät avstånd",area:"Mät areal"}},measure:{title:"Mätningsresultat",close:"Avbryt",guidance:{measureline:"Peka ut sträckan som ska mätas på kartan. Sluta mätningen genom att dubbelklicka.",measurearea:"Peka ut området som ska mätas på kartan. Sluta mätningen genom att dubbelklicka."}}}}),define("bundles/framework/bundle/toolbar/locale/sv",function(){}),Oskari.registerLocalization({lang:"en",key:"Toolbar",value:{buttons:{link:{tooltip:"Link",prefixUrl:"www.paikkatietoikkuna.fi/web/en/map-window?",ok:"Ok",title:"Link to map view"},print:{tooltip:"Print"},history:{reset:"Return to default view",back:"Back",next:"Next"},pan:"Pan map view",zoom:"Zoom in",measure:{line:"Measure distance",area:"Measure area"}},measure:{title:"Measurements",close:"Cancel",guidance:{measureline:"Measure a line on the map. Double-click to stop measuring.",measurearea:"Measure an area on the map. Double-click to stop measuring."}}}}),define("bundles/framework/bundle/toolbar/locale/en",function(){}),define("bundles/framework/bundle/toolbar/module",["oskari","jquery","./instance","./button-methods","./default-buttons","./request/AddToolButtonRequest","./request/RemoveToolButtonRequest","./request/ToolButtonStateRequest","./request/SelectToolButtonRequest","./request/ToolButtonRequestHandler","./request/ShowMapMeasurementRequestHandler","./event/ToolSelectedEvent","./request/ToolbarRequest","./request/ToolbarRequestHandler","css!resources/framework/bundle/toolbar/css/toolbar.css","./locale/fi","./locale/sv","./locale/en"],function(e,t){return e.bundleCls("toolbar").category({create:function(){var t=e.clazz.create("Oskari.mapframework.bundle.toolbar.ToolbarBundleInstance");return t},update:function(e,t,n,r){}})}),requirejs.s.contexts._.nextTick=function(e){e()},require(["css"],function(e){e.setBuffer('#toolbar {\r\n  margin-top: 30px;\r\n  width: 100%;\r\n  height: 160px; }\r\n\r\n#toolbar div.toolrow {\r\n  border-top: 1px solid;\r\n  padding: 0px 10px; }\r\n\r\n#toolbar div.toolrow div.tool {\r\n  display: inline-block;\r\n  cursor: pointer; }\r\n\r\n#toolbar div.toolrow div.tool.selected, #toolbar div.toolrow div.tool:hover:not(.disabled), #toolbar div.toolrow div.tool:active:not(.disabled) {\r\n  background-color: #212121; }\r\n\r\n#toolbar div.toolrow div.tool.disabled, div.tool.disabled {\r\n  cursor: default;\r\n  opacity: 0.25;\r\n  filter: alpha(opacity=25);\r\n  /* For IE8 and earlier, unquote for libsass bug */ }\r\n\r\n.divmanazerpopup.oskari-measurement {\r\n  max-width: 260px; }\r\n\r\n.oskariui-menutoolbar {\r\n  width: 100%;\r\n  height: 36px;\r\n  position: relative;\r\n  background-color: #333;\r\n  height: 40px; }\r\n\r\n.oskariui-menutoolbar div.toolrow {\r\n  padding: 0px 10px; }\r\n\r\n.oskariui-menutoolbar div.toolrow div.tool {\r\n  display: inline-block;\r\n  cursor: pointer; }\r\n\r\n.oskariui-menutoolbar div.toolrow div.tool.selected, .oskariui-menutoolbar div.toolrow div.tool:hover:not(.disabled), .oskariui-menutoolbar div.toolrow div.tool:active:not(.disabled) {\r\n  background-color: #212121; }\r\n\r\n.oskariui-menutoolbar div.toolrow div.tool.disabled, div.tool.disabled {\r\n  cursor: default;\r\n  opacity: 0.25;\r\n  filter: alpha(opacity=25);\r\n  /* For IE8 and earlier, unquote for libsass bug */ }\r\n\r\n.oskariui-menutoolbar-container {\r\n  display: inline-block; }\r\n\r\n.oskariui-menutoolbar-modetitle {\r\n  display: inline-block;\r\n  width: 250px; }\r\n\r\n.oskariui-menutoolbar .oskariui-menutoolbar-closebox {\r\n  position: absolute;\r\n  top: 6px;\r\n  right: 10px; }\r\n\r\n.oskariui-menutoolbar .oskariui-menutoolbar-closebox div {\r\n  cursor: pointer; }\r\n\r\n.oskariui-menutoolbar .oskariui-menutoolbar-title {\r\n  position: absolute;\r\n  top: 6px; }\r\n\r\ndiv.oskariui-menutoolbar div.oskariui-menutoolbar-title p {\r\n  color: white;\r\n  font: 16px/20px "Open Sans", "Helvetica Neue", "HelveticaNeue", Helvetica, Arial, sans-serif; }\r\n')}),requirejs.s.contexts._.nextTick=requirejs.nextTick;