var requirejs,require,define;!function(ga){function ka(e,t,n,r){return r||""}function K(e){return"[object Function]"===Q.call(e)}function L(e){return"[object Array]"===Q.call(e)}function y(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function X(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));--n);}}function x(e,t){return la.call(e,t)}function e(e,t){return x(e,t)&&e[t]}function D(e,t){for(var n in e)if(x(e,n)&&t(e[n],n))break}function Y(e,t,n,r){return t&&D(t,function(t,i){!n&&x(e,i)||(!r||"object"!=typeof t||!t||L(t)||K(t)||t instanceof RegExp?e[i]=t:(e[i]||(e[i]={}),Y(e[i],t,n,r)))}),e}function z(e,t){return function(){return t.apply(e,arguments)}}function ha(e){throw e}function ia(e){if(!e)return e;var t=ga;return y(e.split("."),function(e){t=t[e]}),t}function F(e,t,n,r){return t=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e),t.requireType=e,t.requireModules=r,n&&(t.originalError=n),t}function ma(t){function n(t,n,r){var i,o,a,s,l,u,d,c;n=n&&n.split("/");var f=B.map,p=f&&f["*"];if(t){for(t=t.split("/"),o=t.length-1,B.nodeIdCompat&&U.test(t[o])&&(t[o]=t[o].replace(U,"")),"."===t[0].charAt(0)&&n&&(o=n.slice(0,n.length-1),t=o.concat(t)),o=t,a=0;a<o.length;a++)s=o[a],"."===s?(o.splice(a,1),--a):".."===s&&0!==a&&(1!==a||".."!==o[2])&&".."!==o[a-1]&&a>0&&(o.splice(a-1,2),a-=2);t=t.join("/")}if(r&&f&&(n||p)){o=t.split("/"),a=o.length;e:for(;a>0;--a){if(l=o.slice(0,a).join("/"),n)for(s=n.length;s>0;--s)if((r=e(f,n.slice(0,s).join("/")))&&(r=e(r,l))){i=r,u=a;break e}!d&&p&&e(p,l)&&(d=e(p,l),c=a)}!i&&d&&(i=d,u=c),i&&(o.splice(0,u,i),t=o.join("/"))}return(i=e(B.pkgs,t))?i:t}function r(e){E&&y(document.getElementsByTagName("script"),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===_.contextName?(t.parentNode.removeChild(t),!0):void 0})}function i(t){var n=e(B.paths,t);return n&&L(n)&&1<n.length?(n.shift(),_.require.undef(t),_.makeRequire(null,{skipMap:!0})([t]),!0):void 0}function o(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function a(t,r,i,a){var s,l,u=null,d=r?r.name:null,c=t,f=!0,p="";return t||(f=!1,t="_@r"+(j+=1)),t=o(t),u=t[0],t=t[1],u&&(u=n(u,d,a),l=e(O,u)),t&&(u?p=l&&l.normalize?l.normalize(t,function(e){return n(e,d,a)}):-1===t.indexOf("!")?n(t,d,a):t:(p=n(t,d,a),t=o(p),u=t[0],p=t[1],i=!0,s=_.nameToUrl(p))),i=!u||l||i?"":"_unnormalized"+(R+=1),{prefix:u,name:p,parentMap:r,unnormalized:!!i,url:s,originalName:c,isDefine:f,id:(u?u+"!"+p:p)+i}}function s(t){var n=t.id,r=e(I,n);return r||(r=I[n]=new _.Module(t)),r}function l(t,n,r){var i=t.id,o=e(I,i);!x(O,i)||o&&!o.defineEmitComplete?(o=s(t),o.error&&"error"===n?r(o.error):o.on(n,r)):"defined"===n&&r(O[i])}function u(t,n){var r=t.requireModules,i=!1;n?n(t):(y(r,function(n){(n=e(I,n))&&(n.error=t,n.events.error&&(i=!0,n.emit("error",t)))}),i||g.onError(t))}function d(){V.length&&(y(V,function(e){var t=e[0];"string"==typeof t&&(_.defQueueMap[t]=!0),P.push(e)}),V=[])}function c(e){delete I[e],delete M[e]}function f(t,n,r){var i=t.map.id;t.error?t.emit("error",t.error):(n[i]=!0,y(t.depMaps,function(i,o){var a=i.id,s=e(I,a);!s||t.depMatched[o]||r[a]||(e(n,a)?(t.defineDep(o,O[a]),t.check()):f(s,n,r))}),r[i]=!0)}function p(){var e,t,n=(e=1e3*B.waitSeconds)&&_.startTime+e<(new Date).getTime(),o=[],a=[],s=!1,l=!0;if(!v){if(v=!0,D(M,function(e){var u=e.map,d=u.id;if(e.enabled&&(u.isDefine||a.push(e),!e.error))if(!e.inited&&n)i(d)?s=t=!0:(o.push(d),r(d));else if(!e.inited&&e.fetched&&u.isDefine&&(s=!0,!u.prefix))return l=!1}),n&&o.length)return e=F("timeout","Load timeout for modules: "+o,null,o),e.contextName=_.contextName,u(e);l&&y(a,function(e){f(e,{},{})}),n&&!t||!s||!E&&!ja||C||(C=setTimeout(function(){C=0,p()},50)),v=!1}}function h(e){x(O,e[0])||s(a(e[0],null,!0)).init(e[1],e[2])}function m(e){e=e.currentTarget||e.srcElement;var t=_.onScriptLoad;return e.detachEvent&&!ca?e.detachEvent("onreadystatechange",t):e.removeEventListener("load",t,!1),t=_.onScriptError,e.detachEvent&&!ca||e.removeEventListener("error",t,!1),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function b(){var e;for(d();P.length;){if(e=P.shift(),null===e[0])return u(F("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));h(e)}_.defQueueMap={}}var v,w,_,k,C,B={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},I={},M={},T={},P=[],O={},q={},A={},j=1,R=1;return k={require:function(e){return e.require?e.require:e.require=_.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?O[e.map.id]=e.exports:e.exports=O[e.map.id]={}:void 0},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){return e(B.config,t.map.id)||{}},exports:t.exports||(t.exports={})}}},w=function(t){this.events=e(T,t.id)||{},this.map=t,this.shim=e(B.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},w.prototype={init:function(e,t,n,r){r=r||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=z(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,--this.depCount,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,_.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();_.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],z(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;q[e]||(q[e]=!0,_.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id;t=this.depExports;var r=this.exports,i=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,1>this.depCount&&!this.defined){if(K(i)){if(this.events.error&&this.map.isDefine||g.onError!==ha)try{r=_.execCb(n,i,t,r)}catch(o){e=o}else r=_.execCb(n,i,t,r);if(this.map.isDefine&&void 0===r&&((t=this.module)?r=t.exports:this.usingExports&&(r=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",u(this.error=e)}else r=i;if(this.exports=r,this.map.isDefine&&!this.ignore&&(O[n]=r,g.onResourceLoad)){var a=[];y(this.depMaps,function(e){a.push(e.normalizedMap||e)}),g.onResourceLoad(_,this.map,a)}c(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else x(_.defQueueMap,n)||this.fetch()}},callPlugin:function(){var t=this.map,r=t.id,i=a(t.prefix);this.depMaps.push(i),l(i,"defined",z(this,function(i){var o,d,f=e(A,this.map.id),p=this.map.name,h=this.map.parentMap?this.map.parentMap.name:null,m=_.makeRequire(t.parentMap,{enableBuildCallback:!0});this.map.unnormalized?(i.normalize&&(p=i.normalize(p,function(e){return n(e,h,!0)})||""),d=a(t.prefix+"!"+p,this.map.parentMap),l(d,"defined",z(this,function(e){this.map.normalizedMap=d,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),(i=e(I,d.id))&&(this.depMaps.push(d),this.events.error&&i.on("error",z(this,function(e){this.emit("error",e)})),i.enable())):f?(this.map.url=_.nameToUrl(f),this.load()):(o=z(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),o.error=z(this,function(e){this.inited=!0,this.error=e,e.requireModules=[r],D(I,function(e){0===e.map.id.indexOf(r+"_unnormalized")&&c(e.map.id)}),u(e)}),o.fromText=z(this,function(e,n){var i=t.name,l=a(i),d=S;n&&(e=n),d&&(S=!1),s(l),x(B.config,r)&&(B.config[i]=B.config[r]);try{g.exec(e)}catch(c){return u(F("fromtexteval","fromText eval for "+r+" failed: "+c,c,[r]))}d&&(S=!0),this.depMaps.push(l),_.completeLoad(i),m([i],o)}),i.load(t.name,m,o,B))})),_.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){M[this.map.id]=this,this.enabling=this.enabled=!0,y(this.depMaps,z(this,function(t,n){var r,i;if("string"==typeof t){if(t=a(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[n]=t,r=e(k,t.id))return void(this.depExports[n]=r(this));this.depCount+=1,l(t,"defined",z(this,function(e){this.undefed||(this.defineDep(n,e),this.check())})),this.errback?l(t,"error",z(this,this.errback)):this.events.error&&l(t,"error",z(this,function(e){this.emit("error",e)}))}r=t.id,i=I[r],x(k,r)||!i||i.enabled||_.enable(t,this)})),D(this.pluginMaps,z(this,function(t){var n=e(I,t.id);n&&!n.enabled&&_.enable(t,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){y(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},_={config:B,contextName:t,registry:I,defined:O,urlFetched:q,defQueue:P,defQueueMap:{},Module:w,makeModuleMap:a,nextTick:g.nextTick,onError:u,configure:function(e){if(e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/"),"string"==typeof e.urlArgs){var t=e.urlArgs;e.urlArgs=function(e,n){return(-1===n.indexOf("?")?"?":"&")+t}}var n=B.shim,r={paths:!0,bundles:!0,config:!0,map:!0};D(e,function(e,t){r[t]?(B[t]||(B[t]={}),Y(B[t],e,!0,!0)):B[t]=e}),e.bundles&&D(e.bundles,function(e,t){y(e,function(e){e!==t&&(A[e]=t)})}),e.shim&&(D(e.shim,function(e,t){L(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=_.makeShimExports(e)),n[t]=e}),B.shim=n),e.packages&&y(e.packages,function(e){var t;e="string"==typeof e?{name:e}:e,t=e.name,e.location&&(B.paths[t]=e.location),B.pkgs[t]=e.name+"/"+(e.main||"main").replace(na,"").replace(U,"")}),D(I,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t,null,!0))}),(e.deps||e.callback)&&_.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(ga,arguments)),t||e.exports&&ia(e.exports)}},makeRequire:function(i,o){function l(e,n,r){var d,c;return o.enableBuildCallback&&n&&K(n)&&(n.__requireJsBuild=!0),"string"==typeof e?K(n)?u(F("requireargs","Invalid require call"),r):i&&x(k,e)?k[e](I[i.id]):g.get?g.get(_,e,i,l):(d=a(e,i,!1,!0),d=d.id,x(O,d)?O[d]:u(F("notloaded",'Module name "'+d+'" has not been loaded yet for context: '+t+(i?"":". Use require([])")))):(b(),_.nextTick(function(){b(),c=s(a(null,i)),c.skipMap=o.skipMap,c.init(e,n,r,{enabled:!0}),p()}),l)}return o=o||{},Y(l,{isBrowser:E,toUrl:function(e){var t,r=e.lastIndexOf("."),o=e.split("/")[0];return-1!==r&&("."!==o&&".."!==o||r>1)&&(t=e.substring(r,e.length),e=e.substring(0,r)),_.nameToUrl(n(e,i&&i.id,!0),t,!0)},defined:function(e){return x(O,a(e,i,!1,!0).id)},specified:function(e){return e=a(e,i,!1,!0).id,x(O,e)||x(I,e)}}),i||(l.undef=function(t){d();var n=a(t,i,!0),o=e(I,t);o.undefed=!0,r(t),delete O[t],delete q[n.url],delete T[t],X(P,function(e,n){e[0]===t&&P.splice(n,1)}),delete _.defQueueMap[t],o&&(o.events.defined&&(T[t]=o.events),c(t))}),l},enable:function(t){e(I,t.id)&&s(t).enable()},completeLoad:function(t){var n,r,o=e(B.shim,t)||{},a=o.exports;for(d();P.length;){if(r=P.shift(),null===r[0]){if(r[0]=t,n)break;n=!0}else r[0]===t&&(n=!0);h(r)}if(_.defQueueMap={},r=e(I,t),!n&&!x(O,t)&&r&&!r.inited){if(!(!B.enforceDefine||a&&ia(a)))return i(t)?void 0:u(F("nodefine","No define call for "+t,null,[t]));h([t,o.deps||[],o.exportsFn])}p()},nameToUrl:function(t,n,r){var i,o,a,s;if((i=e(B.pkgs,t))&&(t=i),i=e(A,t))return _.nameToUrl(i,n,r);if(g.jsExtRegExp.test(t))i=t+(n||"");else{for(i=B.paths,o=t.split("/"),a=o.length;a>0;--a)if(s=o.slice(0,a).join("/"),s=e(i,s)){L(s)&&(s=s[0]),o.splice(0,a,s);break}i=o.join("/"),i+=n||(/^data\:|^blob\:|\?/.test(i)||r?"":".js"),i=("/"===i.charAt(0)||i.match(/^[\w\+\.\-]+:/)?"":B.baseUrl)+i}return B.urlArgs&&!/^blob\:/.test(i)?i+B.urlArgs(t,i):i},load:function(e,t){g.load(_,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){("load"===e.type||oa.test((e.currentTarget||e.srcElement).readyState))&&(N=null,e=m(e),_.completeLoad(e.id))},onScriptError:function(e){var t=m(e);if(!i(t.id)){var n=[];return D(I,function(e,r){0!==r.indexOf("_@r")&&y(e.depMaps,function(e){return e.id===t.id?(n.push(r),!0):void 0})}),u(F("scripterror",'Script error for "'+t.id+(n.length?'", needed by: '+n.join(", "):'"'),e,[t.id]))}}},_.require=_.makeRequire(),_}function pa(){return N&&"interactive"===N.readyState?N:(X(document.getElementsByTagName("script"),function(e){return"interactive"===e.readyState?N=e:void 0}),N)}var g,B,C,H,O,I,N,P,u,T,qa=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,ra=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,U=/\.js$/,na=/^\.\//;B=Object.prototype;var Q=B.toString,la=B.hasOwnProperty,E=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),ja=!E&&"undefined"!=typeof importScripts,oa=E&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,ca="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),J={},w={},V=[],S=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(K(requirejs))return;w=requirejs,requirejs=void 0}"undefined"==typeof require||K(require)||(w=require,require=void 0),g=requirejs=function(t,n,r,i){var o,a="_";return L(t)||"string"==typeof t||(o=t,L(n)?(t=n,n=r,r=i):t=[]),o&&o.context&&(a=o.context),(i=e(J,a))||(i=J[a]=g.s.newContext(a)),o&&i.configure(o),i.require(t,n,r)},g.config=function(e){return g(e)},g.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=g),g.version="2.2.0",g.jsExtRegExp=/^\/|:|\?|\.js$/,g.isBrowser=E,B=g.s={contexts:J,newContext:ma},g({}),y(["toUrl","undef","defined","specified"],function(e){g[e]=function(){var t=J._;return t.require[e].apply(t,arguments)}}),E&&(C=B.head=document.getElementsByTagName("head")[0],H=document.getElementsByTagName("base")[0])&&(C=B.head=H.parentNode),g.onError=ha,g.createNode=function(e,t,n){return t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},g.load=function(e,t,n){var r,i=e&&e.config||{};if(E)return r=g.createNode(i,t,n),r.setAttribute("data-requirecontext",e.contextName),r.setAttribute("data-requiremodule",t),!r.attachEvent||r.attachEvent.toString&&0>r.attachEvent.toString().indexOf("[native code")||ca?(r.addEventListener("load",e.onScriptLoad,!1),r.addEventListener("error",e.onScriptError,!1)):(S=!0,r.attachEvent("onreadystatechange",e.onScriptLoad)),r.src=n,i.onNodeCreated&&i.onNodeCreated(r,i,t,n),P=r,H?C.insertBefore(r,H):C.appendChild(r),P=null,r;if(ja)try{setTimeout(function(){},0),importScripts(n),e.completeLoad(t)}catch(o){e.onError(F("importscripts","importScripts failed for "+t+" at "+n,o,[t]))}},E&&!w.skipDataMain&&X(document.getElementsByTagName("script"),function(e){return C||(C=e.parentNode),(O=e.getAttribute("data-main"))?(u=O,w.baseUrl||-1!==u.indexOf("!")||(I=u.split("/"),u=I.pop(),T=I.length?I.join("/")+"/":"./",w.baseUrl=T),u=u.replace(U,""),g.jsExtRegExp.test(u)&&(u=O),w.deps=w.deps?w.deps.concat(u):[u],!0):void 0}),define=function(e,t,n){var r,i;"string"!=typeof e&&(n=t,t=e,e=null),L(t)||(n=t,t=null),!t&&K(n)&&(t=[],n.length&&(n.toString().replace(qa,ka).replace(ra,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),S&&(r=P||pa())&&(e||(e=r.getAttribute("data-requiremodule")),i=J[r.getAttribute("data-requirecontext")]),i?(i.defQueue.push([e,t,n]),i.defQueueMap[e]=!0):V.push([e,t,n])},define.amd={jQuery:!0},g.exec=function(b){return eval(b)},g(w)}}(this),define("text",["module"],function(e){"use strict";var t,n,r,i,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,d=u&&location.protocol&&location.protocol.replace(/\:/,""),c=u&&location.hostname,f=u&&(location.port||void 0),p={},h=e.config&&e.config()||{};return t={version:"2.0.14",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=a[t];try{e=new ActiveXObject(n)}catch(r){}if(e){a=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,o=e.lastIndexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!a||o>1)?(t=e.substring(0,o),n=e.substring(o+1)):t=e,r=n||t,o=r.indexOf("!"),-1!==o&&(i="strip"===r.substring(o+1),r=r.substring(0,o),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var o,a,s,l=t.xdRegExp.exec(e);return l?(o=l[2],a=l[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==n||a&&a.toLowerCase()!==r.toLowerCase()||(s||a)&&s!==i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,h.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText)return void r();h.isBuild=i&&i.isBuild;var o=t.parseName(e),a=o.moduleName+(o.ext?"."+o.ext:""),s=n.toUrl(a),l=h.useXhr||t.useXhr;return 0===s.indexOf("empty:")?void r():void(!u||l(s,d,c,f)?t.get(s,function(n){t.finishLoad(e,o.strip,n,r)},function(e){r.error&&r.error(e)}):n([a],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,r)}))},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var o=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,r,i,o){var a=t.parseName(n),s=a.ext?"."+a.ext:"",l=a.moduleName+s,u=r.toUrl(a.moduleName+s)+".js";t.load(l,r,function(n){var r=function(e){return i(u,e)};r.asModule=function(e,t){return i.asModule(e,u,t)},t.write(e,l,r,o)},o)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");"\ufeff"===i[0]&&(i=i.substring(1)),t(i)}catch(o){r&&r(o)}}):"xhr"===h.env||!h.env&&t.createXhr()?t.get=function(e,n,r,i){var o,a=t.createXhr();if(a.open("GET",e,!0),i)for(o in i)i.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),i[o]);h.onXhr&&h.onXhr(a,e),a.onreadystatechange=function(t){var i,o;4===a.readyState&&(i=a.status||0,i>399&&600>i?(o=new Error(e+" HTTP status: "+i),o.xhr=a,r&&r(o)):n(a.responseText),h.onXhrComplete&&h.onXhrComplete(a,e))},a.send(null)}:"rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,r,i="utf-8",o=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),i)),l="";try{for(n=new java.lang.StringBuffer,r=s.readLine(),r&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),null!==r&&n.append(r);null!==(r=s.readLine());)n.append(a),n.append(r);l=String(n.toString())}finally{s.close()}t(l)}:("xpconnect"===h.env||!h.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,a,s,l={};o&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(s,1,0,!1),a=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),a.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(n.available(),l),a.close(),n.close(),t(l.value)}catch(u){throw new Error((s&&s.path||"")+": "+u)}}),t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return-1!==r&&r===t}),jQuery.fn.outerHTML=function(e){var t;return this.length?e?(jQuery.each(this,function(t,n){var r,i=n,o=n.outerHTML?"outerHTML":"innerHTML";n.outerHTML||(n=jQuery(n).wrap("<div>").parent()[0]),jQuery.isFunction(e)?(r=e.call(i,t,n[o]))!==!1&&(n[o]=r):n[o]=e,n.outerHTML||jQuery(n).children().unwrap()}),this):this[0].outerHTML||(t=this.wrap("<div>").parent().html(),this.unwrap(),t):"undefined"==typeof e?this:null},Oskari=function(){function _buildPathForLoaderMode(e,t){var n=pathBuilders[mode];return n?n(e,t):basePathForBundles?basePathForBundles+e:e}function _isPackedMode(){return!_isNotPackMode[mode]}function _isPreloaded(){return _preloaded}function _buildPathForPackedMode(e){return e+"/build/"+mode+".js"}function _buildBundlePathForPackedMode(e){return e+"/build/bundle-"+mode+".js"}function _buildLocalePathForPackedMode(e){return e+"/build/"+mode+"-locale-"+blocale.getLang()+".js"}var oskariVersion="1.36.0",isDebug=!1,isConsole=window.console&&window.console.debug,logMsg=function(e){isDebug&&isConsole&&window.console.debug(e)},Bundle_locale=function(){this.lang=null,this.localizations={},this.supportedLocales=null};Bundle_locale.prototype={getLocalization:function(e,t,n){var r=t||this.lang;if(null===e||void 0===e)throw new TypeError("getLocalization(): Missing key");return this.localizations?this.localizations[r]&&this.localizations[r][e]?this.localizations[r][e]:n&&this.localizations[Oskari.getDefaultLanguage()]&&this.localizations[Oskari.getDefaultLanguage()][e]?this.localizations[Oskari.getDefaultLanguage()][e]:null:null},setLocalization:function(e,t,n){if(null===e||void 0===e)throw new TypeError("setLocalization(): Missing lang");if(null===t||void 0===t)throw new TypeError("setLocalization(): Missing key");this.localizations[e]||(this.localizations[e]={}),this.localizations[e][t]=n},getLang:function(){return this.lang},setLang:function(e){if(null===e||void 0===e)throw new TypeError("setLang(): Missing lang");this.lang=e},getDecimalSeparator:function(){var e=this,t=e.getLang(),n=e.getSupportedLocales().filter(function(e){return 0===e.indexOf(t)}),r=n.map(function(t){return e.getDecimalSeparators()[t]});return r.length>1&&console&&console.warn&&console.warn("Found more than one separator for "+this.getLang()),r.length&&r[0]?r[0]:","},getDecimalSeparators:function(){return this.decimalSeparators},setDecimalSeparators:function(e){this.decimalSeparators=e},getSupportedLanguages:function(){var e,t,n=[],r=this.getSupportedLocales();for(t=0;t<r.length;t+=1)e=r[t],n.push(e.substring(0,e.indexOf("_")));return n},getSupportedLocales:function(){return this.supportedLocales||[]},setSupportedLocales:function(e){if(null===e||void 0===e)throw new TypeError("setSupportedLocales(): Missing locales");if(!Array.isArray(e))throw new TypeError("setSupportedLocales(): locales is not an array");this.supportedLocales=e},getDefaultLanguage:function(){var e=this.getSupportedLocales();if(0===e.length)return console&&console.warn&&console.warn("Supported locales not set, using current language "+this.getLang()),this.getLang();var t=e[0];return-1!==t.indexOf("_")?t.substring(0,t.indexOf("_")):this.getLang()}};var blocale=new Bundle_locale,supportBundleAsync=!1,mode="default",instTs=(new Date).getTime(),basePathForBundles=null,pathBuilders={"default":function(e,t){return basePathForBundles?basePathForBundles+e:e},dev:function(e,t){return basePathForBundles?basePathForBundles+e:e}},_isNotPackMode={dev:!0,"default":!0,"static":!0},_preloaded=!1,O2ClassSystem=function(){this.packages={},this.protocols={},this.inheritance={},this.aspects={},this.classcache={},this.globals={}};O2ClassSystem.prototype={purge:function(){},protocol:function(e){if(null===e||void 0===e)throw new TypeError("protocol(): Missing protocolName");return this.protocols[e]},_getPackageDefinition:function(e){var t=this.packages[e];return t||(t={},this.packages[e]=t),t},_getClassQName:function(e){var t=e.split(".");return{basePkg:t[0],pkg:t[1],sp:t.slice(2).join(".")}},_getClassInfo:function(e){var t,n=this.classcache[e],r=this._getClassQName(e);return n||(t=this._getPackageDefinition(r.pkg),n=t[r.sp],this.classcache[e]=n),n},_cloneProperties:function(e,t){var n,r,i,o=Array.isArray(t)?t:[t];for(r in e)if(e.hasOwnProperty(r))for(i=e[r],n=o.length-1;n>=0;n-=1)o[n][r]=i},_createEmptyClassDefinition:function(){var e=function(){};return e.prototype={},e},getMetadata:function(e){var t;if(null===e||void 0===e)throw new TypeError("metadata(): Missing className");if(t=this._getClassInfo(e),!t)throw"Class "+e+" does not exist";return t._metadata},_updateMetadata:function(e,t,n,r,i){var o,a,s,l;if(r._metadata||(r._metadata={}),r._metadata.meta=i,l=[e,t,n].join("."),o=i.protocol)for(a=0;a<o.length;a+=1)s=o[a],this.protocols[s]||(this.protocols[s]={}),this.protocols[s][l]=r},_super:function(e,t){var n=this;return function(){return n._._superCategory[e][t].apply(n,arguments)}},define:function(e,t,n,r){var i,o,a,s,l,u,d,c;if(null===e||void 0===e)throw new TypeError("define(): Missing className");if("function"!=typeof t)throw new TypeError("define(): classConstructor is not a function");if(n&&"object"!=typeof n)throw new TypeError("define(): Prototype is not an object");if(o=this._getClassQName(e),s=this._getPackageDefinition(o.pkg),l=s[o.sp],l||(i=this._createEmptyClassDefinition(),a={className:e,superClass:null,subClass:null},l={_class:i,_constructor:t,_category:{},_composition:a},i.prototype._=l,i.prototype._super=this._super,this.inheritance[e]=a,s[o.sp]=l),t&&(l._constructor=t),n&&(this._cloneProperties(n,l._class.prototype),l._category[e]=n),r){for(d=r.extend,u=0;d&&u<d.length;u+=1)c=this.lookup(d[u]),c._composition.subClass||(c._composition.subClass={}),c._composition.subClass[e]=l,l._composition.superClass=c;this._updateMetadata(o.basePkg,o.pkg,o.sp,l,r)}return this._pullDown(l),this._pushDown(l),l},category:function(e,t,n){var r,i,o,a,s,l;if(null===e||void 0===e)throw new TypeError("category(): Missing className");return o=this._getClassQName(e),s=this._getPackageDefinition(o.pkg),i=s[o.sp],i||(r=this._createEmptyClassDefinition(),a={className:e,superClass:null,subClass:null},i={_class:r,_constructor:t,_category:{},_composition:a},r.prototype._=i,r.prototype._super=this._super,this.inheritance[e]=a,s[o.sp]=i),l=i._class.prototype,this._cloneProperties(n,l),n&&(i._category[t]=n),this._pullDown(i),this._pushDown(i),i},lookup:function(e,t){var n,r,i,o,a;if(null===e||void 0===e)throw new TypeError("lookup(): Missing className");return r=this._getClassQName(e),o=this._getPackageDefinition(r.pkg),a=o[r.sp],a||(n=this._createEmptyClassDefinition(),i={className:e,superClass:null,subClass:null},a={_class:n,_constructor:t,_category:{},_composition:i},this.inheritance[e]=i,o[r.sp]=a),a},extend:function(e,t){var n,r;if(null===e||void 0===e)throw new TypeError("extend(): Missing subClassName");if(null===t||void 0===t)throw new TypeError("extend(): Missing superClassName");return n=this.lookup(t),r=this.lookup(e),n._composition.subClass||(n._composition.subClass={}),n._composition.subClass[e]=r,r._composition.superClass=n,this._pullDown(r),r},_pushDown:function(e){var t,n;if(null===e||void 0===e)throw new TypeError("_pushDown(): Missing classInfo");if(e._composition.subClass){for(t in e._composition.subClass)e._composition.subClass.hasOwnProperty(t)&&(n=e._composition.subClass[t],this._pullDown(n),this._pushDown(n));return e}},_pullDown:function(e){var t,n,r,i,o,a,s,l,u,d;if(null===e||void 0===e)throw new TypeError("_pullDown(): Missing classInfo");if(e._composition.superClass){for(i=[],i.push(e),d=e;;){if(d=d._composition.superClass,!d)break;i.push(d)}for(e._constructors=[],e._superCategory={},l=e._class.prototype,t=i.length-1;t>=0;t-=1){r=i[t],o=r._composition.className,a=r._constructor,e._constructors.push(a),s={};for(n in r._category)r._category.hasOwnProperty(n)&&(u=r._category[n],this._cloneProperties(u,[l,s]));e._superCategory[o]=s}return e}},_slicer:Array.prototype.slice,create:function(e){var t,n,r,i,o;if(null===e||void 0===e)throw new TypeError("create(): Missing className");if(o=this._slicer.apply(arguments,[1]),t=this._getClassInfo(e),!t)throw'Class "'+e+'" does not exist';if(n=new t._class,r=t._constructors)for(i=0;i<r.length;i+=1){if(null===r[i]||void 0===r[i])throw new Error("Class "+e+" is missing super constructor "+(i+1)+"/"+r.length);var a=r[i].apply(n,o);a&&(n=a)}else{var a=t._constructor.apply(n,o);a&&(n=a)}return n},createWithClassInfo:function(e,t){var n,r,i;if(null===e||void 0===e)throw new TypeError("createWithClassInfo(): Missing classInfo");if(n=new e._class,r=e._constructors)for(i=0;i<r.length;i+=1){if(null===r[i]||void 0===r[i])throw new Error('createWithClassInfo(): Undefined constructor in class "'+e._composition.className+'"');r[i].apply(n,t)}else e._constructor.apply(n,t);return n},builder:function(e){var t;if(null===e||void 0===e)throw new TypeError("builder(): Missing className");if(t=this._getClassInfo(e),!t)throw'Class "'+e+'" does not exist';return this.getBuilderFromClassInfo(t)},getBuilderFromClassInfo:function(e){if(null===e||void 0===e)throw new TypeError("getBuilderFromClassInfo(): Missing classInfo");return e._builder?e._builder:(e._builder=function(){var t,n=new e._class,r=e._constructors,i=arguments;if(r)for(t=0;t<r.length;t+=1)r[t].apply(n,i);else e._constructor.apply(n,i);return n},e._builder)},_global:function(e,t){return void 0===e?this.globals:(void 0!==t&&(this.globals[e]=t),this.globals[e])}};var class_singleton=new O2ClassSystem,cs=class_singleton,bundle_loader_id=0,Bundle_loader=function(e,t){bundle_loader_id+=1,this.loader_identifier=bundle_loader_id,this.manager=e,this.callback=t,this.filesRequested=0,this.filesLoaded=0,this.files=[],this.fileList=[],this.metadata={}};Bundle_loader.prototype={add:function(e,t){var n,r=this,i=r.files.filter(function(t){return t.fn===e});0==i.length&&(n={src:e,type:t&&t.type?t.type:"text/javascript",id:t?t.id:null,state:!1},r.files.push({fn:e,def:n}),"text/javascript"===n.type&&(r.filesRequested+=1),r.fileList.push(n))},getState:function(){return 0===this.filesRequested?1:this.filesLoaded/this.filesRequested},commit:function(){var e,t,n,r,i=document.createDocumentFragment(),o=this,a=o.filesRequested;return void 0===o.head&&(o.head=document.head),0===a||_isPreloaded()?(o.callback(),void o.manager.notifyLoaderStateChanged(o,!0)):(e=function(){o.filesLoaded+=1,o.manager.log("Files loaded "+o.filesLoaded+"/"+o.filesRequested),a===o.filesLoaded?(o.callback(),o.manager.notifyLoaderStateChanged(o,!0)):o.manager.notifyLoaderStateChanged(o,!1)},t=!1,o.fileList.forEach(function(a){n=a.src,r=o._buildScriptTag(n,e,a.type,a.id),r&&(_isPreloaded()?e():(i.appendChild(r),t=!0))}),void(t&&o.head.appendChild(i)))},_buildScriptTag:function(e,t,n,r){var i=document.createElement("script");return r&&(i.id=r),i.type=n,i.charset="utf-8",_isPreloaded()?i.src="/Oskari/empty.js":i.src=e,i.readyState?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,t())}:i.onload=t,i}};var Bundle_mediator=function(e){var t;this.manager=null;for(t in e)e.hasOwnProperty(t)&&(this[t]=e[t])};Bundle_mediator.prototype={setState:function(e){return this.state=e,this.manager.postChange(this.bundle,this.instance,this.state),this.state},getState:function(){return this.state}};var Bundle_trigger=function(e,t,n){this.config=e,this.callback=t,this.fired=!1,this.info=n};Bundle_trigger.prototype={execute:function(e,t,n,r){var i,o,a,s=this;if(!s.fired){for(i in s.config["Import-Bundle"])if(s.config["Import-Bundle"].hasOwnProperty(i)&&(o=e.bundleSourceStates[i],!o||1!==o.state))return void e.log("Trigger not fired due "+i+" for "+r||this.info);s.fired=!0,e.log("Posting trigger"),a=this.callback,window.setTimeout(function(){a(e)},0)}
}};var Bundle_manager=function(){var e=this;e.serial=0,e.bundleDefinitions={},e.sources={},e.bundleInstances={},e.bundles={},e.bundleDefinitionStates={},e.bundleSourceStates={},e.bundleStates={},e.triggers=[],e.loaderStateListeners=[]};Bundle_manager.prototype={_getSerial:function(){return this.serial+=1,this.serial},_purge:function(){var e,t=this;for(e in t.sources)t.sources.hasOwnProperty(e)&&delete t.sources[e];for(e in t.bundleDefinitionStates)t.bundleDefinitionStates.hasOwnProperty(e)&&delete t.bundleDefinitionStates[e].loader;for(e in t.bundleSourceStates)t.bundleSourceStates.hasOwnProperty(e)&&delete t.bundleSourceStates[e].loader},notifyLoaderStateChanged:function(e,t){var n,r;if(0!==this.loaderStateListeners.length)for(n=0;n<this.loaderStateListeners.length;n+=1)(r=this.loaderStateListeners[n])(e,t)},registerLoaderStateListener:function(e){this.loaderStateListeners.push(e)},alert:function(e){logMsg(e)},log:function(e){logMsg(e)},_loadCss:function(e,t){this.log("Loading CSS "+e);var n,r,i,o=document.head||document.body;_isPreloaded()||(document.all&&!window.atob?(i=new XMLHttpRequest,i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.DONE){if(200!==i.status)throw new Error(i.statusText);n=document.getElementById("concatenated"),n||(n=document.createElement("style"),n.setAttribute("type","text/css"),n.id="concatenated",o.appendChild(n)),n.styleSheet.cssText+=i.response}},i.open("GET",e,!0),i.responseType="text",i.send()):(r=document.createElement("link"),r.type="text/css",r.rel="stylesheet",r.href=e,o.appendChild(r)))},_loadLink:function(e,t){this.log("Loading link "+e+": "+t);var n,r=document.head||document.body;n=document.createElement("link"),n.rel=e,n.href=t,r.appendChild(n)},_self:function(){return this},_install:function(e,t,n,r){var i,o=this,a=o.bundleDefinitionStates[e];a?(a.state=1,o.log("SETTING STATE FOR BUNDLEDEF "+e+" existing state to "+a.state)):(a={state:1},o.bundleDefinitionStates[e]=a,o.log("SETTING STATE FOR BUNDLEDEF "+e+" NEW state to "+a.state)),a.metadata=r,o.bundleDefinitions[e]=t,o.sources[e]=n,i=o.bundleSourceStates[e],i&&(-1===i.state?(o.log("Triggering loadBundleSources for "+e+" at loadBundleDefinition"),window.setTimeout(function(){o.loadBundleSources(e)},0)):o.log("Source state for "+e+" at loadBundleDefinition is "+i.state)),o.postChange(null,null,"bundle_definition_loaded")},installBundleClass:function(e,t){var n=Oskari.clazz.create(t);n&&(Oskari.bundle(e,{clazz:n,metadata:cs.getMetadata(t).meta}),this.installBundleClassOld(e,t))},installBundleClassOld:function(e,t){var n=cs.getMetadata(t),r=cs.builder(t),i=n.meta.source,o=n.meta.bundle;this._install(e,r,i,o)},installBundleClassInfo:function(e,t){var n=cs.getBuilderFromClassInfo(t),r=t._metadata,i={};if(null===e||void 0===e)throw new TypeError("installBundleClassInfo(): Missing biid");if(null===t||void 0===t)throw new TypeError("installBundleClassInfo(): Missing classInfo");this._install(e,n,i,r)},loadBundleDefinition:function(e,t,n){var r,i,o=this,a=o.bundleDefinitionStates[e];return o.log("loadBundleDefinition called with "+e),a?1===a.state?(o.log("Bundle definition already loaded for "+e),void o.postChange(null,null,"bundle_definition_loaded")):void o.log("Bundle definition already loaded OR WHAT?"+e+" "+a.state):(a={state:-1},o.bundleDefinitionStates[e]=a,o.log("Set NEW state for DEFINITION "+e+" to "+a.state),a.bundleSrcPath=t,r=n||t.substring(0,t.lastIndexOf("/")),a.bundlePath=r,i=new Bundle_loader(this,function(){o.log("bundle_def_loaded_callback")}),i.metadata.context="bundleDefinition",a.loader=i,i.add(t),void i.commit())},_handleSourceFiles:function(e,t,n){var r,i,o;n=n||{},n.links&&Array.prototype.push.apply(e.links,n.links),Object.keys(n).forEach(function(a){if("scripts"===a||"locales"===a)for(o=0;o<n[a].length;o+=1)if(s=n[a][o],"text/css"===s.type)r=s.src,i=r,-1===r.indexOf("http")&&(i=t+"/"+r),e.css[i]=s;else if(s.type&&(e.count+=1,r=_buildPathForLoaderMode(s.src,t),i=r,-1===r.indexOf("http")&&(i=t+"/"+r),"locales"!==a||_isPackedMode()||void 0===s.lang||Oskari.getLang()===s.lang)){var s={p:a,n:o,def:n[a][o]};e.files.push({fn:i,def:s})}})},_feedCSSLoader:function(e,t,n,r){var i,o,a;for(a in r.css)r.css.hasOwnProperty(a)&&(o=a,i=_buildPathForLoaderMode(o,n),this._loadCss(i,e),this.log("- added css source "+i+" for "+t))},_feedLinkLoader:function(e,t,n){var r=this;!_isPreloaded()&&n.links&&n.links.forEach(function(n){var i=_buildPathForLoaderMode(n.href,t);r._loadLink(n.rel,i),r.log("- added link source "+i+", for: "+e)})},_feedBundleLoader:function(e,t,n,r,i){var o,a,s,l,u,d=this;o=new Bundle_loader(d,e),o.metadata.context="bundleSources",o.metadata.bundleImpl=t,i.loader=o,_isPackedMode()?(a=r.files.length,a>0&&(l=_buildPathForPackedMode(n),o.add(l,"text/javascript"),d.log("- added PACKED javascript source "+l+" for "+t),u=_buildLocalePathForPackedMode(n),o.add(u,"text/javascript"),d.log("- added PACKED locale javascript source "+u+" for "+t))):r.files.forEach(function(e){o.add(e.fn,e.def),d.log("- added script source "+s+" for "+t)}),o.commit()},loadBundleSources:function(e){var t,n,r,i,o,a,s=this;if(s.log("loadBundleSources called with "+e),null===e||void 0===e)throw new TypeError("loadBundleSources(): Missing biid");if(t=s.bundleDefinitionStates[e],!t)throw new Error("loadBundleSources(): INVALID_STATE: bundle definition load not requested for "+e);if(s.log("- definition STATE for "+e+" at load sources "+t.state),"static"===mode)return void s.postChange(null,null,"bundle_definition_loaded");if(r=s.bundleSourceStates[e]){if(1===r.state)return void s.log("Already loaded sources for : "+e);if(-1!==r.state)throw new Error("loadBundleSources(): INVALID_STATE: at "+e);s.log("Loading previously pending sources for "+e+" "+r.state+" or what?")}else r={state:-1},s.bundleSourceStates[e]=r,s.log("Setting STATE for sources "+e+" to "+r.state);return n={count:0,loaded:0,files:[],css:{},links:[]},a=s.sources[e],o=t.bundlePath,s._handleSourceFiles(n,o,a),_isPreloaded()&&"statsgrid"===e,1!==t.state?void s.log("Pending DEFINITION at sources for "+e+" to "+t.state+" -> postponed"):(s.log("STARTING load for sources "+e),i=function(){s.log("Finished loading "+n.count+" files for "+e+"."),s.bundleSourceStates[e].state=1,s.log("Set NEW state post source load for "+e+" to "+s.bundleSourceStates[e].state),s.postChange(null,null,"bundle_sources_loaded")},s._feedCSSLoader(i,e,o,n),s._feedLinkLoader(e,o,n),void s._feedBundleLoader(i,e,o,n,r))},postChange:function(e,t,n){var r,i,o,a=this;if(null===n||void 0===n)throw new TypeError("postChange(): Missing info");a._update(e,t,n);for(r in a.bundles)a.bundles.hasOwnProperty(r)&&(o=a.bundles[r],o.update(a,e,t,n));for(r in a.bundleInstances)a.bundleInstances.hasOwnProperty(r)&&(i=a.bundleInstances[r],i&&i.update(a,e,t,n))},createBundle:function(e,t){var n,r,i,o=this;if(null===e||void 0===e)throw new TypeError("createBundle(): Missing biid");if(null===t||void 0===t)throw new TypeError("createBundle(): Missing bid");if(i=o.bundleDefinitionStates[e],!i)throw new Error("createBundle(): Couldn't find a definition for bundle "+e+"/"+t+", check spelling and that the bundle has been installed.");return(r=this.bundleDefinitions[e])?(n=r(i),this.bundles[t]=n,this.bundleStates[t]={state:!0,bundlImpl:e},this.postChange(n,null,"bundle_created"),n):void alert("this.bundleDefinitions["+e+"] is null!")},_update:function(e,t,n){var r,i,o=this;for(o.log("Update called with info "+n),r=0;r<o.triggers.length;r+=1)i=o.triggers[r],i.execute(o)},createInstance:function(e){var t,n,r,i=this;if(null===e||void 0===e)throw new TypeError("createInstance(): Missing bid");if(!i.bundleStates[e]||!i.bundleStates[e].state)throw new Error("createInstance(): Couldn't find a definition for bundle "+e+", check spelling and that the bundle has been installed.");if(t=this.bundles[e],null===t||void 0===t)throw new Error("createInstance(): Couldn't find bundle with id"+e);if(n=t.create(),null===n||void 0===n)throw new Error("createInstance(): Couldn't create bundle "+e+" instance. Make sure your bundle's create function returns the instance.");return r=i._getSerial().toString(),n.mediator=new Bundle_mediator({bundleId:e,instanceid:r,state:"initial",bundle:t,instance:n,manager:this,clazz:class_singleton,requestMediator:{}}),this.bundleInstances[r]=n,this.postChange(t,n,"instance_created"),n},_destroyInstance:function(e){var t,n;if(null===e||void 0===e)throw new TypeError("_destroyInstance(): Missing biid");return t=this.bundleInstances[e],n=t.mediator,n.bundle=null,n.manager=null,n.clazz=null,t.mediator=null,this.bundleInstances[e]=null,t=null},on:function(e,t,n){this.triggers.push(new Bundle_trigger(e,t,n))}};var Bundle_facade=function(e){this.manager=e,this.bundles={},this.bundleInstances={},this.bundlePath="../src/mapframework/bundle/",this.appSetup=null,this.appConfig={}};Bundle_facade.prototype={getBundleInstanceByName:function(e){return this.bundleInstances[e]},getBundleInstanceConfigurationByName:function(e){return this.appConfig[e]},requireBundle:function(e,t,n){var r,i=this;if(null===e||void 0===e)throw new TypeError("requireBundle(): Missing biid");if(null===t||void 0===t)throw new TypeError("requireBundle(): Missing bid");if(null===n||void 0===n)throw new TypeError("requireBundle(): Missing callback");r=i.manager.createBundle(e,t),n(i.manager,r)},require:function(e,t,n){var r,i,o,a,s,l,u,d=this;if(null===e||void 0===e)throw new TypeError("require(): Missing config");if(null===t||void 0===t)throw new TypeError("require(): Missing callback");d.manager.on(e,t,n),l=e["Import-Bundle"];for(a in l)l.hasOwnProperty(a)&&(s=a,o=l[a],i=o.bundlePath||d.bundlePath,_isPackedMode()?(u=_buildBundlePathForPackedMode(i+s),r=_buildPathForLoaderMode(u,i)):r=_buildPathForLoaderMode(i+s+"/bundle.js",i),d.manager.log("FACADE requesting load for "+s+"from"+r),d.manager.loadBundleDefinition(s,r,i+s),d.manager.loadBundleSources(s))},setBundlePath:function(e){this.bundlePath=e},_loadBundleDeps:function(e,t,n,r){var i,o,a,s=this,l=e["Import-Bundle"],u=[],d=!1;for(i in l)l.hasOwnProperty(i)&&(o=i,a=l[i],u.push({name:o,def:a,phase:a.phase}),d=d||a.phase);u.sort(function(e,t){return e.phase||t.phase?e.phase?t.phase?e.phase<t.phase?-1:1:-1:1:0}),d||!supportBundleAsync?s._loadBundleDep(u,t,n,r):s._loadBundleDepAsync(e,t,n,r)},_loadBundleDep:function(e,t,n,r){var i,o,a,s,l=this,u=e.pop();return u?(i=u.def,o=u.name,a=this,s={"Import-Bundle":{}},s["Import-Bundle"][o]=i,void a.require(s,function(n){l._loadBundleDep(e,t,n,r)},r)):void t(n)},_loadBundleDepAsync:function(e,t,n,r){this.require(e,t,r)},playBundle:function(e,t){var n,r,i,o,a,s,l,u,d,c,f,p,h,g,m,b=this,v=this;if(null===e||void 0===e)throw new TypeError("playBundle(): Missing recData");n=e.metadata,r=e.bundlename,i=e.bundleinstancename,a=n["Require-Bundle-Instance"]||[],s=e.instanceProp,o=n.Singleton,e.hasOwnProperty("bundleinstancename")||(i=r),v._loadBundleDeps(n,function(e){var n;for(l=0;l<a.length;l+=1)if(u=a[l],d="object"==typeof u,c=d?u.bundlename:u,f=d?u.bundleinstancename:u+"Instance",p=v.bundles[c],p||(p=e.createBundle(c,f),v.bundles[c]=p),h=v.bundleInstances[f],!h||!o){if(h=e.createInstance(f),v.bundleInstances[f]=h,g=v.getBundleInstanceConfigurationByName(f))for(n in g)g.hasOwnProperty(n)&&(h[n]=g[n]);h.start()}b.requireBundle(r,i,function(){var n;m=e.createInstance(i);for(n in s)s.hasOwnProperty(n)&&(m[n]=s[n]);if(g=v.getBundleInstanceConfigurationByName(i))for(n in g)g.hasOwnProperty(n)&&(m[n]=g[n]);m.start(),v.bundleInstances[i]=m,t(m)})},b.manager,r)},setApplicationSetup:function(e){this.appSetup=e},getApplicationSetup:function(){return this.appSetup},setConfiguration:function(e){this.appConfig=e},getConfiguration:function(){return this.appConfig},startApplication:function(e){var t=Oskari.loader(this.appSetup.startupSequence,this.appConfig);t.processSequence(e)},startApplicationOld:function(callback){function schedule(){window.setTimeout(mediator.player,0)}var me=this,appConfig=this.appConfig,seq=this.appSetup.startupSequence.slice(0),startupInfo={bundlesInstanceConfigurations:appConfig,bundlesInstanceInfos:{}},mediator={facade:me,startupSequence:seq,bundleStartInfo:null,player:null,startupInfo:startupInfo};mediator.player=function(){return mediator.bundleStartInfo=mediator.startupSequence.shift(),mediator.bundleStartInfo?void mediator.facade.playBundle(mediator.bundleStartInfo,function(bundleInstance){var bName=mediator.bundleStartInfo.bundlename,biName=mediator.bundleStartInfo.bundleinstancename;mediator.startupInfo.bundlesInstanceInfos[biName]={bundlename:bName,bundleinstancename:biName,bundleInstance:bundleInstance},mediator.bundleStartInfo.callback&&("string"==typeof mediator.bundleStartInfo.callback&&eval(mediator.bundleStartInfo.callback),mediator.bndl.callback.apply(this,[bundleInstance,mediator.bundleStartInfo])),schedule()}):void(callback&&callback(startupInfo))},schedule()},stopApplication:function(){throw"NYI"}};var bm=new Bundle_manager;bm.clazz=cs;var fcd=new Bundle_facade(bm),ga=cs._global;cs.define("Oskari.DomManager",function(e){this.$=e},{getEl:function(e){return this.$(e)},getElForPart:function(e){throw"N/A"},setElForPart:function(e,t){throw"N/A"},setElParts:function(e){throw"N/A"},getElParts:function(){throw"N/A"},pushLayout:function(e){throw"N/A"},popLayout:function(e){throw"N/A"},getLayout:function(){throw"N/A"}});var domMgr=cs.create("Oskari.DomManager",jQuery);fcd.bundle_dom_manager=domMgr;var Oskari1LegacyAPI={bundle_manager:bm,bundle_facade:fcd,bundle_locale:blocale,app:fcd,clazz:cs,VERSION:oskariVersion,markers:[],$:function(){return ga.apply(cs,arguments)},setLoaderMode:function(e){if("string"!=typeof e)throw new TypeError("setLoaderMode(): m is not a string");mode=e},getLoaderMode:function(){return mode},setDebugMode:function(e){if("boolean"!=typeof e)throw new TypeError("setDebugMode(): d is not a boolean");isDebug=e},setSupportBundleAsync:function(e){if("boolean"!=typeof e)throw new TypeError("setSupportBundleAsync(): sba is not a boolean");supportBundleAsync=e},getSupportBundleAsync:function(){return supportBundleAsync},setBundleBasePath:function(e){if("string"!=typeof e)throw new TypeError("setBundleBasePath(): bp is not a string");basePathForBundles=e},getBundleBasePath:function(){return basePathForBundles},setPreloaded:function(e){if("boolean"!=typeof e)throw new TypeError("setPreloaded(): usep is not a boolean");_preloaded=e},setInstTs:function(e){instTs=e},registerLocalization:function(e,t){var n,r,i;if(null===e||void 0===e)throw new TypeError("registerLocalization(): Missing props");if(e.length)for(n=0;n<e.length;n+=1)r=e[n],t&&t===!0?(r.key&&r.lang&&(i=Oskari.getLocalization(r.key,r.lang)),i&&null!==i&&(r.value=jQuery.extend(!0,{},i,r.value))):(r.key&&r.lang&&(i=Oskari.getLocalization(r.key,r.lang)),i&&null!==i&&(r.value=jQuery.extend(!0,{},r.value,i))),blocale.setLocalization(r.lang,r.key,r.value);else t&&t===!0?(e.key&&e.lang&&(i=Oskari.getLocalization(e.key,e.lang)),i&&null!==i&&(e.value=jQuery.extend(!0,{},i,e.value))):(e.key&&e.lang&&(i=Oskari.getLocalization(e.key,e.lang)),i&&null!==i&&(e.value=jQuery.extend(!0,{},e.value,i))),blocale.setLocalization(e.lang,e.key,e.value)},getLocalization:function(e,t,n){return blocale.getLocalization(e,t,n)},getLang:function(){return blocale.getLang()},setLang:function(e){return blocale.setLang(e)},setSupportedLocales:function(e){return blocale.setSupportedLocales(e)},getSupportedLocales:function(){return blocale.getSupportedLocales()},getDefaultLanguage:function(){return blocale.getDefaultLanguage()},getSupportedLanguages:function(){return blocale.getSupportedLanguages()},getDecimalSeparator:function(){return blocale.getDecimalSeparator()},setDecimalSeparators:function(e){return blocale.setDecimalSeparators(e)},purge:function(){bm.purge(),cs.purge("Oskari")},getDomManager:function(){return domMgr},setDomManager:function(e){domMgr=e},getSandbox:function(e){return ga.apply(cs,[e||"sandbox"])},setSandbox:function(e,t){return ga.apply(cs,[e||"sandbox",t])},setMarkers:function(e){this.markers=e},getMarkers:function(){return this.markers||[]}},oskari1BuilderSerial=function(){var e={};return{get:function(t){return e[t]?e[t]+=1:e[t]=1,e[t]}}}();cs.define("Oskari.ModuleSpec",function(e,t){this.cs=cs,this.classInfo=e,this.className=t},{_slicer:Array.prototype.slice,category:function(e,t){var n=cs.category(this.className,t||["__",oskari1BuilderSerial.get("Category")].join("_"),e);return this.classInfo=n,this},methods:function(e,t){var n=cs.category(this.className,t||["__",oskari1BuilderSerial.get("Category")].join("_"),e);return this.classInfo=n,this},extend:function(e){var t;if(null===e||void 0===e)throw new TypeError("extend(): Missing clazz");return t=cs.extend(this.className,e.length?e:[e]),this.classInfo=t,this},create:function(){return cs.createWithClassInfo(this.classInfo,arguments)},name:function(){return this.className},metadata:function(){return cs.getMetadata(this.className)},events:function(e){var t=this;return t.category({eventHandlers:e,onEvent:function(e){var t=this.eventHandlers[e.getName()];if(t)return t.apply(this,[e])}},"___events"),t},requests:function(e){var t=this;return t.category({requestHandlers:e,onRequest:function(e){var t=this.requestHandlers[e.getName()];return t?t.apply(this,[e]):void 0}},"___requests"),t},builder:function(){return cs.getBuilderFromClassInfo(this.classInfo)}});var Oskari1BuilderAPI=Oskari1LegacyAPI;return Oskari1BuilderAPI.cls=function(e,t,n,r){var i;return e?i=cs.lookup(e):e=["Oskari","_",oskari1BuilderSerial.get("Class")].join("."),i&&i._constructor&&!t||(i=cs.define(e,t||function(){},n,r||{})),cs.create("Oskari.ModuleSpec",i,e)},Oskari1BuilderAPI.loc=function(){return this.registerLocalization.apply(Oskari1BuilderAPI,arguments)},Oskari1BuilderAPI.eventCls=function(e,t,n){var r,i;if(null===e||void 0===e)throw new TypeError("eventCls(): Missing eventName");return r="Oskari.event.registry."+e,i=Oskari1BuilderAPI.cls(r,t,n,{protocol:["Oskari.mapframework.event.Event"]}),i.category({getName:function(){return e}},"___event"),i.eventName=e,i},Oskari1BuilderAPI.requestCls=function(e,t,n){var r,i;if(null===e||void 0===e)throw new TypeError("requestCls(): Missing requestName");return r="Oskari.request.registry."+e,i=Oskari1BuilderAPI.cls(r,t,n,{protocol:["Oskari.mapframework.request.Request"]}),i.category({getName:function(){return e}},"___request"),i.requestName=e,i},Oskari1BuilderAPI._baseClassFor={extension:"Oskari.userinterface.extension.EnhancedExtension",bundle:"Oskari.mapframework.bundle.extension.ExtensionBundle",tile:"Oskari.userinterface.extension.EnhancedTile",flyout:"Oskari.userinterface.extension.EnhancedFlyout",view:"Oskari.userinterface.extension.EnhancedView"},Oskari1BuilderAPI.extensionCls=function(e){if(null===e||void 0===e)throw new TypeError("extensionCls(): Missing className");return Oskari1BuilderAPI.cls(e).extend(this._baseClassFor.extension)},Oskari1BuilderAPI.bundleCls=function(e,t){var n;if(null===t||void 0===t)throw new TypeError("bundleCls(): Missing className");return e||(e=["__",oskari1BuilderSerial.get("Bundle")].join("_")),n=Oskari1BuilderAPI.cls(t,function(){},{update:function(){}},{protocol:["Oskari.bundle.Bundle",this._baseClassFor.bundle],manifest:{"Bundle-Identifier":e}}),bm.installBundleClassInfo(e,n.classInfo),n.___bundleIdentifier=e,n.loc=function(e){return e.key=this.___bundleIdentifier,Oskari1BuilderAPI.registerLocalization(e),n},n.start=function(e){var t,n,r,i,o=this.___bundleIdentifier;if(fcd.bundles[o]||(t=bm.createBundle(o,o),fcd.bundles[o]=t),n=bm.createInstance(o),fcd.bundleInstances[o]=n,r=fcd.getBundleInstanceConfigurationByName(o))for(i in r)r.hasOwnProperty(i)&&(n[i]=r[i]);return n.start(),n},n.stop=function(){var e=fcd.bundleInstances[this.___bundleIdentifier];return e.stop()},n},Oskari1BuilderAPI.flyoutCls=function(e){if(null===e||void 0===e)throw new TypeError("flyoutCls(): Missing className");return Oskari1BuilderAPI.cls(e).extend(this._baseClassFor.flyout)},Oskari1BuilderAPI.tileCls=function(e){if(null===e||void 0===e)throw new TypeError("tileCls(): Missing className");return Oskari1BuilderAPI.cls(e).extend(this._baseClassFor.tile)},Oskari1BuilderAPI.viewCls=function(e){if(null===e||void 0===e)throw new TypeError("viewCls(): Missing className");return Oskari1BuilderAPI.cls(e).extend(this._baseClassFor.view)},ga.apply(cs,["Oskari",Oskari1LegacyAPI]),Oskari1LegacyAPI}(),Oskari.util=function(){function e(e){return"string"==typeof e&&e.length>0&&"0"===e[0]?!(t.isDecimal(e)&&e.length>1&&"."===e[1]):!1}var t={};return t.isNumber=function(t,n){var r,i=new RegExp("^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$"),o=!0;if("object"==typeof t)for(r=0;r<t.length;r++){if(n&&n===!0&&e(t[r]+"")){o=!1;break}if(i.test(t[r])===!1){o=!1;break}}else o=n&&n===!0&&e(t+"")?!1:i.test(t);return o},t.isDecimal=function(t){var n,r,i,o=!0;if(!t||null===t||""===t)return!1;if("object"==typeof t)for(n=0;n<t.length&&(i=String(t[n]),r=i.split("."),o=!(2!==r.length||e(i)||isNaN(r[0])||isNaN(r[1])),o!==!1);n++);else i=t+"",r=i.split("."),o=2===r.length&&!isNaN(r[0])&&!isNaN(r[1])&&(e(r[0])&&1==r[0].length||!e(r[0]));return o},t.decimals=function(e){var t,n=0;if(!e||null===e||""===e||isNaN(e)&&"object"!=typeof e)return null;if("object"==typeof e){for(i=0;i<e.length;i++)t=e[i]+"",t=t.split("."),2===t.length&&n<t[1].length&&(n=t[1].length);return n}return t=e+"",t=t.split("."),2===t.length?t[1].length:0},t.hexToRgb=function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,n,r){return t+t+n+n+r+r});var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null},t.rgbToHex=function(e){if("#"===e.charAt(0))return e.substring(1);var t,n=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);for(delete n[0],t=1;3>=t;t+=1)n[t]=parseInt(n[t],10).toString(16),1===n[t].length&&(n[t]="0"+n[t]);return n.join("")},t.keyExists=function(e,t){for(var n=e,r=0,i=t.split("."),o=0;n&&o<i.length;o++)i[o]in n&&(n=n[i[o]],r++);return r===i.length},t.naturalSort=function(e,t,n){var r,i,o=/(^([+\-]?(?:\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[\da-fA-F]+$|\d+)/g,a=/^\s+|\s+$/g,s=/\s+/g,l=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,u=/^0x[0-9a-f]+$/i,d=/^0/,c=function(e){return(""+e).toLowerCase().replace(a,"")},f=c(e)||"",p=c(t)||"",h=f.replace(o,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),g=p.replace(o,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),m=parseInt(f.match(u),16)||1!==h.length&&Date.parse(f),b=parseInt(p.match(u),16)||m&&p.match(l)&&Date.parse(p)||null,v=function(e,t){return(!e.match(d)||1==t)&&parseFloat(e)||e.replace(s," ").replace(a,"")||0},y=function(e,t){return isNaN(e)!==isNaN(t)?(w=isNaN(e)?1:-1,!0):(typeof e!=typeof t&&(e+="",t+=""),t>e?(w=-1,!0):e>t?(w=1,!0):void 0)},w=0,_=!1;if(b&&(b>m?(w=-1,_=!0):m>b&&(w=1,_=!0)),!_)for(var S=0,k=h.length,x=g.length,E=Math.max(k,x);E>S&&(r=v(h[S]||"",k),i=v(g[S]||"",x),!(_=y(r,i)));S++);return n&&(w=-1*w),w},t}(),function(){var e=window.console,t=!1,n=function(t){var n=t.shift();e&&window.console[n]&&window.console[n].apply&&window.console[n].apply(window.console,t)},r=function(e,t){var n=Array.prototype.slice.call(t);return n.unshift(e),n},i=function(){if(!t)return"";var e=new Date;return e.toLocaleTimeString()+"."+e.getUTCMilliseconds()+" "},o=function(e,t,o,a,s){var l=i()+e+":",u=r(l,o);u=r(t,u),a&&s&&s.caller&&u.push(s.caller),n(u,s)},a=function(e,t,n){this.name=e||"Logger",this.isDebug=!!t,this.includeCaller=!!n};a.prototype.setInclCaller=function(e){this.includeCaller=!!e},a.prototype.enableDebug=function(e){this.isDebug=!!e},a.prototype.debug=function(){this.isDebug&&o(this.name,"debug",arguments,this.includeCaller,arguments.callee)},a.prototype.info=function(){o(this.name,"log",arguments,this.includeCaller,arguments.callee)},a.prototype.warn=function(){o(this.name,"warn",arguments,this.includeCaller,arguments.callee)},a.prototype.error=function(){o(this.name,"error",arguments,this.includeCaller,arguments.callee)};var s={};Oskari.log=function(e){if(e=e||"Oskari",s[e])return s[e];var t=new a(e);return s[e]=t,t}}(),function(e){if(e){var t={};e.bundle=function(e,n){return n&&(t[e]=n),t[e]}}}(Oskari),function(e){if(e&&!e.loader){var t=Oskari.log("Loader"),n=function(e,t,n){var r=document.head||document.body,i=document.createElement("link");i.rel=t||"stylesheet",i.type=n||"text/css",i.href=e,r.appendChild(i)},r=function(e,t){var n=e.split("/"),r=t.split("/");n.pop();for(var i=0;i<r.length;i++)"."!=r[i]&&(".."==r[i]?n.pop():n.push(r[i]));return n.join("/")},i=function(e,t){var n=t;return 0!==t.indexOf("/")&&(n=r(e,t)),n.split("//").join("/")},o=function(e,r){var o=[];e&&"function"==typeof e.slice?o=e.slice(0):t.warn("No startupsequence given to loader or sequence is not an array");var a=r||{},s={};return{processSequence:function(e){var n=this;if(0===o.length)return void e();var r=o.shift();if("object"!=typeof r)return t.warn("StartupSequence item is a "+typeof r+" instead of object. Skipping"),void this.processSequence(e);if("object"!=typeof r.metadata||"object"!=typeof r.metadata["Import-Bundle"])return t.warn('StartupSequence item doesn\'t contain the structure item.metadata["Import-Bundle"]. Skipping ',r),void this.processSequence(e);var i=r.bundlename;if(!i)return t.warn("StartupSequence item doesn't contain bundlename. Skipping ",r),void this.processSequence(e);var s=r.bundleinstancename||i,l=a[s]||{},u=r.metadata["Import-Bundle"],d=[],c=[];for(var f in u){var p=u[f];if("object"==typeof p&&"string"==typeof p.bundlePath){var h=p.bundlePath+"/"+f,g=h+"/bundle.js";d.push(g.split("//").join("/")),c.push({id:f,path:h})}else t.warn("StartupSequence import doesn't contain bundlePath. Skipping! Item is "+i+" import is "+f)}return Oskari.bundle(i)?(t.debug("Bundle preloaded "+i),n.startBundle(i,l),void this.processSequence(e)):void require(d,function(){for(var r=0;r<arguments.length;++r)"undefined"!=typeof arguments[r]&&t.warn("Support for AMD-bundles is not yet implemented",arguments[r]);t.debug("Loaded bundles",c),n.processBundleJS(c,function(){n.startBundle(i,l),n.processSequence(e)})},function(r){t.error("Error loading bundles for "+i,r),n.processSequence(e)})},startBundle:function(e,n){var r=Oskari.bundle(e);if(!r)throw new Error("Bundle not loaded "+e);var i=r.clazz.create();if(!i)throw new Error("Couldn't create an instance of bundle "+e);i.mediator={bundleId:e};for(var o in n)i[o]=n[o];t.debug("Starting bundle "+e);try{i.start()}catch(a){throw new Error("Couldn't start bundle with id "+e+". Error was: "+a)}},processBundleJS:function(e,t){var n=this,r=[],i=function(e){var n=r.indexOf(e);r.splice(n,1),0===r.length&&t()};e.forEach(function(e){var t=Oskari.bundle(e.id);t.clazz&&t.metadata&&t.metadata.source&&(r.push(e.id),n.handleBundleLoad(e.path,t.metadata.source,function(){i(e.id)}))})},handleBundleLoad:function(e,r,o){var a=[];r.locales&&r.locales.forEach(function(t){if(t.src.endsWith(".js")){var n=i(e,t.src);a.push(n),t.expose&&(s[n]=t.expose)}}),r.resources&&r.resources.forEach(function(t){t.src.endsWith(".js")&&a.push(i(e,t.src))}),r.scripts&&r.scripts.forEach(function(t){var r=i(e,t.src);t.src.endsWith(".js")?(a.push(r),t.expose&&(s[r]=t.expose)):t.src.endsWith(".css")&&n(r)}),r.links&&r.links.forEach(function(t){"import"===t.rel.toLowerCase()&&n(i(e,t.href),t.rel,"text/html")}),require(a,function(){for(var e=0;e<arguments.length;++e)if("undefined"!=typeof arguments[e]){var n=s[a[e]];n?window[n]=arguments[e]:t.warn('Support for AMD-files is not yet implemented. Bundles need to have an "expose" statement in bundle.js to register libs as globals.',a[e])}o()},function(e){t.error("Error loading files",a,e),o()})}}};o.log=t,o.linkFile=n,e.loader=o}}(Oskari);