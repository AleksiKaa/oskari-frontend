/* This is a packed Oskari bundle (bundle script version Thu May 31 2012 12:23:19 GMT+0300 (Suomen kes√§aika)) */ 
Oskari.clazz.define("Oskari.userinterface.bundle.ui.UserInterfaceBundleInstance",function(){this.sandbox=null;this.requestHandlers={};this.extensions=[];this.extensionsByName={};this.compiledTemplates={};this.flyoutContainer=null;this.tileContainer=null},{getName:function(){return"userinterface.DivManazer"},init:function(a){},getSandbox:function(){return this.sandbox},start:function(){this.compileTemplates();this.flyoutContainer=jQuery(document.body);this.tileContainer=jQuery("#menubar");var a=Oskari.$("sandbox");this.sandbox=a;this.sandbox.register(this);this.requestHandlers.add=Oskari.clazz.create("Oskari.userinterface.bundle.ui.request.AddExtensionRequestHandler",this);this.requestHandlers.remove=Oskari.clazz.create("Oskari.userinterface.bundle.ui.request.RemoveExtensionRequestHandler",this);this.requestHandlers.update=Oskari.clazz.create("Oskari.userinterface.bundle.ui.request.UpdateExtensionRequestHandler",this);a.addRequestHandler("userinterface.AddExtensionRequest",this.requestHandlers.add);a.addRequestHandler("userinterface.RemoveExtensionRequest",this.requestHandlers.remove);a.addRequestHandler("userinterface.UpdateExtensionRequest",this.requestHandlers.update);this.requestHandlers.modal=Oskari.clazz.create("Oskari.userinterface.bundle.ui.request.ModalDialogRequestHandler",this);a.addRequestHandler("userinterface.ModalDialogRequest",this.requestHandlers.modal)},update:function(){},stop:function(){sandbox.removeRequestHandler("userinterface.UpdateExtensionRequest",this.requestHandlers.update);sandbox.removeRequestHandler("userinterface.RemoveExtensionRequest",this.requestHandlers.remove);sandbox.removeRequestHandler("userinterface.AddExtensionRequest",this.requestHandlers.add);sandbox.removeRequestHandler("userinterface.ModalDialogRequest",this.requestHandlers.modal);this.sandbox.unregister(this);this.started=false},templates:{"Oskari.userinterface.Tile":'<div class="oskari-tile oskari-tile-closed"><div class="oskari-tile-title"></div><div class="oskari-tile-status"></div><div class="oskari-tile-close"></div></div>',"Oskari.userinterface.Flyout":'<div class="oskari-flyout oskari-closed"><div class="oskari-flyoutheading"></div><div class="oskari-flyouttoolbar"><div class="oskari-flyout-title"><p></p></div><div class="oskari-flyouttools"><div class="oskari-flyouttool-help"></div><div class="oskari-flyouttool-attach"></div><div class="oskari-flyouttool-detach"></div><div class="oskari-flyouttool-minimize"></div><div class="oskari-flyouttool-restore"></div><div class="oskari-flyouttool-close"></div></div></div><div class="oskari-flyoutcontentcontainer"><div class="oskari-flyoutcontent"></div></div></div>'},compileTemplates:function(){this.compiledTemplates["Oskari.userinterface.Tile"]=jQuery(this.templates["Oskari.userinterface.Tile"]);var a=jQuery(this.templates["Oskari.userinterface.Flyout"]);a.css("left","-3195px");a.css("top","-3100px");this.compiledTemplates["Oskari.userinterface.Flyout"]=a},addExtension:function(n){n.startExtension();var e=n.getPlugins();var i=null;var l=this.extensions;var f=this.extensionsByName;var o={state:"close",extension:n,draggable:null,draggableTarget:null,draggableHandle:null,viewState:{},extensionUpdatedEvent:null};o.extensionUpdatedEvent=this.sandbox.getEventBuilder("userinterface.ExtensionUpdatedEvent")(n,o.state);var j=l.length;var b=n.getName();var h=e["Oskari.userinterface.Flyout"];var m=null;if(h!=null){m=this.createFlyout(n,h,j,o);o.draggableHandle=m.children(".oskari-flyoutheading").get()[0];var g=m.children(".oskari-flyoutcontentcontainer");var a=g.children(".oskari-flyoutcontent");var d=g.children(".oskari-flyoutcontent");h.setEl(d.get());this.flyoutContainer.append(m);h.startPlugin()}var c=e["Oskari.userinterface.Tile"];var k=null;if(c!=null){k=this.createTile(n,c,j,o);c.startPlugin();k.fadeIn(200);this.tileContainer.append(k)}o.plugins={};if(c){o.plugins["Oskari.userinterface.Tile"]={plugin:c,el:k}}if(h){o.plugins["Oskari.userinterface.Flyout"]={plugin:h,el:m}}l.push(o);f[b]=o;return o},createTile:function(h,c,d,j){var f=this;var a=jQuery("#menubar");var e=this.compiledTemplates["Oskari.userinterface.Tile"].clone(true,true);
var g=e.children(".oskari-tile-title");g.append(c.getTitle());var b=e.children(".oskari-tile-status");g.click(function(){f.getSandbox().postRequestByName("userinterface.UpdateExtensionRequest",[h,"toggle"])});b.click(function(){f.getSandbox().postRequestByName("userinterface.UpdateExtensionRequest",[h,"toggle"])});var i=e.children(".oskari-tile-close");i.hide();c.setEl(e.get());return e},createFlyout:function(h,f,e,a){var d=this;var b=this.compiledTemplates["Oskari.userinterface.Flyout"].clone(true,true);b.find(".oskari-flyout-title p").append(h.getTitle());var g=b.children(".oskari-flyouttoolbar").children(".oskari-flyouttools");var c={attach:g.children(".oskari-flyouttool-attach"),detach:g.children(".oskari-flyouttool-detach"),minimize:g.children(".oskari-flyouttool-minimize"),restore:g.children(".oskari-flyouttool-restore"),close:g.children(".oskari-flyouttool-close"),help:g.children(".oskari-flyouttool-help")};c.detach.click(function(){d.getSandbox().postRequestByName("userinterface.UpdateExtensionRequest",[h,"detach"])});c.attach.click(function(){d.getSandbox().postRequestByName("userinterface.UpdateExtensionRequest",[h,"attach"])});c.minimize.click(function(){d.getSandbox().postRequestByName("userinterface.UpdateExtensionRequest",[h,"minimize"])});c.restore.click(function(){d.getSandbox().postRequestByName("userinterface.UpdateExtensionRequest",[h,"restore"])});c.close.click(function(){d.getSandbox().postRequestByName("userinterface.UpdateExtensionRequest",[h,"close"])});c.help.click(function(){d.getSandbox().postRequestByName("userguide.ShowUserGuideRequest",[{placement:"bottom",el:c.help,extension:h.getName(),toggle:true}])});return b},removeExtension:function(q){var l=this;var m=l.extensions;var g=this.extensionsByName;var r=g[q.getName()];var f=r.state;var i=r.plugins["Oskari.userinterface.Flyout"];if(i){var h=i.plugin;var o=i.el;var d=this.flyoutOps;var p=d.close;p.apply(this,[o,h,r]);o.remove()}var c=r.plugins["Oskari.userinterface.Tile"];if(c){var b=c.plugin;var k=c.el;k.remove()}g[q.getName()]=null;var a=[];for(var e=0,j=m.length;e<j;e++){if(m[e]===r){continue}a.push(m[e])}l.extensions=a;q.stopExtension()},updateExtension:function(j,d){var z=this;var x=z.extensions;var a=this.extensionsByName;var m=a[j.getName()];var h=m.state;var e=d.getState();if(e=="toggle"){if(h=="close"){e="attach"}else{if(h=="attach"){e="close"}else{if(h=="detach"){e="minimize"}else{if(h=="minimize"){e="restore"}else{if(h=="restore"){e="minimize"}}}}}}var k=m.plugins["Oskari.userinterface.Flyout"];if(e=="attach"&&k){var b=z.flyoutOps;var g=b.close;for(var p=0,u=x.length;p<u;p++){var q=x[p];if(q===m){continue}if(q.state!="attach"){continue}var c="close";var y=q.plugins;var s=y["Oskari.userinterface.Flyout"];if(s){var w=s.plugin;var o=s.el;q.state=c;g.apply(this,[o,w,q]);z.notifyExtensionViewStateChange(q)}else{continue}var l=y["Oskari.userinterface.Tile"];if(l){var f=l.plugin;var B=l.el;z.applyTransition(B,c,z.tileTransitions)}}}if(k){var r=k.plugin;var v=k.el;var b=z.flyoutOps;var i=b[e];i.apply(this,[v,r,m,x])}var t=m.plugins["Oskari.userinterface.Tile"];if(t){var C=t.plugin;var A=t.el;z.applyTransition(A,e,z.tileTransitions)}m.state=e;z.notifyExtensionViewStateChange(m)},notifyExtensionViewStateChange:function(a){var b=a.extensionUpdatedEvent;b.setViewState(a.state);b.setViewInfo(a.viewState);this.sandbox.notifyAll(b,true)},defaults:{detach:{left:"245px",top:"100px"},attach:{left:"214px",top:"100px"}},tileTransitions:{attach:{"oskari-tile-attached":true,"oskari-tile-detached":false,"oskari-tile-closed":false},detach:{"oskari-tile-attached":false,"oskari-tile-detached":true,"oskari-tile-minimized":false,"oskari-tile-closed":false},minimize:{"oskari-tile-minimized":true,"oskari-tile-closed":false,"oskari-tile-detached":false},restore:{"oskari-tile-minimized":false,"oskari-tile-detached":true},close:{"oskari-tile-closed":true,"oskari-tile-attached":false,"oskari-tile-detached":false}},flyoutTransitions:{attach:{"oskari-attached":true,"oskari-detached":false,"oskari-closed":false},detach:{"oskari-attached":false,"oskari-detached":true,"oskari-closed":false},minimize:{"oskari-minimized":true,"oskari-closed":false,"oskari-detached":false},restore:{"oskari-minimized":false,"oskari-closed":false,"oskari-detached":true,"oskari-attached":false},close:{"oskari-closed":true,"oskari-minimized":false,"oskari-detached":false,"oskari-attached":false}},applyTransition:function(d,b,c){var c=c[b];
if(!c){return}for(var a in c){if(c[a]){d.addClass(a)}else{d.removeClass(a)}}},getFlyoutViewState:function(a,c){var b={left:a.css("left"),top:a.css("top"),width:a.width(),height:a.height(),"z-index":a.css("z-index"),viewState:c};return b},flyoutOps:{detach:function(c,d,a,f){var g=this;if((!a.viewState.left||!a.viewState.top)||(a.viewState.left==g.defaults.attach.left&&a.viewState.top==g.defaults.attach.top)){a.viewState.left=g.defaults.detach.left;a.viewState.top=g.defaults.detach.top}var b={left:a.viewState.left,top:a.viewState.top};c.animate(b,200,"cubicIn",function(){var i=g.getFlyoutViewState(c,"detach");a.viewState=i});g.applyTransition(c,"detach",g.flyoutTransitions);var e=c.get()[0];var h=a.draggableHandle;a.draggableTarget=e;a.draggable=new Draggable(e,{handle:h,scroll:false,onStop:function(i,j){g.shuffleZIndices(c);var k=g.getFlyoutViewState(c,"detach");a.viewState=k;g.notifyExtensionViewStateChange(a)}})},attach:function(b,c,a,d){var e=this;b.removeAttr("style");e.applyTransition(b,"attach",e.flyoutTransitions);b.css("left",e.defaults.attach.left);b.css("top",e.defaults.attach.top);var f=e.getFlyoutViewState(b,"attach");a.viewState=f;if(a.draggable){a.draggable.destroy();a.draggable=null}},minimize:function(b,c,a){var d=this;var e=d.getFlyoutViewState(b,"minimize");d.applyTransition(b,"minimize",d.flyoutTransitions);a.viewState=e},restore:function(b,c,a){var d=this;d.applyTransition(b,"restore",d.flyoutTransitions);var e=a.viewState},close:function(b,c,a){var d=this;a.viewState={viewState:"close"};d.applyTransition(b,"close",d.flyoutTransitions);if(a.draggable){a.draggable.destroy();a.draggable=null}}},setState:function(f){var d=this;var b=f;if(!b){return}for(var g in d.extensionsByName){var a=d.extensionsByName[g];var c=b.extensionStatesByName[g];if(!c){continue}a.state=c.state;a.viewState=c.viewState||{}}},getState:function(){var c=this;c.refreshExtensionViewStates();var b={extensionStatesByName:{}};for(var d in c.extensionsByName){var a=c.extensionsByName[d];b.extensionStatesByName[d]={state:a.state,viewState:a.viewState}}return b},applyState:function(){var a=this;a.restoreExtensionViewStates()},refreshExtensionViewStates:function(){var f=this;for(var h in f.extensionsByName){var a=f.extensionsByName[h];var d=a.plugins["Oskari.userinterface.Flyout"];if(d){var c=d.plugin;var b=d.el;var g=f.getFlyoutViewState(b,a.state);a.viewState=g}}},restoreExtensionViewStates:function(){var k=this;var c=k.flyoutOps;var l=k.extensions;for(var j in k.extensionsByName){var o=k.extensionsByName[j];var n=o.extension;var h=o.plugins["Oskari.userinterface.Flyout"];if(h){var f=h.plugin;var m=h.el;var d=o.viewState;m.removeAttr("style");m.css("left",d.left),m.css("top",d.top);m.width(d.width);m.height(d.height);m.css("z-index",d["z-index"]);var g=c[o.state];g.apply(k,[m,f,o,l])}var b=o.plugins["Oskari.userinterface.Tile"];if(b){var a=b.plugin;var i=b.el;k.applyTransition(i,o.state,k.tileTransitions)}}},shuffleZIndices:function(m){var i=this;var j=i.extensions;var s=[];var a={};var c={};var p={};var d=1100;for(var h in i.extensionsByName){var r=i.extensionsByName[h];var q=r.extension;var g=r.plugins["Oskari.userinterface.Flyout"];if(g){var f=g.plugin;var l=g.el;var k=l.css("z-index");s.push(k);var o=""+k;a[o]=k;p[o]=l;c[o]=r}}s.sort();for(var b=0;b<s.length;b++){var o=s[b];a[o]=d+b;if(c[o].state!="detach"){continue}p[o].css("z-index",a[s[b]])}m.css("z-index",d+s.length+2)}},{protocol:["Oskari.bundle.BundleInstance","Oskari.mapframework.module.Module","Oskari.userinterface.Stateful"]});Oskari.clazz.define("Oskari.userinterface.request.AddExtensionRequest",function(a){this._extension=a},{__name:"userinterface.AddExtensionRequest",getName:function(){return this.__name},getExtension:function(){return this._extension}},{protocol:["Oskari.mapframework.request.Request"]});Oskari.clazz.define("Oskari.userinterface.bundle.ui.request.AddExtensionRequestHandler",function(a){this.ui=a},{handleRequest:function(a,b){var c=b.getExtension();this.ui.addExtension(c)}},{protocol:["Oskari.mapframework.core.RequestHandler"]});Oskari.clazz.define("Oskari.userinterface.request.RemoveExtensionRequest",function(a){this._extension=a
},{__name:"userinterface.RemoveExtensionRequest",getName:function(){return this.__name},getExtension:function(){return this._extension}},{protocol:["Oskari.mapframework.request.Request"]});Oskari.clazz.define("Oskari.userinterface.bundle.ui.request.RemoveExtensionRequestHandler",function(a){this.ui=a},{handleRequest:function(a,b){var c=b.getExtension();this.ui.removeExtension(c)}},{protocol:["Oskari.mapframework.core.RequestHandler"]});Oskari.clazz.define("Oskari.userinterface.request.UpdateExtensionRequest",function(b,a){this._extension=b;this._state=a},{__name:"userinterface.UpdateExtensionRequest",getName:function(){return this.__name},getExtension:function(){return this._extension},getState:function(){return this._state}},{protocol:["Oskari.mapframework.request.Request"]});Oskari.clazz.define("Oskari.userinterface.bundle.ui.request.UpdateExtensionRequestHandler",function(a){this.ui=a},{handleRequest:function(a,b){var c=b.getExtension();this.ui.updateExtension(c,b)}},{protocol:["Oskari.mapframework.core.RequestHandler"]});Oskari.clazz.define("Oskari.userinterface.request.ModalDialogRequest",function(d,c,b,a){this._title=d?d:"Untitled";this._message=c?c:"Lorem ipsum";this._buttons=b?b:{};this._parent=parent?parent:jQuery("#mapdiv");this._onshow=a?a:null},{__name:"userinterface.ModalDialogRequest",getName:function(){return this.__name},getTitle:function(){return this._title},getMessage:function(){return this._message},getButtons:function(){return this._buttons},getGeom:function(){return this._geom},getParent:function(){return this._parent},getOnShow:function(){return this._onshow}},{protocol:["Oskari.mapframework.request.Request"]});Oskari.clazz.define("Oskari.userinterface.bundle.ui.request.ModalDialogRequestHandler",function(a){this._ui=a;this._tpl={};this._tpl.modal=jQuery('<div id="modaldialog" class="modaldialog">  <div class="modaltitle"></div>  <div class="modalmessage"></div>  <div class="modalbuttons"></div> </div>');this._tpl.button=jQuery('<div class="modalbutton"><input type="button" /></input></div>');this._buttons={};this._args={closeClass:"modalclose",overlayId:"modaloverlay",overlayCss:{"background-color":"lightgrey",cursor:"wait"},containerId:"modalcontainer",containerCss:{"background-color":"white"},onClose:function(){this.close()},zIndex:80130}},{handleRequest:function(c,d){var h=this._tpl.modal.clone();h.find(".modaltitle").append(d.getTitle());h.find(".modalmessage").append(d.getMessage());var e=d.getButtons();var i=h.find(".modalbuttons");for(var b in e){if(!e[b].name){continue}var a=e[b];var g=this._tpl.button.clone();var f=g.find("input");f.attr("name",a.name);f.attr("text",a.text);f.attr("value",a.text);f.bind("click",a.onclick);if(a.close!==false){f.addClass(this._args.closeClass)}i.append(g)}if(d.onshow){this._args.onShow=onshow}$.modal=h.modal(this._args)}},{protocol:["Oskari.mapframework.core.RequestHandler"]});Oskari.clazz.define("Oskari.userinterface.event.ExtensionUpdatedEvent",function(c,a,b){this._creator=null;this._extension=c;this.viewstate=a;this.viewinfo=b},{__name:"userinterface.ExtensionUpdatedEvent",getName:function(){return this.__name},getExtension:function(){return this._extension},getViewState:function(){return this.viewstate},setViewState:function(a){this.viewstate=a},getViewInfo:function(){return this.viewinfo},setViewInfo:function(a){this.viewinfo=a}},{protocol:["Oskari.mapframework.event.Event"]});Oskari.clazz.define("Oskari.userinterface.component.Accordion",function(){this.template=jQuery('<div class="accordion"></div>');this.panels=[];this.ui=this.template.clone()},{addPanel:function(a){this.panels.push(a);a.insertTo(this.ui)},removePanel:function(c){var a=null;for(var b=0;b<this.panels.length;b++){if(this.panels[b]===c){a=this.panels[b];this.panels.splice(b,1);break}}if(a){a.destroy();return true}return false},insertTo:function(a){a.append(this.ui)}});Oskari.clazz.define("Oskari.userinterface.component.AccordionPanel",function(){this.template=jQuery('<div class="accordion_panel"><div class="header"></div><div class="content"></div></div>');this.title=null;this.content=null;
this.html=this.template.clone();var a=this.html.find("div.header");a.click(function(){var c=jQuery(this).parent();var b=c.hasClass("open");if(b){c.removeClass("open");c.find("div.content").hide()}else{c.addClass("open");c.find("div.content").show()}});this.html.find("div.content").hide()},{setTitle:function(a){this.title=a;var b=this.html.find("div.header");b.append(this.title)},setContent:function(b){this.content=b;var a=this.html.find("div.content");a.append(this.content)},destroy:function(){this.html.remove()},getContainer:function(){return this.html.find("div.content")},insertTo:function(a){a.append(this.html)}});Oskari.clazz.define("Oskari.userinterface.component.Badge",function(){this.compiledTemplates={};this.compileTemplates();this.ui=null;this.container=null},{templates:{"default":'<span class="oskari-badge"></span>',success:'<span class="oskari-badge oskari-badge-success"></span>',warning:'<span class="oskari-badge oskari-badge-warning"></span>',important:'<span class="oskari-badge oskari-badge-important"></span>',info:'<span class="oskari-badge oskari-badge-info"></span>',success:'<span class="oskari-badge oskari-badge-inverse"></span>'},compileTemplates:function(){for(var a in this.templates){this.compiledTemplates[a]=jQuery(this.templates[a])}},insertTo:function(a){this.container=a},setContent:function(b,a){if(this.ui){this.ui.remove();this.ui=null}var c=this.compiledTemplates[a||"default"].clone();c.append(b);this.container.append(c);this.ui=c},hide:function(){if(this.ui){this.ui.remove();this.ui=null}}});Oskari.clazz.define("Oskari.userinterface.component.Alert",function(){this.compiledTemplates={};this.compileTemplates();this.ui=null;this.container=null},{templates:{"default":'<div class="oskari-alert"><div class="oskari-alert-icon-close"></div></div>',success:'<div class="oskari-alert oskari-alert-success"><div class="oskari-alert-icon-close"></div></div>',error:'<div class="oskari-alert oskari-alert-error"><div class="oskari-alert-icon-close"></div></div>',info:'<div class="oskari-alert oskari-alert-info"><div class="oskari-alert-icon-close"></div></div>'},compileTemplates:function(){for(var a in this.templates){this.compiledTemplates[a]=jQuery(this.templates[a])}},insertTo:function(a){this.container=a},setContent:function(d,a){if(this.ui){this.ui.remove();this.ui=null}var b=this.compiledTemplates[a||"default"].clone();b.append(d);this.container.prepend(b);this.ui=b;var c=this;b.children(".oskari-alert-icon-close").click(function(){c.hide()})},hide:function(){if(this.ui){this.ui.remove();this.ui=null}}});!function(c){var b=function(e,d){this.init("oskariTooltip",e,d)};b.prototype={constructor:b,init:function(g,f,e){var h,d;this.type=g;this.$element=c(f);this.options=this.getOptions(e);this.enabled=true;if(this.options.trigger!="manual"){h=this.options.trigger=="hover"?"mouseenter":"focus";d=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(h,this.options.selector,c.proxy(this.enter,this));this.$element.on(d,this.options.selector,c.proxy(this.leave,this))}this.options.selector?(this._options=c.extend({},this.options,{trigger:"manual",selector:""})):this.fixTitle()},getOptions:function(d){d=c.extend({},c.fn[this.type].defaults,d,this.$element.data());if(d.delay&&typeof d.delay=="number"){d.delay={show:d.delay,hide:d.delay}}return d},enter:function(f){var d=c(f.currentTarget)[this.type](this._options).data(this.type);if(!d.options.delay||!d.options.delay.show){return d.show()}clearTimeout(this.timeout);d.hoverState="in";this.timeout=setTimeout(function(){if(d.hoverState=="in"){d.show()}},d.options.delay.show)},leave:function(f){var d=c(f.currentTarget)[this.type](this._options).data(this.type);if(!d.options.delay||!d.options.delay.hide){return d.hide()}clearTimeout(this.timeout);d.hoverState="out";this.timeout=setTimeout(function(){if(d.hoverState=="out"){d.hide()}},d.options.delay.hide)},show:function(){var h,d,j,f,i,e,g;if(this.hasContent()&&this.enabled){h=this.tip();this.setContent();if(this.options.animation){h.addClass("fade")}e=this.options.placement.apply(this.options.scope);d=/in/.test(e);
h.remove().css({top:0,left:0,display:"block"}).appendTo(d?this.$element:document.body);j=this.getPosition(d);f=h[0].offsetWidth;i=h[0].offsetHeight;switch(d?e.split(" ")[1]:e){case"bottom":g={top:j.top+j.height,left:j.left+j.width/2-f/2};break;case"top":g={top:j.top-i,left:j.left+j.width/2-f/2};break;case"left":g={top:j.top+j.height/2-i/2,left:j.left-f};break;case"right":g={top:j.top+j.height/2-i/2,left:j.left+j.width};break}h.css(g).addClass(e).addClass("in")}},isHTML:function(d){return typeof d!="string"||(d.charAt(0)==="<"&&d.charAt(d.length-1)===">"&&d.length>=3)||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(d)},setContent:function(){var e=this.tip(),d=this.getTitle();e.find(".oskari-tooltip-inner")[this.isHTML(d)?"html":"text"](d);e.removeClass("fade in top bottom left right")},hide:function(){var d=this,e=this.tip();e.removeClass("in");function f(){var g=setTimeout(function(){e.off(c.support.transition.end).remove()},500);e.one(c.support.transition.end,function(){clearTimeout(g);e.remove()})}c.support.transition&&this.$tip.hasClass("fade")?f():e.remove()},fixTitle:function(){var d=this.$element;if(d.attr("title")||typeof(d.attr("data-original-title"))!="string"){d.attr("data-original-title",d.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(d){return c.extend({},(d?{top:0,left:0}:this.$element.offset()),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){return this.options.title.apply(this.options.scope)},tip:function(){return this.$tip=this.$tip||c(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},attach:function(d){this.$element=d}};c.fn.oskariTooltip=function(d){return this.each(function(){var g=c(this),f=g.data("oskariTooltip"),e=typeof d=="object"&&d;if(!f){g.data("oskariTooltip",(f=new b(this,e)))}if(typeof d=="string"){f[d]()}})};c.fn.oskariTooltip.Constructor=b;c.fn.oskariTooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="oskari-tooltip"><div class="oskari-tooltip-arrow"></div><div class="oskari-tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0};var a=function(e,d){this.init("oskariPopover",e,d)};a.prototype=c.extend({},c.fn.oskariTooltip.Constructor.prototype,{constructor:a,setContent:function(){var f=this.tip(),e=this.getTitle(),d=this.getContent();f.find(".oskari-popover-title")[this.isHTML(e)?"html":"text"](e);f.find(".oskari-popover-content > *")[this.isHTML(d)?"html":"text"](d);f.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){return this.options.content.apply(this.options.scope)},tip:function(){if(!this.$tip){this.$tip=c(this.options.template)}return this.$tip}});c.fn.oskariPopover=function(d){return this.each(function(){var g=c(this),f=g.data("oskariPopover"),e=typeof d=="object"&&d;if(!f){g.data("oskariPopover",(f=new a(this,e)))}if(typeof d=="string"){f[d]()}})};c.fn.oskariPopover.Constructor=a;c.fn.oskariPopover.defaults=c.extend({},c.fn.oskariTooltip.defaults,{placement:"right",content:"",template:'<div class="oskari-popover"><div class="oskari-arrow"></div><div class="oskari-popover-inner"><h3 class="oskari-popover-title"></h3><div class="oskari-popover-content"><p></p></div></div></div>'});Oskari.clazz.define("Oskari.userinterface.component.Popover",function(e,d){this.title=e;this.content=d;this.$container=null;this.data=null;this.shown=false;this.placement="bottom"},{templates:{container:'<div class="oskari-popover-container"/>'},hide:function(){if(!this.shown){return}this.shown=false;if(!this.data){return}this.data.hide()},show:function(){if(this.shown){return}if(!this.data){return}this.data.show();this.shown=true},attachTo:function(d){var e=this;this.$container=c(d);if(!this.data){this.data=new a(d,{scope:e,title:e.getTitle,content:e.getContent,trigger:"manual",placement:e.getPlacement,})
}else{this.data.attach(this.$container)}this.$container.data("oskariPopover",this.data)},getTitle:function(){return this.title},getContent:function(){return this.content},setContent:function(d,e){this.hide();this.content=d;if(e){this.title=e}this.show()},setTitle:function(e,d){this.hide();this.title=e;if(d){this.content=d}this.show()},setPlacement:function(d){this.placement=d},getPlacement:function(){return this.placement}})}(window.jQuery);