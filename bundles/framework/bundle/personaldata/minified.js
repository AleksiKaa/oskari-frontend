Oskari.clazz.define("Oskari.mapframework.bundle.personaldata.PersonalDataBundleInstance",function(){this.core=null,this.sandbox=null,this.started=!1,this.template=null,this.plugins={},this.viewService=null},{__name:"PersonalData",getName:function(){return this.__name},setSandbox:function(e){this.sandbox=e},getSandbox:function(){return this.sandbox},getViewService:function(){return this.viewService},getLocalization:function(e){return this._localization||(this._localization=Oskari.getLocalization(this.getName())),e?this._localization[e]:this._localization},start:function(){var e=this;if(e.started)return;e.started=!0;var t=this.conf,n=(t?t.sandbox:null)||"sandbox",r=Oskari.getSandbox(n);e.sandbox=r,this.viewService=Oskari.clazz.create("Oskari.mapframework.bundle.personaldata.service.ViewService",r.getAjaxUrl()),r.register(e);for(p in e.eventHandlers)r.registerForEventByName(e,p);var i=r.getRequestBuilder("userinterface.AddExtensionRequest")(this);r.request(this,i),e.createUi()},init:function(){return null},update:function(){},onEvent:function(e){var t=this.eventHandlers[e.getName()];if(!t)return;return t.apply(this,[e])},eventHandlers:{},stop:function(){var e=this.sandbox();for(p in this.eventHandlers)e.unregisterFromEventByName(this,p);var t=e.getRequestBuilder("userinterface.RemoveExtensionRequest")(this);e.request(this,t),this.sandbox.unregister(this),this.started=!1},startExtension:function(){this.plugins["Oskari.userinterface.Flyout"]=Oskari.clazz.create("Oskari.mapframework.bundle.personaldata.Flyout",this),this.plugins["Oskari.userinterface.Tile"]=Oskari.clazz.create("Oskari.mapframework.bundle.personaldata.Tile",this)},stopExtension:function(){this.plugins["Oskari.userinterface.Flyout"]=null,this.plugins["Oskari.userinterface.Tile"]=null},getPlugins:function(){return this.plugins},getTitle:function(){return this.getLocalization("title")},getDescription:function(){return this.getLocalization("desc")},createUi:function(){var e=this;this.plugins["Oskari.userinterface.Flyout"].createUi(),this.plugins["Oskari.userinterface.Tile"].refresh()}},{protocol:["Oskari.bundle.BundleInstance","Oskari.mapframework.module.Module","Oskari.userinterface.Extension"]}),define("bundles/framework/bundle/personaldata/instance",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.personaldata.Flyout",function(e){this.instance=e,this.container=null,this.state=null,this.template=null,this.templateTabHeader=null,this.templateTabContent=null,this.tabsData=[]},{getName:function(){return"Oskari.mapframework.bundle.personaldata.Flyout"},setEl:function(e,t,n){this.container=e[0],jQuery(this.container).hasClass("personaldata")||jQuery(this.container).addClass("personaldata")},startPlugin:function(){var e=this,t=this.instance.getLocalization("tabs");this.tabsData={myPlaces:Oskari.clazz.create("Oskari.mapframework.bundle.personaldata.MyPlacesTab",this.instance,t.myplaces),myViews:Oskari.clazz.create("Oskari.mapframework.bundle.personaldata.MyViewsTab",this.instance,t.myviews),publishedMaps:Oskari.clazz.create("Oskari.mapframework.bundle.personaldata.PublishedMapsTab",this.instance,t.publishedmaps),account:Oskari.clazz.create("Oskari.mapframework.bundle.personaldata.AccountTab",this.instance,t.account)}},stopPlugin:function(){},getTitle:function(){return this.instance.getLocalization("title")},getDescription:function(){return this.instance.getLocalization("desc")},getOptions:function(){},setState:function(e){this.state=e},createUi:function(){var e=this,t=e.instance.getSandbox(),n=jQuery(this.container);n.empty(),this.tabsContainer=Oskari.clazz.create("Oskari.userinterface.component.TabContainer",this.instance.getLocalization("notLoggedIn")),this.tabsContainer.insertTo(n);if(!t.getUser().isLoggedIn())return;for(var r in this.tabsData){var i=this.tabsData[r],s=Oskari.clazz.create("Oskari.userinterface.component.TabPanel");s.setTitle(i.getTitle()),i.addTabContent(s.getContainer()),i.bindEvents&&i.bindEvents(),this.tabsContainer.addPanel(s)}}},{protocol:["Oskari.userinterface.Flyout"]}),define("bundles/framework/bundle/personaldata/Flyout",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.personaldata.Tile",function(e){this.instance=e,this.container=null,this.template=null},{getName:function(){return"Oskari.mapframework.bundle.personaldata.Tile"},setEl:function(e,t,n){this.container=jQuery(e)},startPlugin:function(){this.refresh()},stopPlugin:function(){this.container.empty()},getTitle:function(){return this.instance.getLocalization("title")},getDescription:function(){},getOptions:function(){},setState:function(e){},refresh:function(){}},{protocol:["Oskari.userinterface.Tile"]}),define("bundles/framework/bundle/personaldata/Tile",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.personaldata.MyPlacesTab",function(e,t){this.instance=e,this.loc=t,this.tabsContainer=undefined,this.tabPanels={},this.linkTemplate=jQuery('<a href="JavaScript:void(0);"></a>'),this.iconTemplate=jQuery('<div class="icon"></div>')},{getName:function(){return"PersonalData.MyPlaces"},getTitle:function(){return this.loc.title},addTabContent:function(e){var t=this;this.tabsContainer=Oskari.clazz.create("Oskari.userinterface.component.TabDropdownContainer",this.loc.nocategories),this.tabsContainer.insertTo(e)},eventHandlers:{"MyPlaces.MyPlacesChangedEvent":function(e){var t=this.instance.sandbox.getService("Oskari.mapframework.bundle.myplaces2.service.MyPlacesService"),n=t.getAllCategories(),r=t.getAllMyPlaces(),i=this,s=function(e,t){return function(){var n=i.instance.sandbox.getRequestBuilder("MyPlaces.PublishCategoryRequest")(e,t);return i.instance.sandbox.request(i.instance,n),!1}},o=function(e){return function(){var t=i.instance.sandbox.getRequestBuilder("MyPlaces.EditCategoryRequest")(e);return i.instance.sandbox.request(i.instance,t),!1}},u=function(e){return function(){var t=i.instance.sandbox.getRequestBuilder("MyPlaces.DeleteCategoryRequest")(e);return i.instance.sandbox.request(i.instance,t),!1}};for(var a=0;a<n.length;++a){var f=n[a].getId(),l=this.tabPanels[f];l||(l=this._createCategoryTab(n[a]),this.tabsContainer.addPanel(l),this.tabPanels[f]=l),this._populatePlaces(f),l.getContainer().empty(),l.grid.renderTo(l.getContainer());var c=this.linkTemplate.clone();c.addClass("categoryOp"),c.append(this.loc.editCategory),c.bind("click",o(f)),l.getContainer().append(c);var h=this.linkTemplate.clone();h.addClass("categoryOp"),h.append(this.loc.deleteCategory),h.bind("click",u(f)),l.getContainer().append(h);var p=this.linkTemplate.clone();p.addClass("categoryOp");var d=n[a].isPublic(),v=this.iconTemplate.clone();d?(v.addClass("icon-public"),p.attr("title",this.loc.publishCategory.publicTooltip)):(v.addClass("icon-private"),p.attr("title",this.loc.publishCategory.privateTooltip)),p.append(v),p.bind("click",s(f,!d)),l.getContainer().append(p)}this._removeObsoleteCategories()}},_showPlace:function(e,t){var n=e.getCentroid(),r=this.instance.sandbox.getRequestBuilder("MapMoveRequest")(n.x,n.y,e.getBounds(),!1);this.instance.sandbox.request(this.instance,r);var i="myplaces_"+t,s=this.instance.sandbox.findMapLayerFromSelectedMapLayers(i);if(!s){var o=this.instance.sandbox.getRequestBuilder("AddMapLayerRequest")(i,!0);this.instance.sandbox.request(this.instance,o)}},_editPlace:function(e){this._showPlace(e.geometry,e.categoryId);var t=this.instance.sandbox.getRequestBuilder("MyPlaces.EditPlaceRequest")(e.id);this.instance.sandbox.request(this.instance,t)},_deletePlace:function(e){var t=this,n=this.instance.sandbox,r=this.loc.notification["delete"],i=Oskari.clazz.create("Oskari.userinterface.component.Popup"),s=Oskari.clazz.create("Oskari.userinterface.component.Button");s.setTitle(r.btnDelete),s.addClass("primary"),s.setHandler(function(){i.close();var s=n.getService("Oskari.mapframework.bundle.myplaces2.service.MyPlacesService"),o=function(s){var o=e.categoryId,u="myplaces_"+o,a=n.findMapLayerFromSelectedMapLayers(u);if(a){var f=n.getRequestBuilder("MapModulePlugin.MapLayerUpdateRequest"),l=f(u,!0);n.request(t.instance,l)}s?i.show(r.title,r.success):i.show(r.title,r.error),i.fadeout()};s.deleteMyPlace(e.id,o)});var o=i.createCloseButton(r.btnCancel),u=r.confirm+'"'+e.name+'"'+"?";i.show(r.title,u,[o,s]),i.makeModal()},_getDrawModeFromGeometry:function(e){if(e===null)return null;var t=e.CLASS_NAME;return"OpenLayers.Geometry.MultiPoint"===t||"OpenLayers.Geometry.Point"===t?"point":"OpenLayers.Geometry.MultiLineString"===t||"OpenLayers.Geometry.LineString"===t?"line":"OpenLayers.Geometry.MultiPolygon"===t||"OpenLayers.Geometry.Polygon"===t?"area":null},_createCategoryTab:function(e){var t=this,n=e.getId(),r=Oskari.clazz.create("Oskari.userinterface.component.TabPanel");r.setTitle(e.getName()),r.grid=Oskari.clazz.create("Oskari.userinterface.component.Grid");var i=["name","desc","createDate","updateDate","edit","delete"];r.grid.setVisibleFields(i);var s=function(e,n){var r=t.linkTemplate.clone(),i=t.iconTemplate.clone(),s=t._getDrawModeFromGeometry(n.geometry);return i.addClass("myplaces-"+s),r.append(i),r.append(e),r.bind("click",function(){return t._showPlace(n.geometry,n.categoryId),!1}),r};r.grid.setColumnValueRenderer("name",s);var o=function(e,n){var r=t.linkTemplate.clone();return r.append(e),r.bind("click",function(){return t._editPlace(n),!1}),r};r.grid.setColumnValueRenderer("edit",o);var u=function(e,n){var r=t.linkTemplate.clone();return r.append(e),r.bind("click",function(){return t._deletePlace(n),!1}),r};r.grid.setColumnValueRenderer("delete",u);for(var a=0;a<i.length;++a){var f=i[a];r.grid.setColumnUIName(f,this.loc.grid[f])}return r},_populatePlaces:function(e){var t=this.instance.sandbox.getService("Oskari.mapframework.bundle.myplaces2.service.MyPlacesService"),n=t.getAllMyPlaces(),r=this.tabPanels[e],i=Oskari.clazz.create("Oskari.userinterface.component.GridModel");i.setIdField("id"),r.grid.setDataModel(i);for(var s=0;s<n.length;++s){if(n[s].getCategoryID()!=e)continue;i.addData({id:n[s].getId(),name:n[s].getName(),desc:n[s].getDescription(),geometry:n[s].getGeometry(),categoryId:n[s].getCategoryID(),edit:this.loc.edit,"delete":this.loc["delete"],createDate:this._formatDate(t,n[s].getCreateDate()),updateDate:this._formatDate(t,n[s].getUpdateDate())})}},_formatDate:function(e,t){var n=e.parseDate(t),r="";return n.length>0&&(r=n[0]),r},_removeObsoleteCategories:function(){var e=this.instance.sandbox.getService("Oskari.mapframework.bundle.myplaces2.service.MyPlacesService");for(var t in this.tabPanels){var n=e.findCategory(t);n||(this.tabsContainer.removePanel(this.tabPanels[t]),this.tabPanels[t].grid=undefined,delete this.tabPanels[t].grid,this.tabPanels[t]=undefined,delete this.tabPanels[t])}},onEvent:function(e){var t=this.eventHandlers[e.getName()];if(!t)return;return t.apply(this,[e])},bindEvents:function(){var e=this.instance,t=e.getSandbox();for(p in this.eventHandlers)t.registerForEventByName(this,p)},unbindEvents:function(){var e=this.instance,t=e.getSandbox();for(p in this.eventHandlers)t.unregisterFromEventByName(this,p)}}),define("bundles/framework/bundle/personaldata/MyPlacesTab",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.personaldata.MyViewsTab",function(e,t){this.instance=e,this.loc=t,this.template=jQuery('<div class="viewsList volatile"></div>'),this.templateLink=jQuery('<a href="JavaScript:void(0);"></a>'),this.templateDesc=jQuery('<div class="oskarifield"><label for="description"></label><textarea id="view_description" name="description" placeholder="'+this.loc.popup.description_placeholder+'"></textarea></div>'),this.container=null;var n=e.sandbox,r=this,i=n.getRequestBuilder("StateHandler.SaveStateRequest");if(i){var s=n.getRequestBuilder("Toolbar.AddToolButtonRequest"),o="localization.button.toolbarsave";t&&t.button&&t.button.toolbarsave&&(o=t.button.toolbarsave),n.request(e,s("save_view","viewtools",{iconCls:"tool-save-view",tooltip:o,sticky:!1,prepend:!0,callback:function(){r._promptForView(function(t,r){var i=n.getRequestBuilder("StateHandler.SaveStateRequest");n.request(e,i(t,r))})}}))}if(!n.getUser().isLoggedIn()){var s=n.getRequestBuilder("Toolbar.ToolButtonStateRequest");n.request(e,s("save_view","viewtools",!1))}},{getName:function(){return"PersonalData.MyViews"},getTitle:function(){return this.loc.title},addTabContent:function(e){var t=this,n=t.template.clone();t.container=e,e.append(n),t._refreshViewsList()},_renderViewsList:function(e){e||(e=[]);var t=this,n=t.container.find(".viewsList");n.empty(),this.viewData=e;var r=this._getGridModel(e),i=this._getGrid(r);i.renderTo(n)},_refreshViewsList:function(){var e=this,t=e.instance.getViewService();t.loadViews("USER",function(t,n){t?e._renderViewsList(n.views):e._showErrorMessage(e.loc.error.loadfailed)})},_editView:function(e){var t=this,n=this.instance.getSandbox(),r=t.instance.getViewService(),i=function(n,i){r.updateView(e.id,n,i,function(e){if(e){var n=Oskari.clazz.create("Oskari.userinterface.component.Popup");n.show(t.loc.popup.title,t.loc.save.success),n.fadeout(),t._refreshViewsList()}else t._showErrorMessage(t.loc.error.notsaved)})};this._promptForView(i,e.name,e.description)},_promptForView:function(e,t,n){var r=this,i=Oskari.clazz.create("Oskari.userinterface.component.Form"),s=Oskari.clazz.create("Oskari.userinterface.component.FormInput","name");s.setPlaceholder(this.loc.popup.name_placeholder);var o=this.loc.popup.title;t&&(o=this.loc.popup.edit,s.setValue(t)),s.setRequired(!0,r.loc.save.error_noname),s.setContentCheck(!0,r.loc.save.error_illegalchars),i.addField(s);var u=i.getForm();u.append(r.templateDesc.clone()),n&&u.find("textarea").val(n);var a=Oskari.clazz.create("Oskari.userinterface.component.Popup"),f=Oskari.clazz.create("Oskari.userinterface.component.Button");f.setTitle(this.loc.button.save),f.addClass("primary");var l=this.instance.sandbox;f.setHandler(function(){var t=i.validate();t.length==0?(e(s.getValue(),u.find("textarea").val()),a.close()):i.showErrors()});var c=a.createCloseButton(this.loc.button.cancel);a.show(o,u,[c,f]),a.dialog.on("keyup",function(e){e.stopPropagation()}),a.dialog.on("keydown",function(e){e.stopPropagation()})},_getGridModel:function(e){var t=Oskari.clazz.create("Oskari.userinterface.component.GridModel");t.setIdField("id");for(var n=0;n<e.length;++n){var r=e[n],i=r.isPublic===!0,s={id:r.id,state:r.state,name:r.name,description:r.description,isPublic:i,edit:this.loc.edit,publish:i?this.loc.unpublish:this.loc.publish,"delete":this.loc["delete"]};t.addData(s)}return t},_getGrid:function(e){var t=this,n=this.instance,r=n.getSandbox(),i=["name","description","edit","delete"],s=Oskari.clazz.create("Oskari.userinterface.component.Grid");s.setDataModel(e),s.setVisibleFields(i);var o=function(e,i){var s=t.templateLink.clone();return s.append(e),s.bind("click",function(){var e=r.getRequestBuilder("StateHandler.SetStateRequest");if(e){var t=e(i.state);t.setCurrentViewId(i.id),r.request(n,t)}return!1}),s};s.setColumnValueRenderer("name",o);var u=function(e,n){var r=t.templateLink.clone();return r.append(e),r.bind("click",function(){var e=t._getViewById(n.id);return e&&t._editView(e),!1}),r};s.setColumnValueRenderer("edit",u);var a=function(e,n){var r=t.templateLink.clone();return r.append(e),r.bind("click",function(){var e=t._getViewById(n.id);return e&&t._confirmDelete(e),!1}),r};s.setColumnValueRenderer("delete",a);for(var f=0;f<i.length;++f){var l=i[f],c="grid."+l;this.loc&&this.loc.grid&&this.loc.grid[l]&&(c=this.loc.grid[l]),s.setColumnUIName(l,c)}return s},_getViewById:function(e){for(var t=0;t<this.viewData.length;++t)if(this.viewData[t].id==e)return this.viewData[t];this._showErrorMessage(me.loc.error.generic)},_confirmDelete:function(e){var t=this,n=Oskari.clazz.create("Oskari.userinterface.component.Popup"),r=Oskari.clazz.create("Oskari.userinterface.component.Button");r.setTitle(this.loc["delete"]),r.addClass("primary");var i=this.instance.sandbox;r.setHandler(function(){t._deleteView(e),n.close()});var s=n.createCloseButton(this.loc.button.cancel);n.show(t.loc.popup.deletetitle,t.loc.popup.deletemsg,[s,r]),n.makeModal()},_deleteView:function(e){var t=this,n=t.instance.getViewService();n.deleteView(e,function(e){e?t._refreshViewsList():t._showErrorMessage(t.loc.error.notdeleted)})},_showErrorMessage:function(e){var t=Oskari.clazz.create("Oskari.userinterface.component.Popup"),n=t.createCloseButton(this.loc.button.ok);n.addClass("primary"),t.show(this.loc.error.title,e,[n])},bindEvents:function(){var e=this.instance,t=e.getSandbox();for(var n in this.eventHandlers)t.registerForEventByName(this,n)},unbindEvents:function(){var e=this.instance,t=e.getSandbox();for(var n in this.eventHandlers)t.unregisterFromEventByName(this,n)},eventHandlers:{StateSavedEvent:function(e){if(e.isError()){this._showErrorMessage(this.loc.error.notsaved);return}var t=Oskari.clazz.create("Oskari.userinterface.component.Popup");t.show(this.loc.popup.title,this.loc.save.success),t.fadeout(),this._refreshViewsList()}},onEvent:function(e){var t=this.eventHandlers[e.getName()];if(!t)return;return t.apply(this,[e])}}),define("bundles/framework/bundle/personaldata/MyViewsTab",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.personaldata.service.ViewService",function(e){this._viewUrl=e},{__qname:"Oskari.mapframework.bundle.personaldata.service.ViewService",getQName:function(){return this.__qname},__name:"ViewService",getName:function(){return this.__name},loadViews:function(e,t){var n=this;e||(e="USER"),jQuery.ajax({url:n._viewUrl+"action_route=GetViews",data:{viewType:e},type:"POST",dataType:"json",beforeSend:function(e){e&&e.overrideMimeType&&e.overrideMimeType("application/j-son;charset=UTF-8")},success:function(e){t(!0,e)},error:function(){t(!1)}})},deleteView:function(e,t){var n=this;jQuery.ajax({url:n._viewUrl+"action_route=DeleteView",data:{id:e.id},type:"POST",beforeSend:function(e){e&&e.overrideMimeType&&e.overrideMimeType("application/j-son;charset=UTF-8")},success:function(e){t(!0)},error:function(){t(!1)}})},makeViewPublic:function(e,t,n){var r=this;jQuery.ajax({url:r._viewUrl+"action_route=AdjustViewAccess",data:{id:e,isPublic:t},type:"POST",dataType:"json",beforeSend:function(e){e&&e.overrideMimeType&&e.overrideMimeType("application/j-son;charset=UTF-8")},success:function(e){n(!0)},error:function(){n(!1)}})},updateView:function(e,t,n,r){var i=this;jQuery.ajax({url:i._viewUrl+"action_route=UpdateView",type:"POST",data:{id:e,newName:t,newDescription:n},dataType:"json",beforeSend:function(e){e&&e.overrideMimeType&&e.overrideMimeType("application/j-son;charset=UTF-8")},success:function(e){r(!0)},error:function(){r(!1)}})},isViewLayersLoaded:function(e,t){var n={status:!1,msg:"error"};if(e&&e.state&&e.state.mapfull&&e.state.mapfull.state&&e.state.mapfull.state.selectedLayers){var r=e.state.mapfull.state.selectedLayers,i=t.getService("Oskari.mapframework.service.MapLayerService"),s=i.getAllLayers(),o=i.isAllLayersLoaded(),u=!1;for(var a=0;a<r.length;++a){var f=i.findMapLayer(r[a].id,s);if(!f){u=!0;break}}o?u?n.msg="missing":(n.status=!0,n.msg="ok"):u?n.msg="notloaded":(n.status=!0,n.msg="ok")}return n}},{protocol:["Oskari.mapframework.service.Service"]}),define("bundles/framework/bundle/personaldata/service/ViewService",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.personaldata.PublishedMapsTab",function(e,t){this.instance=e,this.template=jQuery('<div class="viewsList volatile"></div>'),this.templateLink=jQuery('<a href="JavaScript:void(0);"></a>'),this.loc=t,this.container=null},{getName:function(){return"PersonalData.PublishedMapsTab"},getTitle:function(){return this.loc.title},addTabContent:function(e){var t=this,n=t.template.clone();t.container=e,e.append(n),t._refreshViewsList()},_renderViewsList:function(e){e||(e=[]);var t=this,n=t.container.find(".viewsList");n.empty(),this.viewData=e;var r=this._getGridModel(e),i=this._getGrid(r);i.renderTo(n)},_refreshViewsList:function(){var e=this,t=e.instance.getViewService();t.loadViews("PUBLISHED",function(t,n){t?e._renderViewsList(n.views):e._showErrorMessage(e.loc.error.loadfailed)})},_getViewById:function(e){for(var t=0;t<this.viewData.length;++t)if(this.viewData[t].id==e)return this.viewData[t];this._showErrorMessage(me.loc.error.generic)},_confirmSetState:function(e,t){var n=this,r=Oskari.clazz.create("Oskari.userinterface.component.Popup"),i=Oskari.clazz.create("Oskari.userinterface.component.Button");i.setTitle(this.loc.button.ok),i.addClass("primary"),i.setHandler(function(){r.close(),e&&t&&e()});var s=r.createCloseButton(this.loc.button.cancel);t?r.show(n.loc.popup.showErrorTitle,n.loc.popup.showConfirmMissing,[s,i]):r.show(n.loc.popup.showErrorTitle,n.loc.popup.showConfirmNotLoaded,[s]),r.makeModal()},_confirmDelete:function(e){var t=this,n=Oskari.clazz.create("Oskari.userinterface.component.Popup"),r=Oskari.clazz.create("Oskari.userinterface.component.Button");r.setTitle(this.loc["delete"]),r.addClass("primary");var i=this.instance.sandbox;r.setHandler(function(){t._deleteView(e),n.close()});var s=n.createCloseButton(this.loc.button.cancel);n.show(t.loc.popup.deletetitle,t.loc.popup.deletemsg,[s,r]),n.makeModal()},_deleteView:function(e){var t=this,n=t.instance.getViewService();n.deleteView(e,function(e){e?t._refreshViewsList():t._showErrorMessage(t.loc.error.notdeleted)})},_showErrorMessage:function(e){var t=Oskari.clazz.create("Oskari.userinterface.component.Popup"),n=t.createCloseButton(this.loc.button.ok);n.addClass("primary"),t.show(this.loc.error.title,e,[n])},_getGridModel:function(e){var t=Oskari.clazz.create("Oskari.userinterface.component.GridModel");t.setIdField("id");for(var n=0;n<e.length;++n){var r=e[n],i=r.isPublic===!0,s={id:r.id,state:r.state,name:r.name,domain:r.pubDomain,lang:r.lang,isPublic:i,show:this.loc.show,edit:this.loc.edit,publish:i?this.loc.unpublish:this.loc.publish,"delete":this.loc["delete"]};t.addData(s)}return t},_getGrid:function(e){var t=this,n=this.instance,r=n.getSandbox(),i=["name","domain","publish","show","edit","delete"],s=Oskari.clazz.create("Oskari.userinterface.component.Grid");s.setDataModel(e),s.setVisibleFields(i);var o=function(e,n){var r=t.templateLink.clone();return r.append(e),r.bind("click",function(){return window.open("/web/fi/kartta?p_p_id=Portti2Map_WAR_portti2mapportlet&p_p_lifecycle=0&p_p_state=exclusive&published=true&viewId="+n.id,"Published","location=1,status=1,scrollbars=yes,width=850,height=800"),!1}),r};s.setColumnValueRenderer("name",o);var u=r.getRequestBuilder("StateHandler.SetStateRequest"),a=n.getViewService(),f=function(e,i,s){var o=a.isViewLayersLoaded(e,r);if(o.status||i===!0){if(u){var f=u(e.state);return f.setCurrentViewId(e.id),r.request(n,f),!0}return!1}return t._confirmSetState(s,o.msg=="missing"),!1},l=function(e,n){var r=t.templateLink.clone();return r.append(e),r.bind("click",function(){return f(n,!1,function(){return f(n,!0),!1}),!1}),r};s.setColumnValueRenderer("show",l);var c=r.getRequestBuilder("Publisher.PublishMapEditorRequest"),h=function(e){if(c){var t=c(e);r.request(n,t)}},p=function(e,n){var r=t.templateLink.clone();return r.append(e),r.bind("click",function(){return f(n,!1,function(){f(n,!0),h(n)})&&h(n),!1}),r};s.setColumnValueRenderer("edit",p);var d=function(e,n){var r=t.templateLink.clone();return r.append(e),r.bind("click",function(){var e=t._getViewById(n.id);return e&&t._confirmDelete(e),!1}),r};s.setColumnValueRenderer("delete",d);var a=n.getViewService(),v=function(e,n){var r=t.templateLink.clone();return r.html(e),r.bind("click",function(){var e=t._getViewById(n.id);if(e){var i=!e.isPublic;a.makeViewPublic(n.id,i,function(s){s?(e.isPublic=i,e.isPublic?n.publish=t.loc.unpublish:n.publish=t.loc.publish,r.html(n.publish)):i?t._showErrorMessage(t.loc.error.makePublic):t._showErrorMessage(t.loc.error.makePrivate)})}return!1}),r};s.setColumnValueRenderer("publish",v);for(var m=0;m<i.length;++m){var g=i[m],y="grid."+g;this.loc&&this.loc.grid&&this.loc.grid[g]&&(y=this.loc.grid[g]),s.setColumnUIName(g,y)}return s},bindEvents:function(){var e=this.instance,t=e.getSandbox();for(var n in this.eventHandlers)t.registerForEventByName(this,n)},unbindEvents:function(){var e=this.instance,t=e.getSandbox();for(var n in this.eventHandlers)t.unregisterFromEventByName(this,n)},eventHandlers:{"Publisher.MapPublishedEvent":function(e){this._refreshViewsList()}},onEvent:function(e){var t=this.eventHandlers[e.getName()];if(!t)return;return t.apply(this,[e])}}),define("bundles/framework/bundle/personaldata/PublishedMapsTab",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.personaldata.AccountTab",function(e,t){this.instance=e,this.template=jQuery('<div class="account"><div class="info"></div><div class="bottomlinks"></div></div>'),this.loc=t},{getTitle:function(){return this.loc.title},addTabContent:function(e){var t=this.template.clone();e.append(t),this._createAccountTab(e)},_createAccountTab:function(e){var t=this,n=t.instance.getSandbox(),r=jQuery('<div class="dataField"><div class="label"></div><div class="value"></div><br clear="all" /></div>'),i=n.getUser(),s=this.loc,o=[{label:s.firstName,value:i.getFirstName()},{label:s.lastName,value:i.getLastName()},{label:s.nickName,value:i.getNickName()},{label:s.email,value:i.getLoginName()}],u=e.find("div.info");for(var a=0;a<o.length;++a){var f=o[a],l=r.clone();l.find(".label").html(f.label),l.find(".value").html(f.value),u.append(l)}var c=[{label:s.changeInfo,href:s.changeInfoUrl}],h=e.find("div.bottomlinks");for(var a=0;a<c.length;++a){var f=c[a],p=jQuery('<a href="'+f.href+'">'+f.label+"</a>&nbsp; ");h.append(p)}}}),define("bundles/framework/bundle/personaldata/AccountTab",function(){}),define("normalize",["require","module"],function(e,t){function o(e,t,n){if(e.indexOf("data:")===0)return e;e=r(e);if(e.match(/^\//)||e.match(s))return e;var i=n.match(s),o=t.match(s);return o&&(!i||i[1]!=o[1]||i[2]!=o[2])?u(e,t):a(u(e,t),n)}function u(e,t){e.substr(0,2)=="./"&&(e=e.substr(2));var n=t.split("/"),r=e.split("/");n.pop();while(curPart=r.shift())curPart==".."?n.pop():n.push(curPart);return n.join("/")}function a(e,t){var n=t.split("/");n.pop(),t=n.join("/")+"/",i=0;while(t.substr(i,1)==e.substr(i,1))i++;while(t.substr(i,1)!="/")i--;t=t.substr(i+1),e=e.substr(i+1),n=t.split("/");var r=e.split("/");out="";while(n.shift())out+="../";while(curPart=r.shift())out+=curPart+"/";return out.substr(0,out.length-1)}var n=/([^:])\/+/g,r=function(e){return e.replace(n,"$1/")},s=/[^\:\/]*:\/\/([^\/])*/,f=function(e,t,n,i){t=r(t),n=r(n);var s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\(\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/ig,u,a,e;while(u=s.exec(e)){a=u[3]||u[2]||u[5]||u[6]||u[4];var f;i&&a.substr(0,1)=="/"?f=i+a:f=o(a,t,n);var l=u[5]||u[6]?1:0;e=e.substr(0,s.lastIndex-a.length-l-1)+f+e.substr(s.lastIndex-l-1),s.lastIndex=s.lastIndex+(f.length-a.length)}return e};return f.convertURIBase=o,f}),define("css",["./normalize"],function(e){function t(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}if(typeof window=="undefined")return{load:function(e,t,n){n()}};var n=!1,r=document.getElementsByTagName("head")[0],i=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)/),s=!1;!i||(i[1]||i[7]?(s=parseInt(i[1])<6||parseInt(i[7])<=9,i="trident"):i[2]?(s=!0,i="webkit"):i[3]||(i[4]?(s=parseInt(i[4])<18,i="gecko"):n&&alert("Engine detection failed")));var o={},u=/^\/|([^\:\/]*:)/;o.pluginBuilder="./css-builder";var a=[],f={},l=[];o.addBuffer=function(e){if(t(a,e)!=-1)return;if(t(l,e)!=-1)return;a.push(e),l.push(e)},o.setBuffer=function(t,n){var r=window.location.pathname.split("/");r.pop(),r=r.join("/")+"/";var i=require.toUrl("base_url").split("/");i.pop();var s=i.join("/")+"/";s=e.convertURIBase(s,r,"/"),s.match(u)||(s="/"+s),s.substr(s.length-1,1)!="/"&&(s+="/"),o.inject(e(t,s,r));for(var l=0;l<a.length;l++)(n&&a[l].substr(a[l].length-5,5)==".less"||!n&&a[l].substr(a[l].length-4,4)==".css")&&(function(e){f[e]=f[e]||!0,setTimeout(function(){typeof f[e]=="function"&&f[e](),delete f[e]},7)}(a[l]),a.splice(l--,1))},o.attachBuffer=function(e,n){for(var r=0;r<a.length;r++)if(a[r]==e)return f[e]=n,!0;if(f[e]===!0)return f[e]=n,!0;if(t(l,e)!=-1)return n(),!0};var c=function(e,t){setTimeout(function(){for(var n=0;n<document.styleSheets.length;n++){var r=document.styleSheets[n];if(r.href==e.href)return t()}c(e,t)},10)},h=function(e,t){setTimeout(function(){try{return e.sheet.cssRules,t()}catch(n){}h(e,t)},10)};if(i=="trident"&&s)var p=[],d=[],v=0,m=function(e,t){var n;d.push({url:e,cb:t}),n=p.shift(),!n&&v++<31&&(n=document.createElement("style"),r.appendChild(n)),n&&g(n)},g=function(e){var t=d.shift();if(!t){e.onload=b,p.push(e);return}e.onload=function(){t.cb(t.ss),g(e)};var n=e.styleSheet;t.ss=n.imports[n.addImport(t.url)]};var y=function(e){var t=document.createElement("link");return t.type="text/css",t.rel="stylesheet",t.href=e,t},b=function(){};o.linkLoad=function(e,t){var o=setTimeout(function(){n&&alert("timeout"),t()},L*1e3-100),u=function(){clearTimeout(o),a&&(a.onload=b),setTimeout(t,7)};if(!s){var a=y(e);a.onload=u,r.appendChild(a)}else if(i=="webkit"){var a=y(e);c(a,u),r.appendChild(a)}else if(i=="gecko"){var f=document.createElement("style");f.textContent='@import "'+e+'"',h(f,u),r.appendChild(f)}else i=="trident"&&m(e,u)};var w=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],E={},S=function(e,t,n){if(E[e]){t(E[e]);return}var r,i,s;if(typeof XMLHttpRequest!="undefined")r=new XMLHttpRequest;else if(typeof ActiveXObject!="undefined")for(i=0;i<3;i+=1){s=w[i];try{r=new ActiveXObject(s)}catch(o){}if(r){w=[s];break}}r.open("GET",e,requirejs.inlineRequire?!1:!0),r.onreadystatechange=function(i){var s,o;r.readyState===4&&(s=r.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=r,n(o)):(E[e]=r.responseText,t(r.responseText)))},r.send(null)},x=0,T;o.inject=function(e){x<31&&(T=document.createElement("style"),T.type="text/css",r.appendChild(T),x++),T.styleSheet?T.styleSheet.cssText+=e:T.appendChild(document.createTextNode(e))};var N=/@import\s*(url)?\s*(('([^']*)'|"([^"]*)")|\(('([^']*)'|"([^"]*)"|([^\)]*))\))\s*;?/g,C=window.location.pathname.split("/");C.pop(),C=C.join("/")+"/";var k=function(t,n,r){t.match(u)||(t="/"+e.convertURIBase(t,C,"/")),S(t,function(i){i=e(i,t,C);var s=[],o=[],u=[],a;while(a=N.exec(i)){var f=a[4]||a[5]||a[7]||a[8]||a[9];s.push(f),o.push(N.lastIndex-a[0].length),u.push(a[0].length)}var l=0;for(var c=0;c<s.length;c++)(function(e){k(s[e],function(t){i=i.substr(0,o[e])+t+i.substr(o[e]+u[e]);var r=t.length-u[e];for(var a=e+1;a<s.length;a++)o[a]+=r;l++,l==s.length&&n(i)},r)})(c);s.length==0&&n(i)},r)};o.normalize=function(e,t){return e.substr(e.length-4,4)==".css"&&(e=e.substr(0,e.length-4)),t(e)};var L,A=!1;return o.load=function(e,t,r,i,u){L=L||i.waitSeconds||7;var a=e+(u?".less":".css");if(o.attachBuffer(a,r))return;var f=t.toUrl(a);!A&&n&&(alert(s?"hacking links":"not hacking"),A=!0),u?k(f,function(e){u&&(e=u(e,function(e){o.inject(e),setTimeout(r,7)}))}):o.linkLoad(f,r)},n&&(o.inspect=function(){if(stylesheet.styleSheet)return stylesheet.styleSheet.cssText;if(stylesheet.innerHTML)return stylesheet.innerHTML}),o}),requirejs.s.contexts._.nextTick=function(e){e()},require(["css"],function(e){e.addBuffer("resources/framework/bundle/personaldata/css/personaldata.css")}),requirejs.s.contexts._.nextTick=requirejs.nextTick,Oskari.registerLocalization({lang:"fi",key:"PersonalData",value:{title:"Omat tiedot",desc:"Omat tiedot",notLoggedIn:"Omiin tietoihin voit tallentaa omia karttanäkymiä ja kohteita sekä nähdä muille sivustoille julkaisemasi kartat. <a href='/web/fi/login'>Kirjaudu palveluun</a>.",tabs:{myplaces:{title:"Kohteet",nocategories:"Et ole vielä tallentanut kohteita.",publishCategory:{privateTooltip:"Taso on yksityinen. Muuta taso julkiseksi klikkaamalla.",publicTooltip:"Taso on julkinen. Muuta taso yksityiseksi klikkaamalla."},editCategory:"Muokkaa tasoa",deleteCategory:"Poista taso",edit:"Muokkaa","delete":"Poista",grid:{name:"Nimi",desc:"Kuvaus",createDate:"Luotu",updateDate:"Päivitetty",edit:" ","delete":" "},notification:{"delete":{title:"Kohteen poistaminen",confirm:"Haluatko poistaa kohteen?",btnDelete:"Poista",btnCancel:"Peruuta",success:"Kohde on poistettu.",error:"Kohteen poistaminen epäonnistui. Kokeile uudestaan myöhemmin.",cancel:"Kohdetta ei ole poistettu."}}},myviews:{title:"Omat näkymät",edit:"Muokkaa",publish:"Muuta julkiseksi",unpublish:"Muuta yksityiseksi","delete":"Poista",grid:{name:"Nimi",description:"Kuvaus",publish:"Julkaisu",edit:" ","delete":" "},popup:{edit:"Muokkaa näkymän tietoja",title:"Näkymän tallennus",label:"Näkymän nimi:",name_placeholder:"Anna näkymälle nimi",description_placeholder:"Anna näkymälle kuvaus",save:"Tallenna",cancel:"Peruuta",error_noname:"Syötä nimi",deletetitle:"Poiston varmistus",deletemsg:"Haluatko poistaa näkymän?"},save:{success:"Näkymä tallennettu.",error_noname:"Nimi ei voi olla tyhjä.",error_illegalchars:"Nimessä on luvattomia merkkejä. Sallittuja merkkejä ovat kaikki suomen kielen aakkoset, numerot sekä välilyönti ja yhdysmerkki.",msg:{view_name:"Näkymän nimi"}},button:{ok:"OK",save:"Tallenna",cancel:"Peruuta",toolbarsave:"Tallenna näkymä"},error:{title:"Virhe!",generic:"Järjestelmässä tapahtui virhe. Yritä uudelleen myöhemmin.",notsaved:"Näkymän tallentaminen epäonnistui.",notdeleted:"Näkymän poisto epäonnistui.",makePublic:"Näkymän muuttaminen julkiseksi epäonnistui. Yritä myöhemmin uudelleen.",makePrivate:"Näkymän muuttaminen yksityiseksi epäonnistui. Yritä myöhemmin uudelleen.",loadfailed:"Näkymien lataus epäonnistui."}},publishedmaps:{title:"Julkaistut kartat",show:"Näytä kartalla",edit:"Muokkaa",publish:"Julkaise kartta",unpublish:"Peru julkaisu","delete":"Poista",grid:{name:"Nimi",domain:"Kartan tiedot",publish:"Tila",show:" ",edit:" ","delete":" "},popup:{edit:"Vaihda kartan nimi",title:"Kartan tallennus",label:"Kartan nimi:",placeholder:"Anna kartalle nimi",save:"Tallenna",cancel:"Peruuta",error_noname:"Anna kartalle nimi",deletetitle:"Poiston varmistus",deletemsg:"Haluatko poistaa julkaistun kartan? Tämän jälkeen kartta ei näy sivustollasi.",showErrorTitle:"Näkymä puutteellinen",showConfirmMissing:"Osa näkymään tallennetuista tasoista ei ole käytettävissä, haluatko silti avata näkymän?",showConfirmNotLoaded:"Kaikki karttatasot eivät ole vielä latautuneet, yritä uudelleen hetken päästä."},save:{success:"Kartta tallennettu.",error_noname:"Nimi ei voi olla tyhjä.",error_illegalchars:"Nimessä on luvattomia merkkejä. Sallittuja merkkejä ovat kaikki suomen kielen aakkoset, numerot sekä välilyönti ja yhdysmerkki.",msg:{view_name:"Kartan nimi"}},button:{ok:"OK",save:"Tallenna",cancel:"Peruuta",toolbarsave:"Tallenna kartta"},error:{title:"Virhe!",generic:"Järjestelmässä tapahtui virhe. Yritä uudelleen myöhemmin.",notsaved:"Kartan tallentaminen epäonnistui.",notdeleted:"Kartan poisto epäonnistui.",makePublic:"Kartan julkaiseminen epäonnistui. Yritä myöhemmin uudelleen.",makePrivate:"Kartan vaihtaminen yksityiseksi epäonnistui. Yritä myöhemmin uudelleen."}},account:{title:"Tilin tiedot",firstName:"Etunimi",lastName:"Sukunimi",nickName:"Nimimerkki",email:"Sähköpostiosoite",changeInfo:"Muuta tietoja",changePassword:"Muuta salasana",removeAccount:"Poista tili",changeInfoUrl:"/web/fi/profiili"}},button:{yes:"Kyllä",no:"Ei"}}}),define("bundles/framework/bundle/personaldata/locale/fi",function(){}),Oskari.registerLocalization({lang:"sv",key:"PersonalData",value:{title:"Mina uppgifter",desc:"Mina uppgifter",notLoggedIn:"Du kan lagra dina egna kartvyer och titta på kartor som du har inbäddat på andra webbplatser i Mina uppgifter. <a href='/web/sv/login'>Logga in</a>.",tabs:{myplaces:{title:"Objekt",nocategories:"Du har ännu inte lagrat objekten.",publishCategory:{privateTooltip:"Kartlagret är privat. Klicka på lagret för att offentliggöra det.",publicTooltip:"Kartlagret är offentliggöra. Klicka på lagret för att privat det."},editCategory:"Editera kartlager",deleteCategory:"Ta bort kartlager",edit:"Editera","delete":"Ta bort",grid:{name:"Namn",desc:"Beskrivning",createDate:"Skapad",updateDate:"Uppdaterad",edit:" ","delete":" "},notification:{"delete":{title:"Ta bort objekt",confirm:"Vill du ta bort detta objekt?",btnDelete:"Ta bort",btnCancel:"Tillbaka",success:"Objektet har tagits bort.",error:"Objektet kunde inte tas bort. Prova på nytt senare.",cancel:"Objektet har inte tagits bort."}}},myviews:{title:"Mina vyer",edit:"Editera",publish:"Offentliggör",unpublish:"Gör privat","delete":"Ta bort",grid:{name:"Namn",description:"Beskrivning",publish:"Vyn är offentlig",edit:" ","delete":" "},popup:{edit:"Editera vyn",title:"Lagra vy",label:"Vyns namn",name_placeholder:"Namnge vy",description_placeholder:"Beskriv vyn",save:"Lagra",cancel:"Tillbaka",error_noname:"Skriv namnet",deletetitle:"Bekräfta radering",deletemsg:"Vill du ta bort denna vy?"},save:{success:"Vyn har lagrats.",error_noname:"Namnet kan inte vara tomt.",error_illegalchars:"I namnet ingår otillåtna tecken. Tillåtna är alla bokstäver i det svenska alfabetet, siffror, mellanslag och bindestreck.",msg:{view_name:"Vyns namn"}},button:{ok:"OK",save:"Lagra",cancel:"Tillbaka",toolbarsave:"Lagra vy"},error:{title:"Fel!",generic:"Systemfel. Försök på nytt senare.",notsaved:"Vyn kunde inte lagras.",notdeleted:"Vyn kunde inte tas bort.",makePublic:"Vyn kunde inte göras offentlig Försök på nytt senare.",makePrivate:"Vyn kunde inte göras privat. Försök på nytt senare.",loadfailed:"Vyerna kunde inte laddas ned."}},publishedmaps:{title:"Inbäddade",show:"Visa på kartan",edit:"Redigera",publish:"Avskilj karta",unpublish:"Återta avskiljandet","delete":"Ta bort",grid:{name:"Namn",domain:"Kartinställnigar",publish:"Status",show:" ",edit:" ","delete":" "},popup:{edit:"Byt namn på kartan",title:"Lagra karta",label:"Kartans namn:",placeholder:"Namnge kartan",save:"Lagra",cancel:"Tillbaka",error_noname:"Namnge kartan",deletetitle:"Vill du ta bort denna karta?",deletemsg:"Vill du ta bort den inbäddade kartan? Efter detta syns kartan inte längre på din webbplats.",showErrorTitle:"Bristfällig vy",showConfirmMissing:"En del av de kartlager som har lagrats i vyn är inte tillgängliga, vill du ändå öppna vyn?",showConfirmNotLoaded:"Alla kartlager har ännu inte laddats ned, försök på nytt om en stund."},save:{success:"Kartan har lagrats.",error_noname:"Namnet kan inte vara tomt.",error_illegalchars:"I namnet ingår otillåtna tecken. Tillåtna är alla bokstäver i det svenska alfabetet, siffror, mellanslag och bindestreck.",msg:{view_name:"Kartans namn"}},button:{ok:"OK",save:"Lagra",cancel:"Tillbaka",toolbarsave:"Lagra karta"},error:{title:"Fel!",generic:"Systemfel. Försök på nytt senare.",notsaved:"Kartan kunde inte lagras.",notdeleted:"Kartan kunde inte tas bort.",makePublic:"Kartan kunde inte göras offentlig. Försök på nytt senare.",makePrivate:"Kartan kunde inte göras privat. Försök på nytt senare."}},account:{title:"Användarkonto",firstName:"Förnamn",lastName:"Efternamn",nickName:"Signatur",email:"E-postadress",changeInfo:"Ändra uppgifter",changePassword:"Byt ut lösenordet",removeAccount:"Radera konto",changeInfoUrl:"/web/sv/profil"}},button:{yes:"Ja",no:"Nej"}}}),define("bundles/framework/bundle/personaldata/locale/sv",function(){}),Oskari.registerLocalization({lang:"en",key:"PersonalData",value:{title:"My data",desc:"My data",notLoggedIn:"You can save map views and browse maps that you have embedded on other websites in My data. <a href='/web/en/login'>Log in</a>.",tabs:{myplaces:{title:"Places",nocategories:"You have not yet saved the places.",publishCategory:{privateTooltip:"The map layer is private. Click the map layer to make it public.",publicTooltip:"The map layer is public. Click the map layer to make it private."},editCategory:"Edit map layer",deleteCategory:"Delete map layer",edit:"Edit","delete":"Delete",grid:{name:"Name",desc:"Description",createDate:"Created",updateDate:"Updated",edit:" ","delete":" "},notification:{"delete":{title:"Delete place",confirm:"Do you want to delete this place?",btnDelete:"Delete",btnCancel:"Cancel",success:"The place has been deleted.",error:"The place could not be deleted. Please try again later.",cancel:"The object has not been deleted."}}},myviews:{title:"My map views",edit:"Edit",publish:"Publish",unpublish:"Unpublish","delete":"Delete",grid:{name:"Name",description:"Description",publish:"Published",edit:" ","delete":" "},popup:{edit:"Edit view's information",title:"Save map view",label:"Name of map view:",name_placeholder:"Give the map view a name",description_placeholder:"Give the map view a description",save:"Save",cancel:"Cancel",error_noname:"Type the name",deletetitle:"Confirm delete",deletemsg:"Do you want to delete this map view?"},save:{success:"The map view has been saved.",error_noname:"The name field cannot be blank.",error_illegalchars:"The name contains disallowed characters. Allowed characters are the letters a-z as well as å, ä and ö, numbers, backspaces and hyphens.",msg:{view_name:"The name of the map view"}},button:{ok:"OK",save:"Save",cancel:"Cancel",toolbarsave:"Save map view"},error:{title:"Error!",generic:"System error. Please try again later.",notsaved:"The map view could not be saved.",notdeleted:"The map view could not be deleted.",makePublic:"The map view could not be published. Please try again later.",makePrivate:"The map view could not be unpublished. Please try again later.",loadfailed:"The map views could not be downloaded."}},publishedmaps:{title:"Embedded maps",show:"Show on the map",edit:"Edit",publish:"Publish map",unpublish:"Unpublish map","delete":"Delete",grid:{name:"Name",domain:"Map settings",publish:"Status",show:" ",edit:" ","delete":" "},popup:{edit:"Change map name",title:"Save map",label:"Map name",placeholder:"Give the map a name",save:"Save",cancel:"Cancel",error_noname:"Give the map a name",deletetitle:"Delete map?",deletemsg:"Do you want to delete the embedded map? It will no longer be shown on your website.",showErrorTitle:"Incomplete view",showConfirmMissing:"Some saved map layers are not available, do you still want to open this view?",showConfirmNotLoaded:"Some map layers have not yet loaded, try again later."},save:{success:"The map has been saved.",error_noname:"The name field cannot be blank.",error_illegalchars:"The name contains disallowed characters. Allowed characters are the letters a-z as well as å, ä and ö, numbers, backspaces and hyphens.",msg:{view_name:"Map name"}},button:{ok:"OK",save:"Save",cancel:"Cancel",toolbarsave:"Save map"},error:{title:"Error!",generic:"System error. Please try again later.",notsaved:"The map could not be saved.",notdeleted:"The map could not be deleted.",makePublic:"The map could not be published. Please try again later.",makePrivate:"The map could not be unpublished. Please try again later."}},account:{title:"My account",firstName:"First name",lastName:"Last name",nickName:"Nickname",email:"E-mail",changeInfo:"Change your account information",changePassword:"Change your password",removeAccount:"Delete your account",changeInfoUrl:"/web/en/profile"}},button:{yes:"Yes",no:"No"}}}),define("bundles/framework/bundle/personaldata/locale/en",function(){}),define("bundles/framework/bundle/personaldata/module",["oskari","jquery","./instance","./Flyout","./Tile","./MyPlacesTab","./MyViewsTab","./service/ViewService","./PublishedMapsTab","./AccountTab","css!resources/framework/bundle/personaldata/css/personaldata.css","./locale/fi","./locale/sv","./locale/en"],function(e,t){return e.bundleCls("personaldata").category({create:function(){var t=this,n=e.clazz.create("Oskari.mapframework.bundle.personaldata.PersonalDataBundleInstance");return n},update:function(e,t,n,r){}})}),requirejs.s.contexts._.nextTick=function(e){e()},require(["css"],function(e){e.setBuffer("/* account tab */\r\ndiv.tab-content div.account div.dataField {\r\n  padding: 10px; }\r\n\r\ndiv.tab-content div.account div.dataField div.label {\r\n  float: left;\r\n  width: 40%; }\r\n\r\n/* My Views tab*/\r\ndiv.view {\r\n  padding: 5px; }\r\n\r\ndiv.view.odd {\r\n  background-color: #f3f3f3; }\r\n\r\ndiv.view div.name {\r\n  display: inline-block; }\r\n\r\ndiv.view div.tools {\r\n  float: right; }\r\n\r\ndiv.view div.tools div {\r\n  display: inline-block;\r\n  margin-right: 5px; }\r\n\r\ndiv.personaldata td div.icon {\r\n  display: inline-block;\r\n  vertical-align: top; }\r\n\r\ndiv.personaldata a.categoryOp {\r\n  margin: 5px; }\r\n\r\ndiv.personaldata a.categoryOp div.icon {\r\n  display: inline-block; }\r\n\r\ntextarea#view_description {\r\n  resize: none;\r\n  width: 100%; }\r\n")}),requirejs.s.contexts._.nextTick=requirejs.nextTick;